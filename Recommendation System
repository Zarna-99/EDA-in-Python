{
 "cells": [
  {
   "cell_type": "markdown",
   "id": "0fa2769b",
   "metadata": {
    "papermill": {
     "duration": 0.02443,
     "end_time": "2023-05-31T08:53:23.252815",
     "exception": false,
     "start_time": "2023-05-31T08:53:23.228385",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "<h1><div style=\"color:white;\n",
    "           display:fill;\n",
    "           border-radius:5px;\n",
    "           background-color:#873600  ;\n",
    "           font-size:400%;\n",
    "           font-family:Sans-serif;\n",
    "           letter-spacing:0.5px\">\n",
    "\n",
    "<p style=\"padding: 20px;\n",
    "              color:white;\n",
    "               text-align:center\">\n",
    "    <b>\n",
    "        RECOMMENDATION ENGINE\n",
    "        </b>\n",
    "</p>\n",
    "</div></h1>"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "dcc09150",
   "metadata": {
    "papermill": {
     "duration": 0.02347,
     "end_time": "2023-05-31T08:53:23.300278",
     "exception": false,
     "start_time": "2023-05-31T08:53:23.276808",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "A recommendation engine, also known as a recommender system, is a powerful machine learning technique used to provide personalized recommendations to users based on their preferences and historical data. Its primary goal is to predict and suggest items that a user might be interested in, such as movies, products, articles, or music, among others. Recommendation engines are widely used in various domains, including e-commerce, entertainment, content platforms, and social media.\n",
    "\n",
    "There are several types of recommendation engines, but two popular approaches are collaborative filtering and content-based filtering:\n",
    "\n",
    "1. Collaborative Filtering: This approach utilizes the behavior and preferences of a group of users to generate recommendations. It assumes that users with similar tastes and preferences in the past are likely to have similar preferences in the future. Collaborative filtering can be further divided into two subtypes:\n",
    "\n",
    "> A. User-based: It recommends items to a user based on the interests and behaviors of users with similar preferences.\n",
    "\n",
    "> B. Item-based: It suggests similar items to a user based on the ratings and interactions of other users.\n",
    "\n",
    "\n",
    "2. Content-Based Filtering: This approach recommends items based on their characteristics and features. It considers the attributes or content of the items that a user has previously liked or interacted with. By analyzing the item's features and comparing them to the user's profile, content-based filtering identifies items with similar attributes to recommend.\n",
    "\n",
    "There are also hybrid recommender systems that combine collaborative filtering and content-based filtering techniques to provide more accurate and diverse recommendations. Additionally, advanced recommendation techniques such as matrix factorization, deep learning, and reinforcement learning can be employed to enhance recommendation accuracy and handle challenges like the cold-start problem (where there is limited or no user data available).\n",
    "\n",
    "Recommendation engines have become vital in enhancing user experience, increasing customer engagement, and driving business revenue by delivering personalized and relevant suggestions. They play a crucial role in addressing information overload and helping users discover new and relevant items in a vast sea of options.\n",
    "\n",
    "In this notebook, we will explore three distinct types of recommendations: \n",
    "\n",
    "1. Popularity-based Recommendations \n",
    "2. User-based collaborative filtering\n",
    "3. Content-based filtering(simialr books based on book-title)\n",
    "\n",
    "Each approach offers unique perspectives and methodologies for generating personalized recommendations.\n",
    "\n",
    "Link to the app : [https://zarna-99-recommendation-system-recommendation-engine-xizrkh.streamlit.app/]"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "e50c37d8",
   "metadata": {
    "papermill": {
     "duration": 0.02441,
     "end_time": "2023-05-31T08:53:23.348248",
     "exception": false,
     "start_time": "2023-05-31T08:53:23.323838",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "### Table of Contents\n",
    "\n",
    "* [1. Defining Functions](#1)\n",
    "* [2. Importing the necessary Libraries](#2)\n",
    "* [3. Importing the Dataset](#3)\n",
    "* [4. Basic information about the dataset](#4)\n",
    "* [5. Exploring the Dataset](#5)\n",
    "     * [5.1 Checking the unique values for each columns](#5.1)\n",
    "     * [5.2 Checking for null values](#5.2)\n",
    "     * [5.3 Data Cleaning](#5.3)\n",
    "* [6. Popularity Based Recommendations](#6)\n",
    "* [7. User-based Collaborative filtering](#7)\n",
    "* [8. Content-based filtering(simialr books based on book-title)](#8)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "d9b3c3b3",
   "metadata": {
    "papermill": {
     "duration": 0.023477,
     "end_time": "2023-05-31T08:53:23.395526",
     "exception": false,
     "start_time": "2023-05-31T08:53:23.372049",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "<h2><div style=\"color:white;\n",
    "           display:fill;\n",
    "           border-radius:5px;\n",
    "           background-color:#FF5733  ;\n",
    "           font-size:300%;\n",
    "           font-family:Sans-serif;\n",
    "           letter-spacing:0.5px\">\n",
    "\n",
    "<p style=\"padding: 15px;\n",
    "              color:white;\n",
    "               text-align:center\">\n",
    "    <b>\n",
    "        Defining Functions<a class=\"anchor\" id=\"1\"></a>\n",
    "        </b>\n",
    "</p>\n",
    "</div></h2>"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "6f79f321",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2023-05-31T08:53:23.445160Z",
     "iopub.status.busy": "2023-05-31T08:53:23.444463Z",
     "iopub.status.idle": "2023-05-31T08:53:23.456062Z",
     "shell.execute_reply": "2023-05-31T08:53:23.455048Z"
    },
    "papermill": {
     "duration": 0.038972,
     "end_time": "2023-05-31T08:53:23.458345",
     "exception": false,
     "start_time": "2023-05-31T08:53:23.419373",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "# function to fetch the book details\n",
    "def get_book_data(df):\n",
    "    data = book_data[book_data[\"Book-Title\"].isin(df[\"Book-Title\"])]\n",
    "    return data"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "697139e6",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2023-05-31T08:53:23.507941Z",
     "iopub.status.busy": "2023-05-31T08:53:23.507538Z",
     "iopub.status.idle": "2023-05-31T08:53:23.513205Z",
     "shell.execute_reply": "2023-05-31T08:53:23.512156Z"
    },
    "papermill": {
     "duration": 0.03317,
     "end_time": "2023-05-31T08:53:23.515493",
     "exception": false,
     "start_time": "2023-05-31T08:53:23.482323",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "# function to convert nested array with list into a simple list\n",
    "def flatten(x):\n",
    "    for e in x:\n",
    "        if isinstance(e, list):\n",
    "            yield from flatten(e)\n",
    "        else:\n",
    "            yield e"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "3097eb54",
   "metadata": {
    "papermill": {
     "duration": 0.023306,
     "end_time": "2023-05-31T08:53:23.562859",
     "exception": false,
     "start_time": "2023-05-31T08:53:23.539553",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "<h2><div style=\"color:white;\n",
    "           display:fill;\n",
    "           border-radius:5px;\n",
    "           background-color:#FF5733  ;\n",
    "           font-size:300%;\n",
    "           font-family:Sans-serif;\n",
    "           letter-spacing:0.5px\">\n",
    "\n",
    "<p style=\"padding: 15px;\n",
    "              color:white;\n",
    "               text-align:center\">\n",
    "    <b>\n",
    "        Importing the necessary libraries<a class=\"anchor\" id=\"2\"></a>\n",
    "        </b>\n",
    "</p>\n",
    "</div></h2>"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "3409ff26",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2023-05-31T08:53:23.612882Z",
     "iopub.status.busy": "2023-05-31T08:53:23.612509Z",
     "iopub.status.idle": "2023-05-31T08:53:25.076083Z",
     "shell.execute_reply": "2023-05-31T08:53:25.075041Z"
    },
    "papermill": {
     "duration": 1.492446,
     "end_time": "2023-05-31T08:53:25.078971",
     "exception": false,
     "start_time": "2023-05-31T08:53:23.586525",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "import pandas as pd\n",
    "import numpy as np\n",
    "from sklearn.metrics import pairwise_distances\n",
    "from sklearn.metrics.pairwise import cosine_similarity\n",
    "from sklearn.feature_extraction.text import TfidfVectorizer\n",
    "import warnings\n",
    "warnings.filterwarnings('ignore')"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "24f38bf0",
   "metadata": {
    "papermill": {
     "duration": 0.023536,
     "end_time": "2023-05-31T08:53:25.126599",
     "exception": false,
     "start_time": "2023-05-31T08:53:25.103063",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "<h2><div style=\"color:white;\n",
    "           display:fill;\n",
    "           border-radius:5px;\n",
    "           background-color:#FF5733  ;\n",
    "           font-size:300%;\n",
    "           font-family:Sans-serif;\n",
    "           letter-spacing:0.5px\">\n",
    "\n",
    "<p style=\"padding: 15px;\n",
    "              color:white;\n",
    "               text-align:center\">\n",
    "    <b>\n",
    "        Importing the dataset<a class=\"anchor\" id=\"3\"></a>\n",
    "        </b>\n",
    "</p>\n",
    "</div></h2>\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "1f7a92d5",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2023-05-31T08:53:25.176467Z",
     "iopub.status.busy": "2023-05-31T08:53:25.176048Z",
     "iopub.status.idle": "2023-05-31T08:53:29.608122Z",
     "shell.execute_reply": "2023-05-31T08:53:29.607165Z"
    },
    "papermill": {
     "duration": 4.460501,
     "end_time": "2023-05-31T08:53:29.610952",
     "exception": false,
     "start_time": "2023-05-31T08:53:25.150451",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "books = pd.read_csv(r\"/kaggle/input/book-recommendation-dataset/Books.csv\", low_memory=False)\n",
    "users = pd.read_csv(r\"/kaggle/input/book-recommendation-dataset/Users.csv\")\n",
    "rating = pd.read_csv(r\"/kaggle/input/book-recommendation-dataset/Ratings.csv\")"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "68df694c",
   "metadata": {
    "papermill": {
     "duration": 0.023598,
     "end_time": "2023-05-31T08:53:29.658373",
     "exception": false,
     "start_time": "2023-05-31T08:53:29.634775",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "I have created a separate dataset that contains the details about the books (no repeated book titles). This dataset will be used to fetch the details of the recommended books."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "477c22f8",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2023-05-31T08:53:29.707864Z",
     "iopub.status.busy": "2023-05-31T08:53:29.707423Z",
     "iopub.status.idle": "2023-05-31T08:53:30.887154Z",
     "shell.execute_reply": "2023-05-31T08:53:30.885953Z"
    },
    "papermill": {
     "duration": 1.207497,
     "end_time": "2023-05-31T08:53:30.889959",
     "exception": false,
     "start_time": "2023-05-31T08:53:29.682462",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "book_data_1 = pd.read_csv(r\"/kaggle/input/book-recommendations/Book_Data_1.csv\")\n",
    "book_data_2 = pd.read_csv(r\"/kaggle/input/book-recommendations/Book_Data_2.csv\")\n",
    "book_data = pd.concat([book_data_1,book_data_2],axis=1)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "3a17f324",
   "metadata": {
    "papermill": {
     "duration": 0.025034,
     "end_time": "2023-05-31T08:53:30.939294",
     "exception": false,
     "start_time": "2023-05-31T08:53:30.914260",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "<h2><div style=\"color:white;\n",
    "           display:fill;\n",
    "           border-radius:5px;\n",
    "           background-color:#FF5733  ;\n",
    "           font-size:300%;\n",
    "           font-family:Sans-serif;\n",
    "           letter-spacing:0.5px\">\n",
    "\n",
    "<p style=\"padding: 15px;\n",
    "              color:white;\n",
    "               text-align:center\">\n",
    "    <b>\n",
    "        Basic Information about the Dataset<a class=\"anchor\" id=\"4\"></a>\n",
    "        </b>\n",
    "</p>\n",
    "</div></h2>"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "27360eba",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2023-05-31T08:53:30.988629Z",
     "iopub.status.busy": "2023-05-31T08:53:30.988222Z",
     "iopub.status.idle": "2023-05-31T08:53:31.711657Z",
     "shell.execute_reply": "2023-05-31T08:53:31.710455Z"
    },
    "papermill": {
     "duration": 0.751304,
     "end_time": "2023-05-31T08:53:31.714163",
     "exception": false,
     "start_time": "2023-05-31T08:53:30.962859",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "<class 'pandas.core.frame.DataFrame'>\n",
      "RangeIndex: 271360 entries, 0 to 271359\n",
      "Data columns (total 8 columns):\n",
      " #   Column               Non-Null Count   Dtype \n",
      "---  ------               --------------   ----- \n",
      " 0   ISBN                 271360 non-null  object\n",
      " 1   Book-Title           271360 non-null  object\n",
      " 2   Book-Author          271359 non-null  object\n",
      " 3   Year-Of-Publication  271360 non-null  object\n",
      " 4   Publisher            271358 non-null  object\n",
      " 5   Image-URL-S          271360 non-null  object\n",
      " 6   Image-URL-M          271360 non-null  object\n",
      " 7   Image-URL-L          271357 non-null  object\n",
      "dtypes: object(8)\n",
      "memory usage: 16.6+ MB\n"
     ]
    }
   ],
   "source": [
    "books.info()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "id": "e5dee78a",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2023-05-31T08:53:31.763932Z",
     "iopub.status.busy": "2023-05-31T08:53:31.763519Z",
     "iopub.status.idle": "2023-05-31T08:53:31.867033Z",
     "shell.execute_reply": "2023-05-31T08:53:31.865937Z"
    },
    "papermill": {
     "duration": 0.131306,
     "end_time": "2023-05-31T08:53:31.869596",
     "exception": false,
     "start_time": "2023-05-31T08:53:31.738290",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "<class 'pandas.core.frame.DataFrame'>\n",
      "RangeIndex: 278858 entries, 0 to 278857\n",
      "Data columns (total 3 columns):\n",
      " #   Column    Non-Null Count   Dtype  \n",
      "---  ------    --------------   -----  \n",
      " 0   User-ID   278858 non-null  int64  \n",
      " 1   Location  278858 non-null  object \n",
      " 2   Age       168096 non-null  float64\n",
      "dtypes: float64(1), int64(1), object(1)\n",
      "memory usage: 6.4+ MB\n"
     ]
    }
   ],
   "source": [
    "users.info()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "id": "046d584b",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2023-05-31T08:53:31.919415Z",
     "iopub.status.busy": "2023-05-31T08:53:31.918989Z",
     "iopub.status.idle": "2023-05-31T08:53:32.309800Z",
     "shell.execute_reply": "2023-05-31T08:53:32.308248Z"
    },
    "papermill": {
     "duration": 0.418799,
     "end_time": "2023-05-31T08:53:32.312405",
     "exception": false,
     "start_time": "2023-05-31T08:53:31.893606",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "<class 'pandas.core.frame.DataFrame'>\n",
      "RangeIndex: 1149780 entries, 0 to 1149779\n",
      "Data columns (total 3 columns):\n",
      " #   Column       Non-Null Count    Dtype \n",
      "---  ------       --------------    ----- \n",
      " 0   User-ID      1149780 non-null  int64 \n",
      " 1   ISBN         1149780 non-null  object\n",
      " 2   Book-Rating  1149780 non-null  int64 \n",
      "dtypes: int64(2), object(1)\n",
      "memory usage: 26.3+ MB\n"
     ]
    }
   ],
   "source": [
    "rating.info()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "d3a729f5",
   "metadata": {
    "papermill": {
     "duration": 0.023696,
     "end_time": "2023-05-31T08:53:32.360036",
     "exception": false,
     "start_time": "2023-05-31T08:53:32.336340",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "There are 3 datasets :-\n",
    "\n",
    "books : contains the details about the books\n",
    "\n",
    "users : contains the details about the users\n",
    "\n",
    "rating : contains the ratings given by users for various books."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "076cf412",
   "metadata": {
    "papermill": {
     "duration": 0.02362,
     "end_time": "2023-05-31T08:53:32.408343",
     "exception": false,
     "start_time": "2023-05-31T08:53:32.384723",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "<h2><div style=\"color:white;\n",
    "           display:fill;\n",
    "           border-radius:5px;\n",
    "           background-color:#FF5733  ;\n",
    "           font-size:300%;\n",
    "           font-family:Sans-serif;\n",
    "           letter-spacing:0.5px\">\n",
    "\n",
    "<p style=\"padding: 15px;\n",
    "              color:white;\n",
    "               text-align:center\">\n",
    "    <b>\n",
    "        Exploring the Dataset<a class=\"anchor\" id=\"5\"></a>\n",
    "        </b>\n",
    "</p>\n",
    "</div></h2>"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "id": "ddc2377e",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2023-05-31T08:53:32.459846Z",
     "iopub.status.busy": "2023-05-31T08:53:32.458942Z",
     "iopub.status.idle": "2023-05-31T08:53:32.491738Z",
     "shell.execute_reply": "2023-05-31T08:53:32.490592Z"
    },
    "papermill": {
     "duration": 0.060943,
     "end_time": "2023-05-31T08:53:32.493939",
     "exception": false,
     "start_time": "2023-05-31T08:53:32.432996",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>ISBN</th>\n",
       "      <th>Book-Title</th>\n",
       "      <th>Book-Author</th>\n",
       "      <th>Year-Of-Publication</th>\n",
       "      <th>Publisher</th>\n",
       "      <th>Image-URL-S</th>\n",
       "      <th>Image-URL-M</th>\n",
       "      <th>Image-URL-L</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>0195153448</td>\n",
       "      <td>Classical Mythology</td>\n",
       "      <td>Mark P. O. Morford</td>\n",
       "      <td>2002</td>\n",
       "      <td>Oxford University Press</td>\n",
       "      <td>http://images.amazon.com/images/P/0195153448.0...</td>\n",
       "      <td>http://images.amazon.com/images/P/0195153448.0...</td>\n",
       "      <td>http://images.amazon.com/images/P/0195153448.0...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>0002005018</td>\n",
       "      <td>Clara Callan</td>\n",
       "      <td>Richard Bruce Wright</td>\n",
       "      <td>2001</td>\n",
       "      <td>HarperFlamingo Canada</td>\n",
       "      <td>http://images.amazon.com/images/P/0002005018.0...</td>\n",
       "      <td>http://images.amazon.com/images/P/0002005018.0...</td>\n",
       "      <td>http://images.amazon.com/images/P/0002005018.0...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>0060973129</td>\n",
       "      <td>Decision in Normandy</td>\n",
       "      <td>Carlo D'Este</td>\n",
       "      <td>1991</td>\n",
       "      <td>HarperPerennial</td>\n",
       "      <td>http://images.amazon.com/images/P/0060973129.0...</td>\n",
       "      <td>http://images.amazon.com/images/P/0060973129.0...</td>\n",
       "      <td>http://images.amazon.com/images/P/0060973129.0...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>0374157065</td>\n",
       "      <td>Flu: The Story of the Great Influenza Pandemic...</td>\n",
       "      <td>Gina Bari Kolata</td>\n",
       "      <td>1999</td>\n",
       "      <td>Farrar Straus Giroux</td>\n",
       "      <td>http://images.amazon.com/images/P/0374157065.0...</td>\n",
       "      <td>http://images.amazon.com/images/P/0374157065.0...</td>\n",
       "      <td>http://images.amazon.com/images/P/0374157065.0...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>0393045218</td>\n",
       "      <td>The Mummies of Urumchi</td>\n",
       "      <td>E. J. W. Barber</td>\n",
       "      <td>1999</td>\n",
       "      <td>W. W. Norton &amp;amp; Company</td>\n",
       "      <td>http://images.amazon.com/images/P/0393045218.0...</td>\n",
       "      <td>http://images.amazon.com/images/P/0393045218.0...</td>\n",
       "      <td>http://images.amazon.com/images/P/0393045218.0...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>271355</th>\n",
       "      <td>0440400988</td>\n",
       "      <td>There's a Bat in Bunk Five</td>\n",
       "      <td>Paula Danziger</td>\n",
       "      <td>1988</td>\n",
       "      <td>Random House Childrens Pub (Mm)</td>\n",
       "      <td>http://images.amazon.com/images/P/0440400988.0...</td>\n",
       "      <td>http://images.amazon.com/images/P/0440400988.0...</td>\n",
       "      <td>http://images.amazon.com/images/P/0440400988.0...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>271356</th>\n",
       "      <td>0525447644</td>\n",
       "      <td>From One to One Hundred</td>\n",
       "      <td>Teri Sloat</td>\n",
       "      <td>1991</td>\n",
       "      <td>Dutton Books</td>\n",
       "      <td>http://images.amazon.com/images/P/0525447644.0...</td>\n",
       "      <td>http://images.amazon.com/images/P/0525447644.0...</td>\n",
       "      <td>http://images.amazon.com/images/P/0525447644.0...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>271357</th>\n",
       "      <td>006008667X</td>\n",
       "      <td>Lily Dale : The True Story of the Town that Ta...</td>\n",
       "      <td>Christine Wicker</td>\n",
       "      <td>2004</td>\n",
       "      <td>HarperSanFrancisco</td>\n",
       "      <td>http://images.amazon.com/images/P/006008667X.0...</td>\n",
       "      <td>http://images.amazon.com/images/P/006008667X.0...</td>\n",
       "      <td>http://images.amazon.com/images/P/006008667X.0...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>271358</th>\n",
       "      <td>0192126040</td>\n",
       "      <td>Republic (World's Classics)</td>\n",
       "      <td>Plato</td>\n",
       "      <td>1996</td>\n",
       "      <td>Oxford University Press</td>\n",
       "      <td>http://images.amazon.com/images/P/0192126040.0...</td>\n",
       "      <td>http://images.amazon.com/images/P/0192126040.0...</td>\n",
       "      <td>http://images.amazon.com/images/P/0192126040.0...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>271359</th>\n",
       "      <td>0767409752</td>\n",
       "      <td>A Guided Tour of Rene Descartes' Meditations o...</td>\n",
       "      <td>Christopher  Biffle</td>\n",
       "      <td>2000</td>\n",
       "      <td>McGraw-Hill Humanities/Social Sciences/Languages</td>\n",
       "      <td>http://images.amazon.com/images/P/0767409752.0...</td>\n",
       "      <td>http://images.amazon.com/images/P/0767409752.0...</td>\n",
       "      <td>http://images.amazon.com/images/P/0767409752.0...</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>271360 rows × 8 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "              ISBN                                         Book-Title  \\\n",
       "0       0195153448                                Classical Mythology   \n",
       "1       0002005018                                       Clara Callan   \n",
       "2       0060973129                               Decision in Normandy   \n",
       "3       0374157065  Flu: The Story of the Great Influenza Pandemic...   \n",
       "4       0393045218                             The Mummies of Urumchi   \n",
       "...            ...                                                ...   \n",
       "271355  0440400988                         There's a Bat in Bunk Five   \n",
       "271356  0525447644                            From One to One Hundred   \n",
       "271357  006008667X  Lily Dale : The True Story of the Town that Ta...   \n",
       "271358  0192126040                        Republic (World's Classics)   \n",
       "271359  0767409752  A Guided Tour of Rene Descartes' Meditations o...   \n",
       "\n",
       "                 Book-Author Year-Of-Publication  \\\n",
       "0         Mark P. O. Morford                2002   \n",
       "1       Richard Bruce Wright                2001   \n",
       "2               Carlo D'Este                1991   \n",
       "3           Gina Bari Kolata                1999   \n",
       "4            E. J. W. Barber                1999   \n",
       "...                      ...                 ...   \n",
       "271355        Paula Danziger                1988   \n",
       "271356            Teri Sloat                1991   \n",
       "271357      Christine Wicker                2004   \n",
       "271358                 Plato                1996   \n",
       "271359   Christopher  Biffle                2000   \n",
       "\n",
       "                                               Publisher  \\\n",
       "0                                Oxford University Press   \n",
       "1                                  HarperFlamingo Canada   \n",
       "2                                        HarperPerennial   \n",
       "3                                   Farrar Straus Giroux   \n",
       "4                             W. W. Norton &amp; Company   \n",
       "...                                                  ...   \n",
       "271355                   Random House Childrens Pub (Mm)   \n",
       "271356                                      Dutton Books   \n",
       "271357                                HarperSanFrancisco   \n",
       "271358                           Oxford University Press   \n",
       "271359  McGraw-Hill Humanities/Social Sciences/Languages   \n",
       "\n",
       "                                              Image-URL-S  \\\n",
       "0       http://images.amazon.com/images/P/0195153448.0...   \n",
       "1       http://images.amazon.com/images/P/0002005018.0...   \n",
       "2       http://images.amazon.com/images/P/0060973129.0...   \n",
       "3       http://images.amazon.com/images/P/0374157065.0...   \n",
       "4       http://images.amazon.com/images/P/0393045218.0...   \n",
       "...                                                   ...   \n",
       "271355  http://images.amazon.com/images/P/0440400988.0...   \n",
       "271356  http://images.amazon.com/images/P/0525447644.0...   \n",
       "271357  http://images.amazon.com/images/P/006008667X.0...   \n",
       "271358  http://images.amazon.com/images/P/0192126040.0...   \n",
       "271359  http://images.amazon.com/images/P/0767409752.0...   \n",
       "\n",
       "                                              Image-URL-M  \\\n",
       "0       http://images.amazon.com/images/P/0195153448.0...   \n",
       "1       http://images.amazon.com/images/P/0002005018.0...   \n",
       "2       http://images.amazon.com/images/P/0060973129.0...   \n",
       "3       http://images.amazon.com/images/P/0374157065.0...   \n",
       "4       http://images.amazon.com/images/P/0393045218.0...   \n",
       "...                                                   ...   \n",
       "271355  http://images.amazon.com/images/P/0440400988.0...   \n",
       "271356  http://images.amazon.com/images/P/0525447644.0...   \n",
       "271357  http://images.amazon.com/images/P/006008667X.0...   \n",
       "271358  http://images.amazon.com/images/P/0192126040.0...   \n",
       "271359  http://images.amazon.com/images/P/0767409752.0...   \n",
       "\n",
       "                                              Image-URL-L  \n",
       "0       http://images.amazon.com/images/P/0195153448.0...  \n",
       "1       http://images.amazon.com/images/P/0002005018.0...  \n",
       "2       http://images.amazon.com/images/P/0060973129.0...  \n",
       "3       http://images.amazon.com/images/P/0374157065.0...  \n",
       "4       http://images.amazon.com/images/P/0393045218.0...  \n",
       "...                                                   ...  \n",
       "271355  http://images.amazon.com/images/P/0440400988.0...  \n",
       "271356  http://images.amazon.com/images/P/0525447644.0...  \n",
       "271357  http://images.amazon.com/images/P/006008667X.0...  \n",
       "271358  http://images.amazon.com/images/P/0192126040.0...  \n",
       "271359  http://images.amazon.com/images/P/0767409752.0...  \n",
       "\n",
       "[271360 rows x 8 columns]"
      ]
     },
     "execution_count": 9,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "books"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "id": "ffa4d295",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2023-05-31T08:53:32.545194Z",
     "iopub.status.busy": "2023-05-31T08:53:32.544398Z",
     "iopub.status.idle": "2023-05-31T08:53:32.558199Z",
     "shell.execute_reply": "2023-05-31T08:53:32.557138Z"
    },
    "papermill": {
     "duration": 0.04229,
     "end_time": "2023-05-31T08:53:32.560724",
     "exception": false,
     "start_time": "2023-05-31T08:53:32.518434",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>User-ID</th>\n",
       "      <th>Location</th>\n",
       "      <th>Age</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>1</td>\n",
       "      <td>nyc, new york, usa</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>2</td>\n",
       "      <td>stockton, california, usa</td>\n",
       "      <td>18.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>3</td>\n",
       "      <td>moscow, yukon territory, russia</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>4</td>\n",
       "      <td>porto, v.n.gaia, portugal</td>\n",
       "      <td>17.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>5</td>\n",
       "      <td>farnborough, hants, united kingdom</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>278853</th>\n",
       "      <td>278854</td>\n",
       "      <td>portland, oregon, usa</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>278854</th>\n",
       "      <td>278855</td>\n",
       "      <td>tacoma, washington, united kingdom</td>\n",
       "      <td>50.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>278855</th>\n",
       "      <td>278856</td>\n",
       "      <td>brampton, ontario, canada</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>278856</th>\n",
       "      <td>278857</td>\n",
       "      <td>knoxville, tennessee, usa</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>278857</th>\n",
       "      <td>278858</td>\n",
       "      <td>dublin, n/a, ireland</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>278858 rows × 3 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "        User-ID                            Location   Age\n",
       "0             1                  nyc, new york, usa   NaN\n",
       "1             2           stockton, california, usa  18.0\n",
       "2             3     moscow, yukon territory, russia   NaN\n",
       "3             4           porto, v.n.gaia, portugal  17.0\n",
       "4             5  farnborough, hants, united kingdom   NaN\n",
       "...         ...                                 ...   ...\n",
       "278853   278854               portland, oregon, usa   NaN\n",
       "278854   278855  tacoma, washington, united kingdom  50.0\n",
       "278855   278856           brampton, ontario, canada   NaN\n",
       "278856   278857           knoxville, tennessee, usa   NaN\n",
       "278857   278858                dublin, n/a, ireland   NaN\n",
       "\n",
       "[278858 rows x 3 columns]"
      ]
     },
     "execution_count": 10,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "users"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "id": "f7830d21",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2023-05-31T08:53:32.612173Z",
     "iopub.status.busy": "2023-05-31T08:53:32.611760Z",
     "iopub.status.idle": "2023-05-31T08:53:32.628008Z",
     "shell.execute_reply": "2023-05-31T08:53:32.626978Z"
    },
    "papermill": {
     "duration": 0.044432,
     "end_time": "2023-05-31T08:53:32.630102",
     "exception": false,
     "start_time": "2023-05-31T08:53:32.585670",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>User-ID</th>\n",
       "      <th>ISBN</th>\n",
       "      <th>Book-Rating</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>276725</td>\n",
       "      <td>034545104X</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>276726</td>\n",
       "      <td>0155061224</td>\n",
       "      <td>5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>276727</td>\n",
       "      <td>0446520802</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>276729</td>\n",
       "      <td>052165615X</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>276729</td>\n",
       "      <td>0521795028</td>\n",
       "      <td>6</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1149775</th>\n",
       "      <td>276704</td>\n",
       "      <td>1563526298</td>\n",
       "      <td>9</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1149776</th>\n",
       "      <td>276706</td>\n",
       "      <td>0679447156</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1149777</th>\n",
       "      <td>276709</td>\n",
       "      <td>0515107662</td>\n",
       "      <td>10</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1149778</th>\n",
       "      <td>276721</td>\n",
       "      <td>0590442449</td>\n",
       "      <td>10</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1149779</th>\n",
       "      <td>276723</td>\n",
       "      <td>05162443314</td>\n",
       "      <td>8</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>1149780 rows × 3 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "         User-ID         ISBN  Book-Rating\n",
       "0         276725   034545104X            0\n",
       "1         276726   0155061224            5\n",
       "2         276727   0446520802            0\n",
       "3         276729   052165615X            3\n",
       "4         276729   0521795028            6\n",
       "...          ...          ...          ...\n",
       "1149775   276704   1563526298            9\n",
       "1149776   276706   0679447156            0\n",
       "1149777   276709   0515107662           10\n",
       "1149778   276721   0590442449           10\n",
       "1149779   276723  05162443314            8\n",
       "\n",
       "[1149780 rows x 3 columns]"
      ]
     },
     "execution_count": 11,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "rating"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "id": "ac500602",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2023-05-31T08:53:32.682490Z",
     "iopub.status.busy": "2023-05-31T08:53:32.682073Z",
     "iopub.status.idle": "2023-05-31T08:53:32.687727Z",
     "shell.execute_reply": "2023-05-31T08:53:32.686728Z"
    },
    "papermill": {
     "duration": 0.034675,
     "end_time": "2023-05-31T08:53:32.690053",
     "exception": false,
     "start_time": "2023-05-31T08:53:32.655378",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Shape of the books dataset :  (271360, 8)\n",
      "Shape of the users dataset :  (278858, 3)\n",
      "Shape of the rating dataset :  (1149780, 3)\n"
     ]
    }
   ],
   "source": [
    "# Shape of the dataset\n",
    "print(\"Shape of the books dataset : \",books.shape)\n",
    "print(\"Shape of the users dataset : \",users.shape)\n",
    "print(\"Shape of the rating dataset : \",rating.shape)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "a61418d1",
   "metadata": {
    "papermill": {
     "duration": 0.024919,
     "end_time": "2023-05-31T08:53:32.740149",
     "exception": false,
     "start_time": "2023-05-31T08:53:32.715230",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "<h3><div style=\"color:white;\n",
    "           display:fill;\n",
    "           border-radius:5px;\n",
    "           background-color:#F8866D  ;\n",
    "           font-size:300%;\n",
    "           font-family:Sans-serif;\n",
    "           letter-spacing:0.5px\">\n",
    "\n",
    "<p style=\"padding: 15px;\n",
    "              color:white;\n",
    "               text-align:center\">\n",
    "    <b>\n",
    "        1. Checking the unique values for each columns<a class=\"anchor\" id=\"5.1\"></a>\n",
    "        </b>\n",
    "</p>\n",
    "</div></h3>\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "id": "92187596",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2023-05-31T08:53:32.809409Z",
     "iopub.status.busy": "2023-05-31T08:53:32.808895Z",
     "iopub.status.idle": "2023-05-31T08:53:32.876801Z",
     "shell.execute_reply": "2023-05-31T08:53:32.875612Z"
    },
    "papermill": {
     "duration": 0.101507,
     "end_time": "2023-05-31T08:53:32.879088",
     "exception": false,
     "start_time": "2023-05-31T08:53:32.777581",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "User-ID : 278858\n",
      "Location : 57339\n",
      "Age : 166\n"
     ]
    }
   ],
   "source": [
    "for i in users.columns:\n",
    "    print(i, \":\", len(users[i].unique()))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "id": "38042fb3",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2023-05-31T08:53:32.933955Z",
     "iopub.status.busy": "2023-05-31T08:53:32.933351Z",
     "iopub.status.idle": "2023-05-31T08:53:33.486881Z",
     "shell.execute_reply": "2023-05-31T08:53:33.484980Z"
    },
    "papermill": {
     "duration": 0.583265,
     "end_time": "2023-05-31T08:53:33.489666",
     "exception": false,
     "start_time": "2023-05-31T08:53:32.906401",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "ISBN : 271360\n",
      "Book-Title : 242135\n",
      "Book-Author : 102024\n",
      "Year-Of-Publication : 118\n",
      "Publisher : 16808\n",
      "Image-URL-S : 271044\n",
      "Image-URL-M : 271044\n",
      "Image-URL-L : 271042\n"
     ]
    }
   ],
   "source": [
    "for i in books.columns:\n",
    "    print(i, \":\", len(books[i].unique()))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "id": "e7c27513",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2023-05-31T08:53:33.543981Z",
     "iopub.status.busy": "2023-05-31T08:53:33.542925Z",
     "iopub.status.idle": "2023-05-31T08:53:33.803438Z",
     "shell.execute_reply": "2023-05-31T08:53:33.802470Z"
    },
    "papermill": {
     "duration": 0.290279,
     "end_time": "2023-05-31T08:53:33.805982",
     "exception": false,
     "start_time": "2023-05-31T08:53:33.515703",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "User-ID : 105283\n",
      "ISBN : 340556\n",
      "Book-Rating : 11\n"
     ]
    }
   ],
   "source": [
    "for i in rating.columns:\n",
    "    print(i,\":\", len(rating[i].unique()))"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "88586dac",
   "metadata": {
    "papermill": {
     "duration": 0.025649,
     "end_time": "2023-05-31T08:53:33.857699",
     "exception": false,
     "start_time": "2023-05-31T08:53:33.832050",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "<h3><div style=\"color:white;\n",
    "           display:fill;\n",
    "           border-radius:5px;\n",
    "           background-color:#F8866D  ;\n",
    "           font-size:300%;\n",
    "           font-family:Sans-serif;\n",
    "           letter-spacing:0.5px\">\n",
    "\n",
    "<p style=\"padding: 15px;\n",
    "              color:white;\n",
    "               text-align:center\">\n",
    "    <b>\n",
    "        2. Checking for null values<a class=\"anchor\" id=\"5.2\"></a>\n",
    "        </b>\n",
    "</p>\n",
    "</div></h3>\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "id": "869684c3",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2023-05-31T08:53:33.911945Z",
     "iopub.status.busy": "2023-05-31T08:53:33.911177Z",
     "iopub.status.idle": "2023-05-31T08:53:34.610565Z",
     "shell.execute_reply": "2023-05-31T08:53:34.609454Z"
    },
    "papermill": {
     "duration": 0.729491,
     "end_time": "2023-05-31T08:53:34.613204",
     "exception": false,
     "start_time": "2023-05-31T08:53:33.883713",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "ISBN                   0\n",
       "Book-Title             0\n",
       "Book-Author            1\n",
       "Year-Of-Publication    0\n",
       "Publisher              2\n",
       "Image-URL-S            0\n",
       "Image-URL-M            0\n",
       "Image-URL-L            3\n",
       "dtype: int64"
      ]
     },
     "execution_count": 16,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "books.isnull().sum()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "id": "9eb55118",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2023-05-31T08:53:34.669363Z",
     "iopub.status.busy": "2023-05-31T08:53:34.668957Z",
     "iopub.status.idle": "2023-05-31T08:53:34.769464Z",
     "shell.execute_reply": "2023-05-31T08:53:34.768388Z"
    },
    "papermill": {
     "duration": 0.132239,
     "end_time": "2023-05-31T08:53:34.772187",
     "exception": false,
     "start_time": "2023-05-31T08:53:34.639948",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "User-ID          0\n",
       "Location         0\n",
       "Age         110762\n",
       "dtype: int64"
      ]
     },
     "execution_count": 17,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "users.isnull().sum()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "id": "18f00a04",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2023-05-31T08:53:34.826961Z",
     "iopub.status.busy": "2023-05-31T08:53:34.826275Z",
     "iopub.status.idle": "2023-05-31T08:53:35.214343Z",
     "shell.execute_reply": "2023-05-31T08:53:35.213269Z"
    },
    "papermill": {
     "duration": 0.418134,
     "end_time": "2023-05-31T08:53:35.216775",
     "exception": false,
     "start_time": "2023-05-31T08:53:34.798641",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "User-ID        0\n",
       "ISBN           0\n",
       "Book-Rating    0\n",
       "dtype: int64"
      ]
     },
     "execution_count": 18,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "rating.isnull().sum()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "b306d803",
   "metadata": {
    "papermill": {
     "duration": 0.026083,
     "end_time": "2023-05-31T08:53:35.269776",
     "exception": false,
     "start_time": "2023-05-31T08:53:35.243693",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "* The \"books\" dataset contains an insignificant number of null values, so no preprocessing is required in that regard. \n",
    "\n",
    "* On the other hand, the \"age\" column in the users dataset has a substantial numberof null values. However, since age is not a factor to be considered in our recommendation engine, we will leave it as it is without any further modifications."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "6431bc44",
   "metadata": {
    "papermill": {
     "duration": 0.026064,
     "end_time": "2023-05-31T08:53:35.322611",
     "exception": false,
     "start_time": "2023-05-31T08:53:35.296547",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "<h3><div style=\"color:white;\n",
    "           display:fill;\n",
    "           border-radius:5px;\n",
    "           background-color:#F8866D  ;\n",
    "           font-size:300%;\n",
    "           font-family:Sans-serif;\n",
    "           letter-spacing:0.5px\">\n",
    "\n",
    "<p style=\"padding: 15px;\n",
    "              color:white;\n",
    "               text-align:center\">\n",
    "    <b>\n",
    "        3. Data Cleaning<a class=\"anchor\" id=\"5.3\"></a>\n",
    "        </b>\n",
    "</p>\n",
    "</div></h3>\n"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "67b0fd62",
   "metadata": {
    "papermill": {
     "duration": 0.026849,
     "end_time": "2023-05-31T08:53:35.375701",
     "exception": false,
     "start_time": "2023-05-31T08:53:35.348852",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "After examining the data types for each column, it has been observed that the 'Year-Of-Publication' column is categorized as an object type instead of an integer. Let's investigate this matter further."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 19,
   "id": "0fa0047a",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2023-05-31T08:53:35.431326Z",
     "iopub.status.busy": "2023-05-31T08:53:35.429992Z",
     "iopub.status.idle": "2023-05-31T08:53:35.459948Z",
     "shell.execute_reply": "2023-05-31T08:53:35.458855Z"
    },
    "papermill": {
     "duration": 0.060171,
     "end_time": "2023-05-31T08:53:35.462054",
     "exception": false,
     "start_time": "2023-05-31T08:53:35.401883",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array(['2002', '2001', '1991', '1999', '2000', '1993', '1996', '1988',\n",
       "       '2004', '1998', '1994', '2003', '1997', '1983', '1979', '1995',\n",
       "       '1982', '1985', '1992', '1986', '1978', '1980', '1952', '1987',\n",
       "       '1990', '1981', '1989', '1984', '0', '1968', '1961', '1958',\n",
       "       '1974', '1976', '1971', '1977', '1975', '1965', '1941', '1970',\n",
       "       '1962', '1973', '1972', '1960', '1966', '1920', '1956', '1959',\n",
       "       '1953', '1951', '1942', '1963', '1964', '1969', '1954', '1950',\n",
       "       '1967', '2005', '1957', '1940', '1937', '1955', '1946', '1936',\n",
       "       '1930', '2011', '1925', '1948', '1943', '1947', '1945', '1923',\n",
       "       '2020', '1939', '1926', '1938', '2030', '1911', '1904', '1949',\n",
       "       '1932', '1928', '1929', '1927', '1931', '1914', '2050', '1934',\n",
       "       '1910', '1933', '1902', '1924', '1921', '1900', '2038', '2026',\n",
       "       '1944', '1917', '1901', '2010', '1908', '1906', '1935', '1806',\n",
       "       '2021', '2012', '2006', 'DK Publishing Inc', 'Gallimard', '1909',\n",
       "       '2008', '1378', '1919', '1922', '1897', '2024', '1376', '2037'],\n",
       "      dtype=object)"
      ]
     },
     "execution_count": 19,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "books['Year-Of-Publication'].unique()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "4f7373fd",
   "metadata": {
    "papermill": {
     "duration": 0.02655,
     "end_time": "2023-05-31T08:53:35.515200",
     "exception": false,
     "start_time": "2023-05-31T08:53:35.488650",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "When we display the unique values of that column, we notice the presence of certain values that are not years. To thoroughly examine this issue, let's inspect the entire rows where these non-year values are present."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 20,
   "id": "3f52d0ac",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2023-05-31T08:53:35.570820Z",
     "iopub.status.busy": "2023-05-31T08:53:35.570074Z",
     "iopub.status.idle": "2023-05-31T08:53:35.671943Z",
     "shell.execute_reply": "2023-05-31T08:53:35.670894Z"
    },
    "papermill": {
     "duration": 0.132665,
     "end_time": "2023-05-31T08:53:35.674380",
     "exception": false,
     "start_time": "2023-05-31T08:53:35.541715",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>ISBN</th>\n",
       "      <th>Book-Title</th>\n",
       "      <th>Book-Author</th>\n",
       "      <th>Year-Of-Publication</th>\n",
       "      <th>Publisher</th>\n",
       "      <th>Image-URL-S</th>\n",
       "      <th>Image-URL-M</th>\n",
       "      <th>Image-URL-L</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>209538</th>\n",
       "      <td>078946697X</td>\n",
       "      <td>DK Readers: Creating the X-Men, How It All Beg...</td>\n",
       "      <td>2000</td>\n",
       "      <td>DK Publishing Inc</td>\n",
       "      <td>http://images.amazon.com/images/P/078946697X.0...</td>\n",
       "      <td>http://images.amazon.com/images/P/078946697X.0...</td>\n",
       "      <td>http://images.amazon.com/images/P/078946697X.0...</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>220731</th>\n",
       "      <td>2070426769</td>\n",
       "      <td>Peuple du ciel, suivi de 'Les Bergers\\\";Jean-M...</td>\n",
       "      <td>2003</td>\n",
       "      <td>Gallimard</td>\n",
       "      <td>http://images.amazon.com/images/P/2070426769.0...</td>\n",
       "      <td>http://images.amazon.com/images/P/2070426769.0...</td>\n",
       "      <td>http://images.amazon.com/images/P/2070426769.0...</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>221678</th>\n",
       "      <td>0789466953</td>\n",
       "      <td>DK Readers: Creating the X-Men, How Comic Book...</td>\n",
       "      <td>2000</td>\n",
       "      <td>DK Publishing Inc</td>\n",
       "      <td>http://images.amazon.com/images/P/0789466953.0...</td>\n",
       "      <td>http://images.amazon.com/images/P/0789466953.0...</td>\n",
       "      <td>http://images.amazon.com/images/P/0789466953.0...</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "              ISBN                                         Book-Title  \\\n",
       "209538  078946697X  DK Readers: Creating the X-Men, How It All Beg...   \n",
       "220731  2070426769  Peuple du ciel, suivi de 'Les Bergers\\\";Jean-M...   \n",
       "221678  0789466953  DK Readers: Creating the X-Men, How Comic Book...   \n",
       "\n",
       "       Book-Author Year-Of-Publication  \\\n",
       "209538        2000   DK Publishing Inc   \n",
       "220731        2003           Gallimard   \n",
       "221678        2000   DK Publishing Inc   \n",
       "\n",
       "                                                Publisher  \\\n",
       "209538  http://images.amazon.com/images/P/078946697X.0...   \n",
       "220731  http://images.amazon.com/images/P/2070426769.0...   \n",
       "221678  http://images.amazon.com/images/P/0789466953.0...   \n",
       "\n",
       "                                              Image-URL-S  \\\n",
       "209538  http://images.amazon.com/images/P/078946697X.0...   \n",
       "220731  http://images.amazon.com/images/P/2070426769.0...   \n",
       "221678  http://images.amazon.com/images/P/0789466953.0...   \n",
       "\n",
       "                                              Image-URL-M Image-URL-L  \n",
       "209538  http://images.amazon.com/images/P/078946697X.0...         NaN  \n",
       "220731  http://images.amazon.com/images/P/2070426769.0...         NaN  \n",
       "221678  http://images.amazon.com/images/P/0789466953.0...         NaN  "
      ]
     },
     "execution_count": 20,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "points = books[(books['Year-Of-Publication'] == 'DK Publishing Inc') | (books['Year-Of-Publication'] == 'Gallimard')]\n",
    "points"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 21,
   "id": "cbaea23f",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2023-05-31T08:53:35.729913Z",
     "iopub.status.busy": "2023-05-31T08:53:35.729513Z",
     "iopub.status.idle": "2023-05-31T08:53:35.737065Z",
     "shell.execute_reply": "2023-05-31T08:53:35.736008Z"
    },
    "papermill": {
     "duration": 0.038044,
     "end_time": "2023-05-31T08:53:35.739208",
     "exception": false,
     "start_time": "2023-05-31T08:53:35.701164",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array(['DK Readers: Creating the X-Men, How It All Began (Level 4: Proficient Readers)\\\\\";Michael Teitelbaum\"',\n",
       "       'Peuple du ciel, suivi de \\'Les Bergers\\\\\";Jean-Marie Gustave Le ClÃ?Â©zio\"',\n",
       "       'DK Readers: Creating the X-Men, How Comic Books Come to Life (Level 4: Proficient Readers)\\\\\";James Buckley\"'],\n",
       "      dtype=object)"
      ]
     },
     "execution_count": 21,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "points[\"Book-Title\"].unique()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "e59207db",
   "metadata": {
    "papermill": {
     "duration": 0.02689,
     "end_time": "2023-05-31T08:53:35.793332",
     "exception": false,
     "start_time": "2023-05-31T08:53:35.766442",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "Upon closer examination, it appears that there are errors in the data entries. The years are mistakenly entered in the book-author column, causing subsequent values to be misplaced in the preceding columns. Furthermore, it seems that book authors are recorded alongside the book titles. This data inconsistency requires attention and rectification."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 22,
   "id": "8ecd3be6",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2023-05-31T08:53:35.849057Z",
     "iopub.status.busy": "2023-05-31T08:53:35.848687Z",
     "iopub.status.idle": "2023-05-31T08:53:36.131263Z",
     "shell.execute_reply": "2023-05-31T08:53:36.130296Z"
    },
    "papermill": {
     "duration": 0.313448,
     "end_time": "2023-05-31T08:53:36.133967",
     "exception": false,
     "start_time": "2023-05-31T08:53:35.820519",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "authors = []\n",
    "books_titles = []\n",
    "\n",
    "for title in points['Book-Title']:\n",
    "    \n",
    "    author = title.split(';')[-1].split('\"')[0]\n",
    "    book = title.split(';')[0].split('\\\\')[0]\n",
    "\n",
    "    authors.append(author)\n",
    "    books_titles.append(book)\n",
    "    \n",
    "shift = points.iloc[:,2:].shift(periods=1, axis=1)\n",
    "points = points.iloc[:,:1]\n",
    "df = pd.concat([points, shift], axis=1)\n",
    "df = df.drop(columns=\"Book-Author\")\n",
    "df.insert(loc=1, column='Book-Title', value=books_titles)\n",
    "df.insert(loc=2, column='Book-Author', value=authors)\n",
    "\n",
    "books.drop(df.index, axis=0, inplace=True)\n",
    "for i in df.index:\n",
    "     books.loc[i] = list(df.loc[i].values)\n",
    "\n",
    "books['Year-Of-Publication'] = books['Year-Of-Publication'].astype('int32')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 23,
   "id": "2034c030",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2023-05-31T08:53:36.189884Z",
     "iopub.status.busy": "2023-05-31T08:53:36.189513Z",
     "iopub.status.idle": "2023-05-31T08:53:36.791965Z",
     "shell.execute_reply": "2023-05-31T08:53:36.790647Z"
    },
    "papermill": {
     "duration": 0.633242,
     "end_time": "2023-05-31T08:53:36.794283",
     "exception": false,
     "start_time": "2023-05-31T08:53:36.161041",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "<class 'pandas.core.frame.DataFrame'>\n",
      "Int64Index: 271360 entries, 0 to 221678\n",
      "Data columns (total 8 columns):\n",
      " #   Column               Non-Null Count   Dtype \n",
      "---  ------               --------------   ----- \n",
      " 0   ISBN                 271360 non-null  object\n",
      " 1   Book-Title           271360 non-null  object\n",
      " 2   Book-Author          271359 non-null  object\n",
      " 3   Year-Of-Publication  271360 non-null  int32 \n",
      " 4   Publisher            271358 non-null  object\n",
      " 5   Image-URL-S          271360 non-null  object\n",
      " 6   Image-URL-M          271360 non-null  object\n",
      " 7   Image-URL-L          271360 non-null  object\n",
      "dtypes: int32(1), object(7)\n",
      "memory usage: 17.6+ MB\n"
     ]
    }
   ],
   "source": [
    "books.info()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "65974051",
   "metadata": {
    "papermill": {
     "duration": 0.026965,
     "end_time": "2023-05-31T08:53:36.848400",
     "exception": false,
     "start_time": "2023-05-31T08:53:36.821435",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "After completing the required data processing steps, we have ensured that the data is now prepared and ready for use."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "1c73d441",
   "metadata": {
    "papermill": {
     "duration": 0.026556,
     "end_time": "2023-05-31T08:53:36.901943",
     "exception": false,
     "start_time": "2023-05-31T08:53:36.875387",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "<h2><div style=\"color:white;\n",
    "           display:fill;\n",
    "           border-radius:5px;\n",
    "           background-color:#FF5733  ;\n",
    "           font-size:300%;\n",
    "           font-family:Sans-serif;\n",
    "           letter-spacing:0.5px\">\n",
    "\n",
    "<p style=\"padding: 15px;\n",
    "              color:white;\n",
    "               text-align:center\">\n",
    "    <b>\n",
    "        Popularity Based Recommendations<a class=\"anchor\" id=\"6\"></a>\n",
    "        </b>\n",
    "</p>\n",
    "</div></h2>"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "91a82db8",
   "metadata": {
    "papermill": {
     "duration": 0.026489,
     "end_time": "2023-05-31T08:53:36.955379",
     "exception": false,
     "start_time": "2023-05-31T08:53:36.928890",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "* In this section, our goal is to recommend popular books to users.\n",
    "\n",
    "* We will determine these popular books based on their average rating and the frequency of ratings they have received. To accomplish this, we will begin by merging the books and rating datasets. \n",
    "\n",
    "* This combined dataset will provide us with the necessary information to identify and recommend the most popular books to our users."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 24,
   "id": "71cd20a9",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2023-05-31T08:53:37.011459Z",
     "iopub.status.busy": "2023-05-31T08:53:37.011054Z",
     "iopub.status.idle": "2023-05-31T08:53:38.068329Z",
     "shell.execute_reply": "2023-05-31T08:53:38.067427Z"
    },
    "papermill": {
     "duration": 1.088716,
     "end_time": "2023-05-31T08:53:38.070691",
     "exception": false,
     "start_time": "2023-05-31T08:53:36.981975",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>ISBN</th>\n",
       "      <th>Book-Title</th>\n",
       "      <th>Book-Author</th>\n",
       "      <th>Year-Of-Publication</th>\n",
       "      <th>Publisher</th>\n",
       "      <th>Image-URL-S</th>\n",
       "      <th>Image-URL-M</th>\n",
       "      <th>Image-URL-L</th>\n",
       "      <th>User-ID</th>\n",
       "      <th>Book-Rating</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>0195153448</td>\n",
       "      <td>Classical Mythology</td>\n",
       "      <td>Mark P. O. Morford</td>\n",
       "      <td>2002</td>\n",
       "      <td>Oxford University Press</td>\n",
       "      <td>http://images.amazon.com/images/P/0195153448.0...</td>\n",
       "      <td>http://images.amazon.com/images/P/0195153448.0...</td>\n",
       "      <td>http://images.amazon.com/images/P/0195153448.0...</td>\n",
       "      <td>2.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>0002005018</td>\n",
       "      <td>Clara Callan</td>\n",
       "      <td>Richard Bruce Wright</td>\n",
       "      <td>2001</td>\n",
       "      <td>HarperFlamingo Canada</td>\n",
       "      <td>http://images.amazon.com/images/P/0002005018.0...</td>\n",
       "      <td>http://images.amazon.com/images/P/0002005018.0...</td>\n",
       "      <td>http://images.amazon.com/images/P/0002005018.0...</td>\n",
       "      <td>8.0</td>\n",
       "      <td>5.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>0002005018</td>\n",
       "      <td>Clara Callan</td>\n",
       "      <td>Richard Bruce Wright</td>\n",
       "      <td>2001</td>\n",
       "      <td>HarperFlamingo Canada</td>\n",
       "      <td>http://images.amazon.com/images/P/0002005018.0...</td>\n",
       "      <td>http://images.amazon.com/images/P/0002005018.0...</td>\n",
       "      <td>http://images.amazon.com/images/P/0002005018.0...</td>\n",
       "      <td>11400.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>0002005018</td>\n",
       "      <td>Clara Callan</td>\n",
       "      <td>Richard Bruce Wright</td>\n",
       "      <td>2001</td>\n",
       "      <td>HarperFlamingo Canada</td>\n",
       "      <td>http://images.amazon.com/images/P/0002005018.0...</td>\n",
       "      <td>http://images.amazon.com/images/P/0002005018.0...</td>\n",
       "      <td>http://images.amazon.com/images/P/0002005018.0...</td>\n",
       "      <td>11676.0</td>\n",
       "      <td>8.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>0002005018</td>\n",
       "      <td>Clara Callan</td>\n",
       "      <td>Richard Bruce Wright</td>\n",
       "      <td>2001</td>\n",
       "      <td>HarperFlamingo Canada</td>\n",
       "      <td>http://images.amazon.com/images/P/0002005018.0...</td>\n",
       "      <td>http://images.amazon.com/images/P/0002005018.0...</td>\n",
       "      <td>http://images.amazon.com/images/P/0002005018.0...</td>\n",
       "      <td>41385.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1032340</th>\n",
       "      <td>0767409752</td>\n",
       "      <td>A Guided Tour of Rene Descartes' Meditations o...</td>\n",
       "      <td>Christopher  Biffle</td>\n",
       "      <td>2000</td>\n",
       "      <td>McGraw-Hill Humanities/Social Sciences/Languages</td>\n",
       "      <td>http://images.amazon.com/images/P/0767409752.0...</td>\n",
       "      <td>http://images.amazon.com/images/P/0767409752.0...</td>\n",
       "      <td>http://images.amazon.com/images/P/0767409752.0...</td>\n",
       "      <td>276680.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1032341</th>\n",
       "      <td>078946697X</td>\n",
       "      <td>DK Readers: Creating the X-Men, How It All Beg...</td>\n",
       "      <td>Michael Teitelbaum</td>\n",
       "      <td>2000</td>\n",
       "      <td>DK Publishing Inc</td>\n",
       "      <td>http://images.amazon.com/images/P/078946697X.0...</td>\n",
       "      <td>http://images.amazon.com/images/P/078946697X.0...</td>\n",
       "      <td>http://images.amazon.com/images/P/078946697X.0...</td>\n",
       "      <td>169663.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1032342</th>\n",
       "      <td>078946697X</td>\n",
       "      <td>DK Readers: Creating the X-Men, How It All Beg...</td>\n",
       "      <td>Michael Teitelbaum</td>\n",
       "      <td>2000</td>\n",
       "      <td>DK Publishing Inc</td>\n",
       "      <td>http://images.amazon.com/images/P/078946697X.0...</td>\n",
       "      <td>http://images.amazon.com/images/P/078946697X.0...</td>\n",
       "      <td>http://images.amazon.com/images/P/078946697X.0...</td>\n",
       "      <td>227771.0</td>\n",
       "      <td>7.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1032343</th>\n",
       "      <td>2070426769</td>\n",
       "      <td>Peuple du ciel, suivi de 'Les Bergers</td>\n",
       "      <td>Jean-Marie Gustave Le ClÃ?Â©zio</td>\n",
       "      <td>2003</td>\n",
       "      <td>Gallimard</td>\n",
       "      <td>http://images.amazon.com/images/P/2070426769.0...</td>\n",
       "      <td>http://images.amazon.com/images/P/2070426769.0...</td>\n",
       "      <td>http://images.amazon.com/images/P/2070426769.0...</td>\n",
       "      <td>137190.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1032344</th>\n",
       "      <td>0789466953</td>\n",
       "      <td>DK Readers: Creating the X-Men, How Comic Book...</td>\n",
       "      <td>James Buckley</td>\n",
       "      <td>2000</td>\n",
       "      <td>DK Publishing Inc</td>\n",
       "      <td>http://images.amazon.com/images/P/0789466953.0...</td>\n",
       "      <td>http://images.amazon.com/images/P/0789466953.0...</td>\n",
       "      <td>http://images.amazon.com/images/P/0789466953.0...</td>\n",
       "      <td>130571.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>1032345 rows × 10 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "               ISBN                                         Book-Title  \\\n",
       "0        0195153448                                Classical Mythology   \n",
       "1        0002005018                                       Clara Callan   \n",
       "2        0002005018                                       Clara Callan   \n",
       "3        0002005018                                       Clara Callan   \n",
       "4        0002005018                                       Clara Callan   \n",
       "...             ...                                                ...   \n",
       "1032340  0767409752  A Guided Tour of Rene Descartes' Meditations o...   \n",
       "1032341  078946697X  DK Readers: Creating the X-Men, How It All Beg...   \n",
       "1032342  078946697X  DK Readers: Creating the X-Men, How It All Beg...   \n",
       "1032343  2070426769              Peuple du ciel, suivi de 'Les Bergers   \n",
       "1032344  0789466953  DK Readers: Creating the X-Men, How Comic Book...   \n",
       "\n",
       "                             Book-Author  Year-Of-Publication  \\\n",
       "0                     Mark P. O. Morford                 2002   \n",
       "1                   Richard Bruce Wright                 2001   \n",
       "2                   Richard Bruce Wright                 2001   \n",
       "3                   Richard Bruce Wright                 2001   \n",
       "4                   Richard Bruce Wright                 2001   \n",
       "...                                  ...                  ...   \n",
       "1032340              Christopher  Biffle                 2000   \n",
       "1032341               Michael Teitelbaum                 2000   \n",
       "1032342               Michael Teitelbaum                 2000   \n",
       "1032343  Jean-Marie Gustave Le ClÃ?Â©zio                 2003   \n",
       "1032344                    James Buckley                 2000   \n",
       "\n",
       "                                                Publisher  \\\n",
       "0                                 Oxford University Press   \n",
       "1                                   HarperFlamingo Canada   \n",
       "2                                   HarperFlamingo Canada   \n",
       "3                                   HarperFlamingo Canada   \n",
       "4                                   HarperFlamingo Canada   \n",
       "...                                                   ...   \n",
       "1032340  McGraw-Hill Humanities/Social Sciences/Languages   \n",
       "1032341                                 DK Publishing Inc   \n",
       "1032342                                 DK Publishing Inc   \n",
       "1032343                                         Gallimard   \n",
       "1032344                                 DK Publishing Inc   \n",
       "\n",
       "                                               Image-URL-S  \\\n",
       "0        http://images.amazon.com/images/P/0195153448.0...   \n",
       "1        http://images.amazon.com/images/P/0002005018.0...   \n",
       "2        http://images.amazon.com/images/P/0002005018.0...   \n",
       "3        http://images.amazon.com/images/P/0002005018.0...   \n",
       "4        http://images.amazon.com/images/P/0002005018.0...   \n",
       "...                                                    ...   \n",
       "1032340  http://images.amazon.com/images/P/0767409752.0...   \n",
       "1032341  http://images.amazon.com/images/P/078946697X.0...   \n",
       "1032342  http://images.amazon.com/images/P/078946697X.0...   \n",
       "1032343  http://images.amazon.com/images/P/2070426769.0...   \n",
       "1032344  http://images.amazon.com/images/P/0789466953.0...   \n",
       "\n",
       "                                               Image-URL-M  \\\n",
       "0        http://images.amazon.com/images/P/0195153448.0...   \n",
       "1        http://images.amazon.com/images/P/0002005018.0...   \n",
       "2        http://images.amazon.com/images/P/0002005018.0...   \n",
       "3        http://images.amazon.com/images/P/0002005018.0...   \n",
       "4        http://images.amazon.com/images/P/0002005018.0...   \n",
       "...                                                    ...   \n",
       "1032340  http://images.amazon.com/images/P/0767409752.0...   \n",
       "1032341  http://images.amazon.com/images/P/078946697X.0...   \n",
       "1032342  http://images.amazon.com/images/P/078946697X.0...   \n",
       "1032343  http://images.amazon.com/images/P/2070426769.0...   \n",
       "1032344  http://images.amazon.com/images/P/0789466953.0...   \n",
       "\n",
       "                                               Image-URL-L   User-ID  \\\n",
       "0        http://images.amazon.com/images/P/0195153448.0...       2.0   \n",
       "1        http://images.amazon.com/images/P/0002005018.0...       8.0   \n",
       "2        http://images.amazon.com/images/P/0002005018.0...   11400.0   \n",
       "3        http://images.amazon.com/images/P/0002005018.0...   11676.0   \n",
       "4        http://images.amazon.com/images/P/0002005018.0...   41385.0   \n",
       "...                                                    ...       ...   \n",
       "1032340  http://images.amazon.com/images/P/0767409752.0...  276680.0   \n",
       "1032341  http://images.amazon.com/images/P/078946697X.0...  169663.0   \n",
       "1032342  http://images.amazon.com/images/P/078946697X.0...  227771.0   \n",
       "1032343  http://images.amazon.com/images/P/2070426769.0...  137190.0   \n",
       "1032344  http://images.amazon.com/images/P/0789466953.0...  130571.0   \n",
       "\n",
       "         Book-Rating  \n",
       "0                0.0  \n",
       "1                5.0  \n",
       "2                0.0  \n",
       "3                8.0  \n",
       "4                0.0  \n",
       "...              ...  \n",
       "1032340          0.0  \n",
       "1032341          0.0  \n",
       "1032342          7.0  \n",
       "1032343          0.0  \n",
       "1032344          0.0  \n",
       "\n",
       "[1032345 rows x 10 columns]"
      ]
     },
     "execution_count": 24,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "books_rating = pd.merge(books, rating, on=\"ISBN\", how=\"left\")\n",
    "books_rating"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 25,
   "id": "72fa1f50",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2023-05-31T08:53:38.127680Z",
     "iopub.status.busy": "2023-05-31T08:53:38.127271Z",
     "iopub.status.idle": "2023-05-31T08:53:38.151268Z",
     "shell.execute_reply": "2023-05-31T08:53:38.150249Z"
    },
    "papermill": {
     "duration": 0.054993,
     "end_time": "2023-05-31T08:53:38.153448",
     "exception": false,
     "start_time": "2023-05-31T08:53:38.098455",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0.0     647294\n",
       "8.0      91804\n",
       "10.0     71225\n",
       "7.0      66402\n",
       "9.0      60778\n",
       "5.0      45355\n",
       "6.0      31687\n",
       "4.0       7617\n",
       "3.0       5118\n",
       "2.0       2375\n",
       "1.0       1481\n",
       "Name: Book-Rating, dtype: int64"
      ]
     },
     "execution_count": 25,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "books_rating[\"Book-Rating\"].value_counts()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "98ecc2a3",
   "metadata": {
    "papermill": {
     "duration": 0.02766,
     "end_time": "2023-05-31T08:53:38.209295",
     "exception": false,
     "start_time": "2023-05-31T08:53:38.181635",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "There are significant number of books that have been rated as 0. These books won't be included in the recommendations as, it is not advisible to recommend such books to the users. Consequently, we will remove them from the dataset."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 26,
   "id": "9b3071d5",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2023-05-31T08:53:38.267510Z",
     "iopub.status.busy": "2023-05-31T08:53:38.266702Z",
     "iopub.status.idle": "2023-05-31T08:53:38.638087Z",
     "shell.execute_reply": "2023-05-31T08:53:38.636930Z"
    },
    "papermill": {
     "duration": 0.403373,
     "end_time": "2023-05-31T08:53:38.640786",
     "exception": false,
     "start_time": "2023-05-31T08:53:38.237413",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "popular = books_rating[(books_rating[\"Book-Rating\"] != 0)]"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "e876648b",
   "metadata": {
    "papermill": {
     "duration": 0.027562,
     "end_time": "2023-05-31T08:53:38.696374",
     "exception": false,
     "start_time": "2023-05-31T08:53:38.668812",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "We shall build a function, that retrieves popular items based on their frequency of ratings and average ratings."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 27,
   "id": "9eb4352e",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2023-05-31T08:53:38.753699Z",
     "iopub.status.busy": "2023-05-31T08:53:38.753303Z",
     "iopub.status.idle": "2023-05-31T08:53:38.759554Z",
     "shell.execute_reply": "2023-05-31T08:53:38.758697Z"
    },
    "papermill": {
     "duration": 0.037178,
     "end_time": "2023-05-31T08:53:38.761597",
     "exception": false,
     "start_time": "2023-05-31T08:53:38.724419",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "def popularity(var, top):\n",
    "    popular = books_rating[(books_rating[\"Book-Rating\"] != 0)]\n",
    "    popular_df = pd.DataFrame(popular.groupby(var).agg({'Book-Rating':['count','mean']}))\n",
    "    popular_df.columns = ['num_ratings','avg_rating']\n",
    "    popular_df = popular_df.sort_values(by=[\"num_ratings\",\"avg_rating\"],ascending=False).head(top)\n",
    "    popular_df = popular_df.sort_values(by=\"avg_rating\", ascending=False).head(top)\n",
    "    return popular_df"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "b3a64fad",
   "metadata": {
    "papermill": {
     "duration": 0.027399,
     "end_time": "2023-05-31T08:53:38.816864",
     "exception": false,
     "start_time": "2023-05-31T08:53:38.789465",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "### Top 50 Popular Books based on Ratings"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 28,
   "id": "785b73a4",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2023-05-31T08:53:38.875004Z",
     "iopub.status.busy": "2023-05-31T08:53:38.874408Z",
     "iopub.status.idle": "2023-05-31T08:53:39.404043Z",
     "shell.execute_reply": "2023-05-31T08:53:39.403064Z"
    },
    "papermill": {
     "duration": 0.562107,
     "end_time": "2023-05-31T08:53:39.406943",
     "exception": false,
     "start_time": "2023-05-31T08:53:38.844836",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Book-Title</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>Harry Potter and the Goblet of Fire (Book 4)</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>Harry Potter and the Order of the Phoenix (Boo...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>Harry Potter and the Prisoner of Azkaban (Book 3)</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>To Kill a Mockingbird</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>Harry Potter and the Sorcerer's Stone (Harry P...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>The Fellowship of the Ring (The Lord of the Ri...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>Harry Potter and the Chamber of Secrets (Book 2)</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>Tuesdays with Morrie: An Old Man, a Young Man,...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>Fahrenheit 451</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>The Secret Life of Bees</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10</th>\n",
       "      <td>The Da Vinci Code</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11</th>\n",
       "      <td>The Lovely Bones: A Novel</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>The Red Tent (Bestselling Backlist)</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13</th>\n",
       "      <td>The Poisonwood Bible: A Novel</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14</th>\n",
       "      <td>The Joy Luck Club</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15</th>\n",
       "      <td>Where the Heart Is (Oprah's Book Club (Paperba...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>Life of Pi</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17</th>\n",
       "      <td>Good in Bed</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>18</th>\n",
       "      <td>The Five People You Meet in Heaven</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19</th>\n",
       "      <td>Angels &amp;amp; Demons</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>20</th>\n",
       "      <td>A Time to Kill</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>21</th>\n",
       "      <td>Girl with a Pearl Earring</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>22</th>\n",
       "      <td>The Notebook</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>23</th>\n",
       "      <td>Jurassic Park</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>24</th>\n",
       "      <td>Divine Secrets of the Ya-Ya Sisterhood: A Novel</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>25</th>\n",
       "      <td>Timeline</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>26</th>\n",
       "      <td>Me Talk Pretty One Day</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>27</th>\n",
       "      <td>Snow Falling on Cedars</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>28</th>\n",
       "      <td>The Firm</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>29</th>\n",
       "      <td>Interview with the Vampire</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>30</th>\n",
       "      <td>1st to Die: A Novel</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>31</th>\n",
       "      <td>The Catcher in the Rye</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>32</th>\n",
       "      <td>She's Come Undone (Oprah's Book Club)</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>33</th>\n",
       "      <td>The Partner</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>34</th>\n",
       "      <td>Suzanne's Diary for Nicholas</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>35</th>\n",
       "      <td>Bridget Jones's Diary</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>36</th>\n",
       "      <td>The Street Lawyer</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>37</th>\n",
       "      <td>She's Come Undone (Oprah's Book Club (Paperback))</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>38</th>\n",
       "      <td>The Testament</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>39</th>\n",
       "      <td>The Pilot's Wife : A Novel</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>40</th>\n",
       "      <td>Summer Sisters</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>41</th>\n",
       "      <td>The Brethren</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>42</th>\n",
       "      <td>The Nanny Diaries: A Novel</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>43</th>\n",
       "      <td>The Chamber</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>44</th>\n",
       "      <td>A Painted House</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>45</th>\n",
       "      <td>House of Sand and Fog</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>46</th>\n",
       "      <td>The Summons</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>47</th>\n",
       "      <td>Dreamcatcher</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>48</th>\n",
       "      <td>The Girls' Guide to Hunting and Fishing</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>49</th>\n",
       "      <td>Wild Animus</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                                           Book-Title\n",
       "0        Harry Potter and the Goblet of Fire (Book 4)\n",
       "1   Harry Potter and the Order of the Phoenix (Boo...\n",
       "2   Harry Potter and the Prisoner of Azkaban (Book 3)\n",
       "3                               To Kill a Mockingbird\n",
       "4   Harry Potter and the Sorcerer's Stone (Harry P...\n",
       "5   The Fellowship of the Ring (The Lord of the Ri...\n",
       "6    Harry Potter and the Chamber of Secrets (Book 2)\n",
       "7   Tuesdays with Morrie: An Old Man, a Young Man,...\n",
       "8                                      Fahrenheit 451\n",
       "9                             The Secret Life of Bees\n",
       "10                                  The Da Vinci Code\n",
       "11                          The Lovely Bones: A Novel\n",
       "12                The Red Tent (Bestselling Backlist)\n",
       "13                      The Poisonwood Bible: A Novel\n",
       "14                                  The Joy Luck Club\n",
       "15  Where the Heart Is (Oprah's Book Club (Paperba...\n",
       "16                                         Life of Pi\n",
       "17                                        Good in Bed\n",
       "18                 The Five People You Meet in Heaven\n",
       "19                                Angels &amp; Demons\n",
       "20                                     A Time to Kill\n",
       "21                          Girl with a Pearl Earring\n",
       "22                                       The Notebook\n",
       "23                                      Jurassic Park\n",
       "24    Divine Secrets of the Ya-Ya Sisterhood: A Novel\n",
       "25                                           Timeline\n",
       "26                             Me Talk Pretty One Day\n",
       "27                             Snow Falling on Cedars\n",
       "28                                           The Firm\n",
       "29                         Interview with the Vampire\n",
       "30                                1st to Die: A Novel\n",
       "31                             The Catcher in the Rye\n",
       "32              She's Come Undone (Oprah's Book Club)\n",
       "33                                        The Partner\n",
       "34                       Suzanne's Diary for Nicholas\n",
       "35                              Bridget Jones's Diary\n",
       "36                                  The Street Lawyer\n",
       "37  She's Come Undone (Oprah's Book Club (Paperback))\n",
       "38                                      The Testament\n",
       "39                         The Pilot's Wife : A Novel\n",
       "40                                     Summer Sisters\n",
       "41                                       The Brethren\n",
       "42                         The Nanny Diaries: A Novel\n",
       "43                                        The Chamber\n",
       "44                                    A Painted House\n",
       "45                              House of Sand and Fog\n",
       "46                                        The Summons\n",
       "47                                       Dreamcatcher\n",
       "48            The Girls' Guide to Hunting and Fishing\n",
       "49                                        Wild Animus"
      ]
     },
     "execution_count": 28,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "popular_books = popularity(var=\"Book-Title\", top=50).reset_index().drop(columns=[\"num_ratings\",\"avg_rating\"])\n",
    "popular_books"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 29,
   "id": "0b710fc9",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2023-05-31T08:53:39.466046Z",
     "iopub.status.busy": "2023-05-31T08:53:39.465631Z",
     "iopub.status.idle": "2023-05-31T08:53:39.548084Z",
     "shell.execute_reply": "2023-05-31T08:53:39.546937Z"
    },
    "papermill": {
     "duration": 0.114614,
     "end_time": "2023-05-31T08:53:39.550470",
     "exception": false,
     "start_time": "2023-05-31T08:53:39.435856",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Book-Title</th>\n",
       "      <th>num_ratings</th>\n",
       "      <th>avg_rating</th>\n",
       "      <th>Book-Author</th>\n",
       "      <th>Publisher</th>\n",
       "      <th>link</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>27</th>\n",
       "      <td>Harry Potter and the Goblet of Fire (Book 4)</td>\n",
       "      <td>247</td>\n",
       "      <td>9.125506</td>\n",
       "      <td>J. K. Rowling</td>\n",
       "      <td>Scholastic</td>\n",
       "      <td>http://images.amazon.com/images/P/0439139597.0...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>42</th>\n",
       "      <td>Harry Potter and the Order of the Phoenix (Boo...</td>\n",
       "      <td>211</td>\n",
       "      <td>9.047393</td>\n",
       "      <td>J. K. Rowling</td>\n",
       "      <td>Scholastic</td>\n",
       "      <td>http://images.amazon.com/images/P/043935806X.0...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17</th>\n",
       "      <td>Harry Potter and the Prisoner of Azkaban (Book 3)</td>\n",
       "      <td>277</td>\n",
       "      <td>9.043321</td>\n",
       "      <td>J. K. Rowling</td>\n",
       "      <td>Scholastic</td>\n",
       "      <td>http://images.amazon.com/images/P/0439136350.0...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>20</th>\n",
       "      <td>To Kill a Mockingbird</td>\n",
       "      <td>267</td>\n",
       "      <td>8.977528</td>\n",
       "      <td>Harper Lee</td>\n",
       "      <td>Little Brown &amp;amp; Company</td>\n",
       "      <td>http://images.amazon.com/images/P/0446310786.0...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11</th>\n",
       "      <td>Harry Potter and the Sorcerer's Stone (Harry P...</td>\n",
       "      <td>315</td>\n",
       "      <td>8.936508</td>\n",
       "      <td>J. K. Rowling</td>\n",
       "      <td>Arthur A. Levine Books</td>\n",
       "      <td>http://images.amazon.com/images/P/059035342X.0...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>47</th>\n",
       "      <td>The Fellowship of the Ring (The Lord of the Ri...</td>\n",
       "      <td>205</td>\n",
       "      <td>8.882927</td>\n",
       "      <td>J.R.R. TOLKIEN</td>\n",
       "      <td>Del Rey</td>\n",
       "      <td>http://images.amazon.com/images/P/0345339703.0...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>Harry Potter and the Chamber of Secrets (Book 2)</td>\n",
       "      <td>326</td>\n",
       "      <td>8.840491</td>\n",
       "      <td>J. K. Rowling</td>\n",
       "      <td>Scholastic</td>\n",
       "      <td>http://images.amazon.com/images/P/0439064872.0...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>26</th>\n",
       "      <td>Tuesdays with Morrie: An Old Man, a Young Man,...</td>\n",
       "      <td>250</td>\n",
       "      <td>8.588000</td>\n",
       "      <td>MITCH ALBOM</td>\n",
       "      <td>Doubleday</td>\n",
       "      <td>http://images.amazon.com/images/P/0385484518.0...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>49</th>\n",
       "      <td>Fahrenheit 451</td>\n",
       "      <td>204</td>\n",
       "      <td>8.549020</td>\n",
       "      <td>Ray Bradbury</td>\n",
       "      <td>Distribooks Inc</td>\n",
       "      <td>http://images.amazon.com/images/P/3257208626.0...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>The Secret Life of Bees</td>\n",
       "      <td>406</td>\n",
       "      <td>8.477833</td>\n",
       "      <td>Sue Monk Kidd</td>\n",
       "      <td>Penguin Books</td>\n",
       "      <td>http://images.amazon.com/images/P/0142001740.0...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>The Da Vinci Code</td>\n",
       "      <td>494</td>\n",
       "      <td>8.439271</td>\n",
       "      <td>Dan Brown</td>\n",
       "      <td>Doubleday</td>\n",
       "      <td>http://images.amazon.com/images/P/0385504209.0...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>The Lovely Bones: A Novel</td>\n",
       "      <td>707</td>\n",
       "      <td>8.185290</td>\n",
       "      <td>Alice Sebold</td>\n",
       "      <td>Little, Brown</td>\n",
       "      <td>http://images.amazon.com/images/P/0316666343.0...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>The Red Tent (Bestselling Backlist)</td>\n",
       "      <td>383</td>\n",
       "      <td>8.182768</td>\n",
       "      <td>Anita Diamant</td>\n",
       "      <td>Picador USA</td>\n",
       "      <td>http://images.amazon.com/images/P/0312195516.0...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>35</th>\n",
       "      <td>The Poisonwood Bible: A Novel</td>\n",
       "      <td>218</td>\n",
       "      <td>8.178899</td>\n",
       "      <td>Barbara Kingsolver</td>\n",
       "      <td>Perennial</td>\n",
       "      <td>http://images.amazon.com/images/P/0060930535.0...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>43</th>\n",
       "      <td>The Joy Luck Club</td>\n",
       "      <td>208</td>\n",
       "      <td>8.153846</td>\n",
       "      <td>Amy Tan</td>\n",
       "      <td>Prentice Hall (K-12)</td>\n",
       "      <td>http://images.amazon.com/images/P/0804106304.0...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14</th>\n",
       "      <td>Where the Heart Is (Oprah's Book Club (Paperba...</td>\n",
       "      <td>295</td>\n",
       "      <td>8.142373</td>\n",
       "      <td>Billie Letts</td>\n",
       "      <td>Warner Books</td>\n",
       "      <td>http://images.amazon.com/images/P/0446672211.0...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>Life of Pi</td>\n",
       "      <td>336</td>\n",
       "      <td>8.080357</td>\n",
       "      <td>Yann Martel</td>\n",
       "      <td>Harcourt</td>\n",
       "      <td>http://images.amazon.com/images/P/0151008116.0...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>28</th>\n",
       "      <td>Good in Bed</td>\n",
       "      <td>247</td>\n",
       "      <td>8.044534</td>\n",
       "      <td>Jennifer Weiner</td>\n",
       "      <td>Washington Square Press</td>\n",
       "      <td>http://images.amazon.com/images/P/0743418174.0...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>29</th>\n",
       "      <td>The Five People You Meet in Heaven</td>\n",
       "      <td>244</td>\n",
       "      <td>8.020492</td>\n",
       "      <td>Mitch Albom</td>\n",
       "      <td>Hyperion</td>\n",
       "      <td>http://images.amazon.com/images/P/0786868716.0...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>Angels &amp;amp; Demons</td>\n",
       "      <td>310</td>\n",
       "      <td>8.016129</td>\n",
       "      <td>Dan Brown</td>\n",
       "      <td>Pocket Star</td>\n",
       "      <td>http://images.amazon.com/images/P/0671027360.0...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>38</th>\n",
       "      <td>A Time to Kill</td>\n",
       "      <td>214</td>\n",
       "      <td>8.009346</td>\n",
       "      <td>JOHN GRISHAM</td>\n",
       "      <td>Dell</td>\n",
       "      <td>http://images.amazon.com/images/P/0440211727.0...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>Girl with a Pearl Earring</td>\n",
       "      <td>278</td>\n",
       "      <td>7.982014</td>\n",
       "      <td>Tracy Chevalier</td>\n",
       "      <td>Plume Books</td>\n",
       "      <td>http://images.amazon.com/images/P/0452282152.0...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15</th>\n",
       "      <td>The Notebook</td>\n",
       "      <td>293</td>\n",
       "      <td>7.897611</td>\n",
       "      <td>Nicholas Sparks</td>\n",
       "      <td>Warner Books</td>\n",
       "      <td>http://images.amazon.com/images/P/0446605239.0...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>41</th>\n",
       "      <td>Jurassic Park</td>\n",
       "      <td>212</td>\n",
       "      <td>7.891509</td>\n",
       "      <td>Michael Crichton</td>\n",
       "      <td>Ballantine Books</td>\n",
       "      <td>http://images.amazon.com/images/P/0345370775.0...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10</th>\n",
       "      <td>Divine Secrets of the Ya-Ya Sisterhood: A Novel</td>\n",
       "      <td>323</td>\n",
       "      <td>7.876161</td>\n",
       "      <td>Rebecca Wells</td>\n",
       "      <td>Perennial</td>\n",
       "      <td>http://images.amazon.com/images/P/0060928336.0...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>22</th>\n",
       "      <td>Timeline</td>\n",
       "      <td>263</td>\n",
       "      <td>7.870722</td>\n",
       "      <td>MICHAEL CRICHTON</td>\n",
       "      <td>Ballantine Books</td>\n",
       "      <td>http://images.amazon.com/images/P/0345417623.0...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>36</th>\n",
       "      <td>Me Talk Pretty One Day</td>\n",
       "      <td>218</td>\n",
       "      <td>7.866972</td>\n",
       "      <td>David Sedaris</td>\n",
       "      <td>Back Bay Books</td>\n",
       "      <td>http://images.amazon.com/images/P/0316776963.0...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>18</th>\n",
       "      <td>Snow Falling on Cedars</td>\n",
       "      <td>275</td>\n",
       "      <td>7.829091</td>\n",
       "      <td>David Guterson</td>\n",
       "      <td>Harcourt</td>\n",
       "      <td>http://images.amazon.com/images/P/0151001006.0...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>34</th>\n",
       "      <td>The Firm</td>\n",
       "      <td>224</td>\n",
       "      <td>7.825893</td>\n",
       "      <td>John Grisham</td>\n",
       "      <td>Doubleday Books</td>\n",
       "      <td>http://images.amazon.com/images/P/0385416342.0...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>32</th>\n",
       "      <td>Interview with the Vampire</td>\n",
       "      <td>232</td>\n",
       "      <td>7.775862</td>\n",
       "      <td>Anne Rice</td>\n",
       "      <td>Ballantine Books</td>\n",
       "      <td>http://images.amazon.com/images/P/0345337662.0...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>31</th>\n",
       "      <td>1st to Die: A Novel</td>\n",
       "      <td>236</td>\n",
       "      <td>7.711864</td>\n",
       "      <td>James Patterson</td>\n",
       "      <td>Warner Vision</td>\n",
       "      <td>http://images.amazon.com/images/P/0446610038.0...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>21</th>\n",
       "      <td>The Catcher in the Rye</td>\n",
       "      <td>265</td>\n",
       "      <td>7.701887</td>\n",
       "      <td>J.D. Salinger</td>\n",
       "      <td>Little, Brown</td>\n",
       "      <td>http://images.amazon.com/images/P/0316769487.0...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>37</th>\n",
       "      <td>She's Come Undone (Oprah's Book Club)</td>\n",
       "      <td>217</td>\n",
       "      <td>7.700461</td>\n",
       "      <td>Wally Lamb</td>\n",
       "      <td>Pocket</td>\n",
       "      <td>http://images.amazon.com/images/P/0671021001.0...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>48</th>\n",
       "      <td>The Partner</td>\n",
       "      <td>205</td>\n",
       "      <td>7.673171</td>\n",
       "      <td>John Grisham</td>\n",
       "      <td>Doubleday Books</td>\n",
       "      <td>http://images.amazon.com/images/P/0385472951.0...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>33</th>\n",
       "      <td>Suzanne's Diary for Nicholas</td>\n",
       "      <td>228</td>\n",
       "      <td>7.657895</td>\n",
       "      <td>James Patterson</td>\n",
       "      <td>Little, Brown</td>\n",
       "      <td>http://images.amazon.com/images/P/0316969443.0...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>Bridget Jones's Diary</td>\n",
       "      <td>377</td>\n",
       "      <td>7.625995</td>\n",
       "      <td>Helen Fielding</td>\n",
       "      <td>Picador (UK)</td>\n",
       "      <td>http://images.amazon.com/images/P/0330332775.0...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>46</th>\n",
       "      <td>The Street Lawyer</td>\n",
       "      <td>206</td>\n",
       "      <td>7.543689</td>\n",
       "      <td>JOHN GRISHAM</td>\n",
       "      <td>Dell</td>\n",
       "      <td>http://images.amazon.com/images/P/0440225701.0...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>44</th>\n",
       "      <td>She's Come Undone (Oprah's Book Club (Paperback))</td>\n",
       "      <td>207</td>\n",
       "      <td>7.531401</td>\n",
       "      <td>Wally Lamb</td>\n",
       "      <td>Washington Square Press</td>\n",
       "      <td>http://images.amazon.com/images/P/0671003755.0...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>23</th>\n",
       "      <td>The Testament</td>\n",
       "      <td>261</td>\n",
       "      <td>7.517241</td>\n",
       "      <td>John Grisham</td>\n",
       "      <td>Dell</td>\n",
       "      <td>http://images.amazon.com/images/P/0440234743.0...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19</th>\n",
       "      <td>The Pilot's Wife : A Novel</td>\n",
       "      <td>272</td>\n",
       "      <td>7.503676</td>\n",
       "      <td>Anita Shreve</td>\n",
       "      <td>Back Bay Books</td>\n",
       "      <td>http://images.amazon.com/images/P/0316601950.0...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>25</th>\n",
       "      <td>Summer Sisters</td>\n",
       "      <td>257</td>\n",
       "      <td>7.494163</td>\n",
       "      <td>Judy Blume</td>\n",
       "      <td>Delacorte Press</td>\n",
       "      <td>http://images.amazon.com/images/P/0385324057.0...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>40</th>\n",
       "      <td>The Brethren</td>\n",
       "      <td>213</td>\n",
       "      <td>7.441315</td>\n",
       "      <td>JOHN GRISHAM</td>\n",
       "      <td>Doubleday</td>\n",
       "      <td>http://images.amazon.com/images/P/0385497466.0...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>The Nanny Diaries: A Novel</td>\n",
       "      <td>393</td>\n",
       "      <td>7.437659</td>\n",
       "      <td>Emma McLaughlin</td>\n",
       "      <td>St. Martin's Press</td>\n",
       "      <td>http://images.amazon.com/images/P/0312278586.0...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>45</th>\n",
       "      <td>The Chamber</td>\n",
       "      <td>207</td>\n",
       "      <td>7.415459</td>\n",
       "      <td>John Grisham</td>\n",
       "      <td>Doubleday Books</td>\n",
       "      <td>http://images.amazon.com/images/P/0385424728.0...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>A Painted House</td>\n",
       "      <td>366</td>\n",
       "      <td>7.398907</td>\n",
       "      <td>John Grisham</td>\n",
       "      <td>Dell Publishing Company</td>\n",
       "      <td>http://images.amazon.com/images/P/044023722X.0...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>30</th>\n",
       "      <td>House of Sand and Fog</td>\n",
       "      <td>242</td>\n",
       "      <td>7.363636</td>\n",
       "      <td>Andre Dubus III</td>\n",
       "      <td>Vintage Books</td>\n",
       "      <td>http://images.amazon.com/images/P/0375727345.0...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13</th>\n",
       "      <td>The Summons</td>\n",
       "      <td>309</td>\n",
       "      <td>7.275081</td>\n",
       "      <td>John Grisham</td>\n",
       "      <td>Dell Publishing Company</td>\n",
       "      <td>http://images.amazon.com/images/P/0440241073.0...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>39</th>\n",
       "      <td>Dreamcatcher</td>\n",
       "      <td>214</td>\n",
       "      <td>7.219626</td>\n",
       "      <td>Stephen King</td>\n",
       "      <td>Scribner</td>\n",
       "      <td>http://images.amazon.com/images/P/0743211383.0...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>24</th>\n",
       "      <td>The Girls' Guide to Hunting and Fishing</td>\n",
       "      <td>259</td>\n",
       "      <td>6.945946</td>\n",
       "      <td>Melissa Bank</td>\n",
       "      <td>Penguin Books</td>\n",
       "      <td>http://images.amazon.com/images/P/0140293248.0...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>Wild Animus</td>\n",
       "      <td>581</td>\n",
       "      <td>4.390706</td>\n",
       "      <td>Rich Shapero</td>\n",
       "      <td>Too Far</td>\n",
       "      <td>http://images.amazon.com/images/P/0971880107.0...</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                                           Book-Title  num_ratings  \\\n",
       "27       Harry Potter and the Goblet of Fire (Book 4)          247   \n",
       "42  Harry Potter and the Order of the Phoenix (Boo...          211   \n",
       "17  Harry Potter and the Prisoner of Azkaban (Book 3)          277   \n",
       "20                              To Kill a Mockingbird          267   \n",
       "11  Harry Potter and the Sorcerer's Stone (Harry P...          315   \n",
       "47  The Fellowship of the Ring (The Lord of the Ri...          205   \n",
       "9    Harry Potter and the Chamber of Secrets (Book 2)          326   \n",
       "26  Tuesdays with Morrie: An Old Man, a Young Man,...          250   \n",
       "49                                     Fahrenheit 451          204   \n",
       "3                             The Secret Life of Bees          406   \n",
       "2                                   The Da Vinci Code          494   \n",
       "0                           The Lovely Bones: A Novel          707   \n",
       "5                 The Red Tent (Bestselling Backlist)          383   \n",
       "35                      The Poisonwood Bible: A Novel          218   \n",
       "43                                  The Joy Luck Club          208   \n",
       "14  Where the Heart Is (Oprah's Book Club (Paperba...          295   \n",
       "8                                          Life of Pi          336   \n",
       "28                                        Good in Bed          247   \n",
       "29                 The Five People You Meet in Heaven          244   \n",
       "12                                Angels &amp; Demons          310   \n",
       "38                                     A Time to Kill          214   \n",
       "16                          Girl with a Pearl Earring          278   \n",
       "15                                       The Notebook          293   \n",
       "41                                      Jurassic Park          212   \n",
       "10    Divine Secrets of the Ya-Ya Sisterhood: A Novel          323   \n",
       "22                                           Timeline          263   \n",
       "36                             Me Talk Pretty One Day          218   \n",
       "18                             Snow Falling on Cedars          275   \n",
       "34                                           The Firm          224   \n",
       "32                         Interview with the Vampire          232   \n",
       "31                                1st to Die: A Novel          236   \n",
       "21                             The Catcher in the Rye          265   \n",
       "37              She's Come Undone (Oprah's Book Club)          217   \n",
       "48                                        The Partner          205   \n",
       "33                       Suzanne's Diary for Nicholas          228   \n",
       "6                               Bridget Jones's Diary          377   \n",
       "46                                  The Street Lawyer          206   \n",
       "44  She's Come Undone (Oprah's Book Club (Paperback))          207   \n",
       "23                                      The Testament          261   \n",
       "19                         The Pilot's Wife : A Novel          272   \n",
       "25                                     Summer Sisters          257   \n",
       "40                                       The Brethren          213   \n",
       "4                          The Nanny Diaries: A Novel          393   \n",
       "45                                        The Chamber          207   \n",
       "7                                     A Painted House          366   \n",
       "30                              House of Sand and Fog          242   \n",
       "13                                        The Summons          309   \n",
       "39                                       Dreamcatcher          214   \n",
       "24            The Girls' Guide to Hunting and Fishing          259   \n",
       "1                                         Wild Animus          581   \n",
       "\n",
       "    avg_rating         Book-Author                   Publisher  \\\n",
       "27    9.125506       J. K. Rowling                  Scholastic   \n",
       "42    9.047393       J. K. Rowling                  Scholastic   \n",
       "17    9.043321       J. K. Rowling                  Scholastic   \n",
       "20    8.977528          Harper Lee  Little Brown &amp; Company   \n",
       "11    8.936508       J. K. Rowling      Arthur A. Levine Books   \n",
       "47    8.882927      J.R.R. TOLKIEN                     Del Rey   \n",
       "9     8.840491       J. K. Rowling                  Scholastic   \n",
       "26    8.588000         MITCH ALBOM                   Doubleday   \n",
       "49    8.549020        Ray Bradbury             Distribooks Inc   \n",
       "3     8.477833       Sue Monk Kidd               Penguin Books   \n",
       "2     8.439271           Dan Brown                   Doubleday   \n",
       "0     8.185290        Alice Sebold               Little, Brown   \n",
       "5     8.182768       Anita Diamant                 Picador USA   \n",
       "35    8.178899  Barbara Kingsolver                   Perennial   \n",
       "43    8.153846             Amy Tan        Prentice Hall (K-12)   \n",
       "14    8.142373        Billie Letts                Warner Books   \n",
       "8     8.080357         Yann Martel                    Harcourt   \n",
       "28    8.044534     Jennifer Weiner     Washington Square Press   \n",
       "29    8.020492         Mitch Albom                    Hyperion   \n",
       "12    8.016129           Dan Brown                 Pocket Star   \n",
       "38    8.009346        JOHN GRISHAM                        Dell   \n",
       "16    7.982014     Tracy Chevalier                 Plume Books   \n",
       "15    7.897611     Nicholas Sparks                Warner Books   \n",
       "41    7.891509    Michael Crichton            Ballantine Books   \n",
       "10    7.876161       Rebecca Wells                   Perennial   \n",
       "22    7.870722    MICHAEL CRICHTON            Ballantine Books   \n",
       "36    7.866972       David Sedaris              Back Bay Books   \n",
       "18    7.829091      David Guterson                    Harcourt   \n",
       "34    7.825893        John Grisham             Doubleday Books   \n",
       "32    7.775862           Anne Rice            Ballantine Books   \n",
       "31    7.711864     James Patterson               Warner Vision   \n",
       "21    7.701887       J.D. Salinger               Little, Brown   \n",
       "37    7.700461          Wally Lamb                      Pocket   \n",
       "48    7.673171        John Grisham             Doubleday Books   \n",
       "33    7.657895     James Patterson               Little, Brown   \n",
       "6     7.625995      Helen Fielding                Picador (UK)   \n",
       "46    7.543689        JOHN GRISHAM                        Dell   \n",
       "44    7.531401          Wally Lamb     Washington Square Press   \n",
       "23    7.517241        John Grisham                        Dell   \n",
       "19    7.503676        Anita Shreve              Back Bay Books   \n",
       "25    7.494163          Judy Blume             Delacorte Press   \n",
       "40    7.441315        JOHN GRISHAM                   Doubleday   \n",
       "4     7.437659     Emma McLaughlin          St. Martin's Press   \n",
       "45    7.415459        John Grisham             Doubleday Books   \n",
       "7     7.398907        John Grisham     Dell Publishing Company   \n",
       "30    7.363636     Andre Dubus III               Vintage Books   \n",
       "13    7.275081        John Grisham     Dell Publishing Company   \n",
       "39    7.219626        Stephen King                    Scribner   \n",
       "24    6.945946        Melissa Bank               Penguin Books   \n",
       "1     4.390706        Rich Shapero                     Too Far   \n",
       "\n",
       "                                                 link  \n",
       "27  http://images.amazon.com/images/P/0439139597.0...  \n",
       "42  http://images.amazon.com/images/P/043935806X.0...  \n",
       "17  http://images.amazon.com/images/P/0439136350.0...  \n",
       "20  http://images.amazon.com/images/P/0446310786.0...  \n",
       "11  http://images.amazon.com/images/P/059035342X.0...  \n",
       "47  http://images.amazon.com/images/P/0345339703.0...  \n",
       "9   http://images.amazon.com/images/P/0439064872.0...  \n",
       "26  http://images.amazon.com/images/P/0385484518.0...  \n",
       "49  http://images.amazon.com/images/P/3257208626.0...  \n",
       "3   http://images.amazon.com/images/P/0142001740.0...  \n",
       "2   http://images.amazon.com/images/P/0385504209.0...  \n",
       "0   http://images.amazon.com/images/P/0316666343.0...  \n",
       "5   http://images.amazon.com/images/P/0312195516.0...  \n",
       "35  http://images.amazon.com/images/P/0060930535.0...  \n",
       "43  http://images.amazon.com/images/P/0804106304.0...  \n",
       "14  http://images.amazon.com/images/P/0446672211.0...  \n",
       "8   http://images.amazon.com/images/P/0151008116.0...  \n",
       "28  http://images.amazon.com/images/P/0743418174.0...  \n",
       "29  http://images.amazon.com/images/P/0786868716.0...  \n",
       "12  http://images.amazon.com/images/P/0671027360.0...  \n",
       "38  http://images.amazon.com/images/P/0440211727.0...  \n",
       "16  http://images.amazon.com/images/P/0452282152.0...  \n",
       "15  http://images.amazon.com/images/P/0446605239.0...  \n",
       "41  http://images.amazon.com/images/P/0345370775.0...  \n",
       "10  http://images.amazon.com/images/P/0060928336.0...  \n",
       "22  http://images.amazon.com/images/P/0345417623.0...  \n",
       "36  http://images.amazon.com/images/P/0316776963.0...  \n",
       "18  http://images.amazon.com/images/P/0151001006.0...  \n",
       "34  http://images.amazon.com/images/P/0385416342.0...  \n",
       "32  http://images.amazon.com/images/P/0345337662.0...  \n",
       "31  http://images.amazon.com/images/P/0446610038.0...  \n",
       "21  http://images.amazon.com/images/P/0316769487.0...  \n",
       "37  http://images.amazon.com/images/P/0671021001.0...  \n",
       "48  http://images.amazon.com/images/P/0385472951.0...  \n",
       "33  http://images.amazon.com/images/P/0316969443.0...  \n",
       "6   http://images.amazon.com/images/P/0330332775.0...  \n",
       "46  http://images.amazon.com/images/P/0440225701.0...  \n",
       "44  http://images.amazon.com/images/P/0671003755.0...  \n",
       "23  http://images.amazon.com/images/P/0440234743.0...  \n",
       "19  http://images.amazon.com/images/P/0316601950.0...  \n",
       "25  http://images.amazon.com/images/P/0385324057.0...  \n",
       "40  http://images.amazon.com/images/P/0385497466.0...  \n",
       "4   http://images.amazon.com/images/P/0312278586.0...  \n",
       "45  http://images.amazon.com/images/P/0385424728.0...  \n",
       "7   http://images.amazon.com/images/P/044023722X.0...  \n",
       "30  http://images.amazon.com/images/P/0375727345.0...  \n",
       "13  http://images.amazon.com/images/P/0440241073.0...  \n",
       "39  http://images.amazon.com/images/P/0743211383.0...  \n",
       "24  http://images.amazon.com/images/P/0140293248.0...  \n",
       "1   http://images.amazon.com/images/P/0971880107.0...  "
      ]
     },
     "execution_count": 29,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# recommended books along with its details\n",
    "popular_books_df = get_book_data(popular_books)\n",
    "popular_books_df = popular_books_df.sort_values(by=\"avg_rating\", ascending=False)\n",
    "popular_books_df"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "52ae0121",
   "metadata": {
    "papermill": {
     "duration": 0.030565,
     "end_time": "2023-05-31T08:53:39.610809",
     "exception": false,
     "start_time": "2023-05-31T08:53:39.580244",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "### Top 10 Popular Authors Based on Ratings"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 30,
   "id": "c7e4911e",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2023-05-31T08:53:39.672917Z",
     "iopub.status.busy": "2023-05-31T08:53:39.672495Z",
     "iopub.status.idle": "2023-05-31T08:53:39.974091Z",
     "shell.execute_reply": "2023-05-31T08:53:39.973142Z"
    },
    "papermill": {
     "duration": 0.335476,
     "end_time": "2023-05-31T08:53:39.976555",
     "exception": false,
     "start_time": "2023-05-31T08:53:39.641079",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>num_ratings</th>\n",
       "      <th>avg_rating</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Book-Author</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>J. K. Rowling</th>\n",
       "      <td>1746</td>\n",
       "      <td>8.970218</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Janet Evanovich</th>\n",
       "      <td>1490</td>\n",
       "      <td>7.944966</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Stephen King</th>\n",
       "      <td>4639</td>\n",
       "      <td>7.815046</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Sue Grafton</th>\n",
       "      <td>1235</td>\n",
       "      <td>7.722267</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>James Patterson</th>\n",
       "      <td>2387</td>\n",
       "      <td>7.697947</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Nora Roberts</th>\n",
       "      <td>2938</td>\n",
       "      <td>7.629680</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Dean R. Koontz</th>\n",
       "      <td>1475</td>\n",
       "      <td>7.572203</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>John Grisham</th>\n",
       "      <td>2550</td>\n",
       "      <td>7.523137</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Mary Higgins Clark</th>\n",
       "      <td>1677</td>\n",
       "      <td>7.503280</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Anne Rice</th>\n",
       "      <td>1245</td>\n",
       "      <td>7.387952</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                    num_ratings  avg_rating\n",
       "Book-Author                                \n",
       "J. K. Rowling              1746    8.970218\n",
       "Janet Evanovich            1490    7.944966\n",
       "Stephen King               4639    7.815046\n",
       "Sue Grafton                1235    7.722267\n",
       "James Patterson            2387    7.697947\n",
       "Nora Roberts               2938    7.629680\n",
       "Dean R. Koontz             1475    7.572203\n",
       "John Grisham               2550    7.523137\n",
       "Mary Higgins Clark         1677    7.503280\n",
       "Anne Rice                  1245    7.387952"
      ]
     },
     "execution_count": 30,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "popular_authors = popularity(var=\"Book-Author\", top=10)\n",
    "popular_authors"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "7065f296",
   "metadata": {
    "papermill": {
     "duration": 0.029738,
     "end_time": "2023-05-31T08:53:40.036209",
     "exception": false,
     "start_time": "2023-05-31T08:53:40.006471",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "### Top 10 Popular Publishers Based on Ratings"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 31,
   "id": "480656a1",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2023-05-31T08:53:40.097325Z",
     "iopub.status.busy": "2023-05-31T08:53:40.096912Z",
     "iopub.status.idle": "2023-05-31T08:53:40.271548Z",
     "shell.execute_reply": "2023-05-31T08:53:40.270447Z"
    },
    "papermill": {
     "duration": 0.207937,
     "end_time": "2023-05-31T08:53:40.273960",
     "exception": false,
     "start_time": "2023-05-31T08:53:40.066023",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>num_ratings</th>\n",
       "      <th>avg_rating</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Publisher</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>Perennial</th>\n",
       "      <td>5775</td>\n",
       "      <td>7.814545</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Bantam</th>\n",
       "      <td>7383</td>\n",
       "      <td>7.796831</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Penguin Books</th>\n",
       "      <td>7020</td>\n",
       "      <td>7.773789</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Avon</th>\n",
       "      <td>5565</td>\n",
       "      <td>7.631447</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Ballantine Books</th>\n",
       "      <td>12781</td>\n",
       "      <td>7.610437</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Signet Book</th>\n",
       "      <td>6775</td>\n",
       "      <td>7.591292</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Pocket</th>\n",
       "      <td>10567</td>\n",
       "      <td>7.564115</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Warner Books</th>\n",
       "      <td>9032</td>\n",
       "      <td>7.543623</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Bantam Books</th>\n",
       "      <td>7304</td>\n",
       "      <td>7.520811</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Berkley Publishing Group</th>\n",
       "      <td>9321</td>\n",
       "      <td>7.443836</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                          num_ratings  avg_rating\n",
       "Publisher                                        \n",
       "Perennial                        5775    7.814545\n",
       "Bantam                           7383    7.796831\n",
       "Penguin Books                    7020    7.773789\n",
       "Avon                             5565    7.631447\n",
       "Ballantine Books                12781    7.610437\n",
       "Signet Book                      6775    7.591292\n",
       "Pocket                          10567    7.564115\n",
       "Warner Books                     9032    7.543623\n",
       "Bantam Books                     7304    7.520811\n",
       "Berkley Publishing Group         9321    7.443836"
      ]
     },
     "execution_count": 31,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "popular_publishers = popularity(var=\"Publisher\", top=10)\n",
    "popular_publishers"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "c5fe36c1",
   "metadata": {
    "papermill": {
     "duration": 0.030379,
     "end_time": "2023-05-31T08:53:40.335166",
     "exception": false,
     "start_time": "2023-05-31T08:53:40.304787",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "<h2><div style=\"color:white;\n",
    "           display:fill;\n",
    "           border-radius:5px;\n",
    "           background-color:#FF5733  ;\n",
    "           font-size:300%;\n",
    "           font-family:Sans-serif;\n",
    "           letter-spacing:0.5px\">\n",
    "\n",
    "<p style=\"padding: 15px;\n",
    "              color:white;\n",
    "               text-align:center\">\n",
    "    <b>\n",
    "        User-based collaborative filtering<a class=\"anchor\" id=\"7\"></a>\n",
    "        </b>\n",
    "</p>\n",
    "</div></h2>"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "abf47db3",
   "metadata": {
    "papermill": {
     "duration": 0.029783,
     "end_time": "2023-05-31T08:53:40.395216",
     "exception": false,
     "start_time": "2023-05-31T08:53:40.365433",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "* This section focuses on delivering personalized recommendations by leveraging the similarities in users' preferences. The underlying assumption is that users who exhibited similar tastes or behaviors in the past are likely to share similar preferences in the future.\n",
    "\n",
    "* The process commences by creating a user-item matrix, where users are represented by rows, items by columns, and the matrix cells contain ratings or interactions between users and items. \n",
    "\n",
    "* This matrix serves as the foundation for identifying patterns and similarities in user-item interactions, enabling the generation of personalized recommendations. \n",
    "\n",
    "* To generate this matrix, we shall first start with merging the users and books_rating dataset."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 32,
   "id": "70e01e2a",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2023-05-31T08:53:40.458079Z",
     "iopub.status.busy": "2023-05-31T08:53:40.457341Z",
     "iopub.status.idle": "2023-05-31T08:53:41.774484Z",
     "shell.execute_reply": "2023-05-31T08:53:41.773392Z"
    },
    "papermill": {
     "duration": 1.351503,
     "end_time": "2023-05-31T08:53:41.777393",
     "exception": false,
     "start_time": "2023-05-31T08:53:40.425890",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "users_rating = pd.merge(books_rating, users, on=\"User-ID\", how=\"right\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 33,
   "id": "af100a7e",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2023-05-31T08:53:41.839581Z",
     "iopub.status.busy": "2023-05-31T08:53:41.838907Z",
     "iopub.status.idle": "2023-05-31T08:53:41.863481Z",
     "shell.execute_reply": "2023-05-31T08:53:41.862393Z"
    },
    "papermill": {
     "duration": 0.058369,
     "end_time": "2023-05-31T08:53:41.865880",
     "exception": false,
     "start_time": "2023-05-31T08:53:41.807511",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>ISBN</th>\n",
       "      <th>Book-Title</th>\n",
       "      <th>Book-Author</th>\n",
       "      <th>Year-Of-Publication</th>\n",
       "      <th>Publisher</th>\n",
       "      <th>Image-URL-S</th>\n",
       "      <th>Image-URL-M</th>\n",
       "      <th>Image-URL-L</th>\n",
       "      <th>User-ID</th>\n",
       "      <th>Book-Rating</th>\n",
       "      <th>Location</th>\n",
       "      <th>Age</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>1.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>nyc, new york, usa</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>0195153448</td>\n",
       "      <td>Classical Mythology</td>\n",
       "      <td>Mark P. O. Morford</td>\n",
       "      <td>2002.0</td>\n",
       "      <td>Oxford University Press</td>\n",
       "      <td>http://images.amazon.com/images/P/0195153448.0...</td>\n",
       "      <td>http://images.amazon.com/images/P/0195153448.0...</td>\n",
       "      <td>http://images.amazon.com/images/P/0195153448.0...</td>\n",
       "      <td>2.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>stockton, california, usa</td>\n",
       "      <td>18.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>3.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>moscow, yukon territory, russia</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>4.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>porto, v.n.gaia, portugal</td>\n",
       "      <td>17.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>5.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>farnborough, hants, united kingdom</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1217883</th>\n",
       "      <td>0425163393</td>\n",
       "      <td>Kat Scratch Fever (Kat Colorado Mysteries)</td>\n",
       "      <td>Karen Kijewski</td>\n",
       "      <td>1998.0</td>\n",
       "      <td>Berkley Publishing Group</td>\n",
       "      <td>http://images.amazon.com/images/P/0425163393.0...</td>\n",
       "      <td>http://images.amazon.com/images/P/0425163393.0...</td>\n",
       "      <td>http://images.amazon.com/images/P/0425163393.0...</td>\n",
       "      <td>278854.0</td>\n",
       "      <td>7.0</td>\n",
       "      <td>portland, oregon, usa</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1217884</th>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>278855.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>tacoma, washington, united kingdom</td>\n",
       "      <td>50.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1217885</th>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>278856.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>brampton, ontario, canada</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1217886</th>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>278857.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>knoxville, tennessee, usa</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1217887</th>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>278858.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>dublin, n/a, ireland</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>1217888 rows × 12 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "               ISBN                                  Book-Title  \\\n",
       "0               NaN                                         NaN   \n",
       "1        0195153448                         Classical Mythology   \n",
       "2               NaN                                         NaN   \n",
       "3               NaN                                         NaN   \n",
       "4               NaN                                         NaN   \n",
       "...             ...                                         ...   \n",
       "1217883  0425163393  Kat Scratch Fever (Kat Colorado Mysteries)   \n",
       "1217884         NaN                                         NaN   \n",
       "1217885         NaN                                         NaN   \n",
       "1217886         NaN                                         NaN   \n",
       "1217887         NaN                                         NaN   \n",
       "\n",
       "                Book-Author  Year-Of-Publication                 Publisher  \\\n",
       "0                       NaN                  NaN                       NaN   \n",
       "1        Mark P. O. Morford               2002.0   Oxford University Press   \n",
       "2                       NaN                  NaN                       NaN   \n",
       "3                       NaN                  NaN                       NaN   \n",
       "4                       NaN                  NaN                       NaN   \n",
       "...                     ...                  ...                       ...   \n",
       "1217883      Karen Kijewski               1998.0  Berkley Publishing Group   \n",
       "1217884                 NaN                  NaN                       NaN   \n",
       "1217885                 NaN                  NaN                       NaN   \n",
       "1217886                 NaN                  NaN                       NaN   \n",
       "1217887                 NaN                  NaN                       NaN   \n",
       "\n",
       "                                               Image-URL-S  \\\n",
       "0                                                      NaN   \n",
       "1        http://images.amazon.com/images/P/0195153448.0...   \n",
       "2                                                      NaN   \n",
       "3                                                      NaN   \n",
       "4                                                      NaN   \n",
       "...                                                    ...   \n",
       "1217883  http://images.amazon.com/images/P/0425163393.0...   \n",
       "1217884                                                NaN   \n",
       "1217885                                                NaN   \n",
       "1217886                                                NaN   \n",
       "1217887                                                NaN   \n",
       "\n",
       "                                               Image-URL-M  \\\n",
       "0                                                      NaN   \n",
       "1        http://images.amazon.com/images/P/0195153448.0...   \n",
       "2                                                      NaN   \n",
       "3                                                      NaN   \n",
       "4                                                      NaN   \n",
       "...                                                    ...   \n",
       "1217883  http://images.amazon.com/images/P/0425163393.0...   \n",
       "1217884                                                NaN   \n",
       "1217885                                                NaN   \n",
       "1217886                                                NaN   \n",
       "1217887                                                NaN   \n",
       "\n",
       "                                               Image-URL-L   User-ID  \\\n",
       "0                                                      NaN       1.0   \n",
       "1        http://images.amazon.com/images/P/0195153448.0...       2.0   \n",
       "2                                                      NaN       3.0   \n",
       "3                                                      NaN       4.0   \n",
       "4                                                      NaN       5.0   \n",
       "...                                                    ...       ...   \n",
       "1217883  http://images.amazon.com/images/P/0425163393.0...  278854.0   \n",
       "1217884                                                NaN  278855.0   \n",
       "1217885                                                NaN  278856.0   \n",
       "1217886                                                NaN  278857.0   \n",
       "1217887                                                NaN  278858.0   \n",
       "\n",
       "         Book-Rating                            Location   Age  \n",
       "0                NaN                  nyc, new york, usa   NaN  \n",
       "1                0.0           stockton, california, usa  18.0  \n",
       "2                NaN     moscow, yukon territory, russia   NaN  \n",
       "3                NaN           porto, v.n.gaia, portugal  17.0  \n",
       "4                NaN  farnborough, hants, united kingdom   NaN  \n",
       "...              ...                                 ...   ...  \n",
       "1217883          7.0               portland, oregon, usa   NaN  \n",
       "1217884          NaN  tacoma, washington, united kingdom  50.0  \n",
       "1217885          NaN           brampton, ontario, canada   NaN  \n",
       "1217886          NaN           knoxville, tennessee, usa   NaN  \n",
       "1217887          NaN                dublin, n/a, ireland   NaN  \n",
       "\n",
       "[1217888 rows x 12 columns]"
      ]
     },
     "execution_count": 33,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "users_rating"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "e91b5443",
   "metadata": {
    "papermill": {
     "duration": 0.030159,
     "end_time": "2023-05-31T08:53:41.926774",
     "exception": false,
     "start_time": "2023-05-31T08:53:41.896615",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "* In our recommendation engine, we will take into account that some users may not have rated any books or have rated only a few books. \n",
    "\n",
    "* Recommending books to other users based on the preferences of these inactive users may not be advisable. \n",
    "\n",
    "* Therefore, to ensure the reliability and relevance of our recommendations, we will only consider users who have rated more than 50 books. \n",
    "\n",
    "* By focusing on active users with a significant number of ratings, we aim to enhance the accuracy and effectiveness of our recommendation engine."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 34,
   "id": "527aaf2a",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2023-05-31T08:53:41.989910Z",
     "iopub.status.busy": "2023-05-31T08:53:41.989291Z",
     "iopub.status.idle": "2023-05-31T08:53:42.066742Z",
     "shell.execute_reply": "2023-05-31T08:53:42.065930Z"
    },
    "papermill": {
     "duration": 0.111409,
     "end_time": "2023-05-31T08:53:42.068948",
     "exception": false,
     "start_time": "2023-05-31T08:53:41.957539",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>ISBN</th>\n",
       "      <th>Book-Title</th>\n",
       "      <th>Book-Author</th>\n",
       "      <th>Year-Of-Publication</th>\n",
       "      <th>Publisher</th>\n",
       "      <th>Image-URL-S</th>\n",
       "      <th>Image-URL-M</th>\n",
       "      <th>Image-URL-L</th>\n",
       "      <th>User-ID</th>\n",
       "      <th>Book-Rating</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>0002005018</td>\n",
       "      <td>Clara Callan</td>\n",
       "      <td>Richard Bruce Wright</td>\n",
       "      <td>2001</td>\n",
       "      <td>HarperFlamingo Canada</td>\n",
       "      <td>http://images.amazon.com/images/P/0002005018.0...</td>\n",
       "      <td>http://images.amazon.com/images/P/0002005018.0...</td>\n",
       "      <td>http://images.amazon.com/images/P/0002005018.0...</td>\n",
       "      <td>11676.0</td>\n",
       "      <td>8.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>0002005018</td>\n",
       "      <td>Clara Callan</td>\n",
       "      <td>Richard Bruce Wright</td>\n",
       "      <td>2001</td>\n",
       "      <td>HarperFlamingo Canada</td>\n",
       "      <td>http://images.amazon.com/images/P/0002005018.0...</td>\n",
       "      <td>http://images.amazon.com/images/P/0002005018.0...</td>\n",
       "      <td>http://images.amazon.com/images/P/0002005018.0...</td>\n",
       "      <td>116866.0</td>\n",
       "      <td>9.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>21</th>\n",
       "      <td>0374157065</td>\n",
       "      <td>Flu: The Story of the Great Influenza Pandemic...</td>\n",
       "      <td>Gina Bari Kolata</td>\n",
       "      <td>1999</td>\n",
       "      <td>Farrar Straus Giroux</td>\n",
       "      <td>http://images.amazon.com/images/P/0374157065.0...</td>\n",
       "      <td>http://images.amazon.com/images/P/0374157065.0...</td>\n",
       "      <td>http://images.amazon.com/images/P/0374157065.0...</td>\n",
       "      <td>110912.0</td>\n",
       "      <td>10.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>26</th>\n",
       "      <td>0374157065</td>\n",
       "      <td>Flu: The Story of the Great Influenza Pandemic...</td>\n",
       "      <td>Gina Bari Kolata</td>\n",
       "      <td>1999</td>\n",
       "      <td>Farrar Straus Giroux</td>\n",
       "      <td>http://images.amazon.com/images/P/0374157065.0...</td>\n",
       "      <td>http://images.amazon.com/images/P/0374157065.0...</td>\n",
       "      <td>http://images.amazon.com/images/P/0374157065.0...</td>\n",
       "      <td>197659.0</td>\n",
       "      <td>9.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>31</th>\n",
       "      <td>0399135782</td>\n",
       "      <td>The Kitchen God's Wife</td>\n",
       "      <td>Amy Tan</td>\n",
       "      <td>1991</td>\n",
       "      <td>Putnam Pub Group</td>\n",
       "      <td>http://images.amazon.com/images/P/0399135782.0...</td>\n",
       "      <td>http://images.amazon.com/images/P/0399135782.0...</td>\n",
       "      <td>http://images.amazon.com/images/P/0399135782.0...</td>\n",
       "      <td>11676.0</td>\n",
       "      <td>9.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1032275</th>\n",
       "      <td>0553211994</td>\n",
       "      <td>The Jungle Books and Just So Stories</td>\n",
       "      <td>Kipling Rudyard</td>\n",
       "      <td>1986</td>\n",
       "      <td>Bantam Classics</td>\n",
       "      <td>http://images.amazon.com/images/P/0553211994.0...</td>\n",
       "      <td>http://images.amazon.com/images/P/0553211994.0...</td>\n",
       "      <td>http://images.amazon.com/images/P/0553211994.0...</td>\n",
       "      <td>269566.0</td>\n",
       "      <td>8.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1032282</th>\n",
       "      <td>0843101083</td>\n",
       "      <td>Off-The-Wall (Mad Libs, No. 6)</td>\n",
       "      <td>Roger Price</td>\n",
       "      <td>1970</td>\n",
       "      <td>Price Stern Sloan</td>\n",
       "      <td>http://images.amazon.com/images/P/0843101083.0...</td>\n",
       "      <td>http://images.amazon.com/images/P/0843101083.0...</td>\n",
       "      <td>http://images.amazon.com/images/P/0843101083.0...</td>\n",
       "      <td>269566.0</td>\n",
       "      <td>6.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1032289</th>\n",
       "      <td>0395611563</td>\n",
       "      <td>Walking With the Great Apes: Jane Goodall, Dia...</td>\n",
       "      <td>Sy Montgomery</td>\n",
       "      <td>1992</td>\n",
       "      <td>Mariner Books</td>\n",
       "      <td>http://images.amazon.com/images/P/0395611563.0...</td>\n",
       "      <td>http://images.amazon.com/images/P/0395611563.0...</td>\n",
       "      <td>http://images.amazon.com/images/P/0395611563.0...</td>\n",
       "      <td>270713.0</td>\n",
       "      <td>10.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1032306</th>\n",
       "      <td>0747204020</td>\n",
       "      <td>Illustrated Encyclopedia of Cacti</td>\n",
       "      <td>Glass Charles</td>\n",
       "      <td>1991</td>\n",
       "      <td>Headline</td>\n",
       "      <td>http://images.amazon.com/images/P/0747204020.0...</td>\n",
       "      <td>http://images.amazon.com/images/P/0747204020.0...</td>\n",
       "      <td>http://images.amazon.com/images/P/0747204020.0...</td>\n",
       "      <td>273718.0</td>\n",
       "      <td>10.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1032333</th>\n",
       "      <td>1845170423</td>\n",
       "      <td>Cocktail Classics</td>\n",
       "      <td>David Biggs</td>\n",
       "      <td>2004</td>\n",
       "      <td>Connaught</td>\n",
       "      <td>http://images.amazon.com/images/P/1845170423.0...</td>\n",
       "      <td>http://images.amazon.com/images/P/1845170423.0...</td>\n",
       "      <td>http://images.amazon.com/images/P/1845170423.0...</td>\n",
       "      <td>275970.0</td>\n",
       "      <td>7.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>151924 rows × 10 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "               ISBN                                         Book-Title  \\\n",
       "3        0002005018                                       Clara Callan   \n",
       "8        0002005018                                       Clara Callan   \n",
       "21       0374157065  Flu: The Story of the Great Influenza Pandemic...   \n",
       "26       0374157065  Flu: The Story of the Great Influenza Pandemic...   \n",
       "31       0399135782                             The Kitchen God's Wife   \n",
       "...             ...                                                ...   \n",
       "1032275  0553211994               The Jungle Books and Just So Stories   \n",
       "1032282  0843101083                     Off-The-Wall (Mad Libs, No. 6)   \n",
       "1032289  0395611563  Walking With the Great Apes: Jane Goodall, Dia...   \n",
       "1032306  0747204020                  Illustrated Encyclopedia of Cacti   \n",
       "1032333  1845170423                                  Cocktail Classics   \n",
       "\n",
       "                  Book-Author  Year-Of-Publication              Publisher  \\\n",
       "3        Richard Bruce Wright                 2001  HarperFlamingo Canada   \n",
       "8        Richard Bruce Wright                 2001  HarperFlamingo Canada   \n",
       "21           Gina Bari Kolata                 1999   Farrar Straus Giroux   \n",
       "26           Gina Bari Kolata                 1999   Farrar Straus Giroux   \n",
       "31                    Amy Tan                 1991       Putnam Pub Group   \n",
       "...                       ...                  ...                    ...   \n",
       "1032275       Kipling Rudyard                 1986        Bantam Classics   \n",
       "1032282           Roger Price                 1970      Price Stern Sloan   \n",
       "1032289         Sy Montgomery                 1992          Mariner Books   \n",
       "1032306         Glass Charles                 1991               Headline   \n",
       "1032333           David Biggs                 2004              Connaught   \n",
       "\n",
       "                                               Image-URL-S  \\\n",
       "3        http://images.amazon.com/images/P/0002005018.0...   \n",
       "8        http://images.amazon.com/images/P/0002005018.0...   \n",
       "21       http://images.amazon.com/images/P/0374157065.0...   \n",
       "26       http://images.amazon.com/images/P/0374157065.0...   \n",
       "31       http://images.amazon.com/images/P/0399135782.0...   \n",
       "...                                                    ...   \n",
       "1032275  http://images.amazon.com/images/P/0553211994.0...   \n",
       "1032282  http://images.amazon.com/images/P/0843101083.0...   \n",
       "1032289  http://images.amazon.com/images/P/0395611563.0...   \n",
       "1032306  http://images.amazon.com/images/P/0747204020.0...   \n",
       "1032333  http://images.amazon.com/images/P/1845170423.0...   \n",
       "\n",
       "                                               Image-URL-M  \\\n",
       "3        http://images.amazon.com/images/P/0002005018.0...   \n",
       "8        http://images.amazon.com/images/P/0002005018.0...   \n",
       "21       http://images.amazon.com/images/P/0374157065.0...   \n",
       "26       http://images.amazon.com/images/P/0374157065.0...   \n",
       "31       http://images.amazon.com/images/P/0399135782.0...   \n",
       "...                                                    ...   \n",
       "1032275  http://images.amazon.com/images/P/0553211994.0...   \n",
       "1032282  http://images.amazon.com/images/P/0843101083.0...   \n",
       "1032289  http://images.amazon.com/images/P/0395611563.0...   \n",
       "1032306  http://images.amazon.com/images/P/0747204020.0...   \n",
       "1032333  http://images.amazon.com/images/P/1845170423.0...   \n",
       "\n",
       "                                               Image-URL-L   User-ID  \\\n",
       "3        http://images.amazon.com/images/P/0002005018.0...   11676.0   \n",
       "8        http://images.amazon.com/images/P/0002005018.0...  116866.0   \n",
       "21       http://images.amazon.com/images/P/0374157065.0...  110912.0   \n",
       "26       http://images.amazon.com/images/P/0374157065.0...  197659.0   \n",
       "31       http://images.amazon.com/images/P/0399135782.0...   11676.0   \n",
       "...                                                    ...       ...   \n",
       "1032275  http://images.amazon.com/images/P/0553211994.0...  269566.0   \n",
       "1032282  http://images.amazon.com/images/P/0843101083.0...  269566.0   \n",
       "1032289  http://images.amazon.com/images/P/0395611563.0...  270713.0   \n",
       "1032306  http://images.amazon.com/images/P/0747204020.0...  273718.0   \n",
       "1032333  http://images.amazon.com/images/P/1845170423.0...  275970.0   \n",
       "\n",
       "         Book-Rating  \n",
       "3                8.0  \n",
       "8                9.0  \n",
       "21              10.0  \n",
       "26               9.0  \n",
       "31               9.0  \n",
       "...              ...  \n",
       "1032275          8.0  \n",
       "1032282          6.0  \n",
       "1032289         10.0  \n",
       "1032306         10.0  \n",
       "1032333          7.0  \n",
       "\n",
       "[151924 rows x 10 columns]"
      ]
     },
     "execution_count": 34,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "user_counts = popular[\"User-ID\"].value_counts()\n",
    "rating_df_books = popular[popular['User-ID'].isin(user_counts[user_counts > 50].index)]\n",
    "rating_df_books"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "919440dd",
   "metadata": {
    "papermill": {
     "duration": 0.030838,
     "end_time": "2023-05-31T08:53:42.130564",
     "exception": false,
     "start_time": "2023-05-31T08:53:42.099726",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "* Additionally, we acknowledge that certain books may not have received any ratings or have been rated very few times. \n",
    "\n",
    "* Recommending such unpopular books can potentially decrease the efficiency of our recommendation engine. \n",
    "\n",
    "* Therefore, we will only consider books that have received a minimum of 10 ratings. \n",
    "\n",
    "* By focusing on books with a reasonable level of user engagement, we aim to improve the effectiveness and relevance of our recommendations in order to provide a better user experience."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 35,
   "id": "18f35710",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2023-05-31T08:53:42.194373Z",
     "iopub.status.busy": "2023-05-31T08:53:42.193996Z",
     "iopub.status.idle": "2023-05-31T08:53:42.302473Z",
     "shell.execute_reply": "2023-05-31T08:53:42.301458Z"
    },
    "papermill": {
     "duration": 0.143164,
     "end_time": "2023-05-31T08:53:42.304751",
     "exception": false,
     "start_time": "2023-05-31T08:53:42.161587",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>ISBN</th>\n",
       "      <th>Book-Title</th>\n",
       "      <th>Book-Author</th>\n",
       "      <th>Year-Of-Publication</th>\n",
       "      <th>Publisher</th>\n",
       "      <th>Image-URL-S</th>\n",
       "      <th>Image-URL-M</th>\n",
       "      <th>Image-URL-L</th>\n",
       "      <th>User-ID</th>\n",
       "      <th>Book-Rating</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>31</th>\n",
       "      <td>0399135782</td>\n",
       "      <td>The Kitchen God's Wife</td>\n",
       "      <td>Amy Tan</td>\n",
       "      <td>1991</td>\n",
       "      <td>Putnam Pub Group</td>\n",
       "      <td>http://images.amazon.com/images/P/0399135782.0...</td>\n",
       "      <td>http://images.amazon.com/images/P/0399135782.0...</td>\n",
       "      <td>http://images.amazon.com/images/P/0399135782.0...</td>\n",
       "      <td>11676.0</td>\n",
       "      <td>9.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>32</th>\n",
       "      <td>0399135782</td>\n",
       "      <td>The Kitchen God's Wife</td>\n",
       "      <td>Amy Tan</td>\n",
       "      <td>1991</td>\n",
       "      <td>Putnam Pub Group</td>\n",
       "      <td>http://images.amazon.com/images/P/0399135782.0...</td>\n",
       "      <td>http://images.amazon.com/images/P/0399135782.0...</td>\n",
       "      <td>http://images.amazon.com/images/P/0399135782.0...</td>\n",
       "      <td>29526.0</td>\n",
       "      <td>9.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>34</th>\n",
       "      <td>0399135782</td>\n",
       "      <td>The Kitchen God's Wife</td>\n",
       "      <td>Amy Tan</td>\n",
       "      <td>1991</td>\n",
       "      <td>Putnam Pub Group</td>\n",
       "      <td>http://images.amazon.com/images/P/0399135782.0...</td>\n",
       "      <td>http://images.amazon.com/images/P/0399135782.0...</td>\n",
       "      <td>http://images.amazon.com/images/P/0399135782.0...</td>\n",
       "      <td>46398.0</td>\n",
       "      <td>9.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>54</th>\n",
       "      <td>0399135782</td>\n",
       "      <td>The Kitchen God's Wife</td>\n",
       "      <td>Amy Tan</td>\n",
       "      <td>1991</td>\n",
       "      <td>Putnam Pub Group</td>\n",
       "      <td>http://images.amazon.com/images/P/0399135782.0...</td>\n",
       "      <td>http://images.amazon.com/images/P/0399135782.0...</td>\n",
       "      <td>http://images.amazon.com/images/P/0399135782.0...</td>\n",
       "      <td>230522.0</td>\n",
       "      <td>7.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>58</th>\n",
       "      <td>0399135782</td>\n",
       "      <td>The Kitchen God's Wife</td>\n",
       "      <td>Amy Tan</td>\n",
       "      <td>1991</td>\n",
       "      <td>Putnam Pub Group</td>\n",
       "      <td>http://images.amazon.com/images/P/0399135782.0...</td>\n",
       "      <td>http://images.amazon.com/images/P/0399135782.0...</td>\n",
       "      <td>http://images.amazon.com/images/P/0399135782.0...</td>\n",
       "      <td>245827.0</td>\n",
       "      <td>9.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1029037</th>\n",
       "      <td>0380974509</td>\n",
       "      <td>The Promise</td>\n",
       "      <td>Donna Boyd</td>\n",
       "      <td>1999</td>\n",
       "      <td>Avon Books</td>\n",
       "      <td>http://images.amazon.com/images/P/0380974509.0...</td>\n",
       "      <td>http://images.amazon.com/images/P/0380974509.0...</td>\n",
       "      <td>http://images.amazon.com/images/P/0380974509.0...</td>\n",
       "      <td>243360.0</td>\n",
       "      <td>6.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1029724</th>\n",
       "      <td>0394429869</td>\n",
       "      <td>I Know Why the Caged Bird Sings</td>\n",
       "      <td>Maya Angelou</td>\n",
       "      <td>1996</td>\n",
       "      <td>Random House</td>\n",
       "      <td>http://images.amazon.com/images/P/0394429869.0...</td>\n",
       "      <td>http://images.amazon.com/images/P/0394429869.0...</td>\n",
       "      <td>http://images.amazon.com/images/P/0394429869.0...</td>\n",
       "      <td>239594.0</td>\n",
       "      <td>8.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1029726</th>\n",
       "      <td>0449001164</td>\n",
       "      <td>The Promise</td>\n",
       "      <td>CHAIM POTOK</td>\n",
       "      <td>1997</td>\n",
       "      <td>Ballantine Books</td>\n",
       "      <td>http://images.amazon.com/images/P/0449001164.0...</td>\n",
       "      <td>http://images.amazon.com/images/P/0449001164.0...</td>\n",
       "      <td>http://images.amazon.com/images/P/0449001164.0...</td>\n",
       "      <td>239594.0</td>\n",
       "      <td>7.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1031638</th>\n",
       "      <td>0553290703</td>\n",
       "      <td>Lightning</td>\n",
       "      <td>Patricia Potter</td>\n",
       "      <td>1992</td>\n",
       "      <td>Bantam Books</td>\n",
       "      <td>http://images.amazon.com/images/P/0553290703.0...</td>\n",
       "      <td>http://images.amazon.com/images/P/0553290703.0...</td>\n",
       "      <td>http://images.amazon.com/images/P/0553290703.0...</td>\n",
       "      <td>244685.0</td>\n",
       "      <td>9.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1032150</th>\n",
       "      <td>0395647398</td>\n",
       "      <td>The Two Towers (The Lord of the Rings, Part 2)</td>\n",
       "      <td>J. R. R. Tolkien</td>\n",
       "      <td>1992</td>\n",
       "      <td>Houghton Mifflin</td>\n",
       "      <td>http://images.amazon.com/images/P/0395647398.0...</td>\n",
       "      <td>http://images.amazon.com/images/P/0395647398.0...</td>\n",
       "      <td>http://images.amazon.com/images/P/0395647398.0...</td>\n",
       "      <td>259901.0</td>\n",
       "      <td>10.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>32276 rows × 10 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "               ISBN                                      Book-Title  \\\n",
       "31       0399135782                          The Kitchen God's Wife   \n",
       "32       0399135782                          The Kitchen God's Wife   \n",
       "34       0399135782                          The Kitchen God's Wife   \n",
       "54       0399135782                          The Kitchen God's Wife   \n",
       "58       0399135782                          The Kitchen God's Wife   \n",
       "...             ...                                             ...   \n",
       "1029037  0380974509                                     The Promise   \n",
       "1029724  0394429869                 I Know Why the Caged Bird Sings   \n",
       "1029726  0449001164                                     The Promise   \n",
       "1031638  0553290703                                       Lightning   \n",
       "1032150  0395647398  The Two Towers (The Lord of the Rings, Part 2)   \n",
       "\n",
       "              Book-Author  Year-Of-Publication         Publisher  \\\n",
       "31                Amy Tan                 1991  Putnam Pub Group   \n",
       "32                Amy Tan                 1991  Putnam Pub Group   \n",
       "34                Amy Tan                 1991  Putnam Pub Group   \n",
       "54                Amy Tan                 1991  Putnam Pub Group   \n",
       "58                Amy Tan                 1991  Putnam Pub Group   \n",
       "...                   ...                  ...               ...   \n",
       "1029037        Donna Boyd                 1999        Avon Books   \n",
       "1029724      Maya Angelou                 1996      Random House   \n",
       "1029726       CHAIM POTOK                 1997  Ballantine Books   \n",
       "1031638   Patricia Potter                 1992      Bantam Books   \n",
       "1032150  J. R. R. Tolkien                 1992  Houghton Mifflin   \n",
       "\n",
       "                                               Image-URL-S  \\\n",
       "31       http://images.amazon.com/images/P/0399135782.0...   \n",
       "32       http://images.amazon.com/images/P/0399135782.0...   \n",
       "34       http://images.amazon.com/images/P/0399135782.0...   \n",
       "54       http://images.amazon.com/images/P/0399135782.0...   \n",
       "58       http://images.amazon.com/images/P/0399135782.0...   \n",
       "...                                                    ...   \n",
       "1029037  http://images.amazon.com/images/P/0380974509.0...   \n",
       "1029724  http://images.amazon.com/images/P/0394429869.0...   \n",
       "1029726  http://images.amazon.com/images/P/0449001164.0...   \n",
       "1031638  http://images.amazon.com/images/P/0553290703.0...   \n",
       "1032150  http://images.amazon.com/images/P/0395647398.0...   \n",
       "\n",
       "                                               Image-URL-M  \\\n",
       "31       http://images.amazon.com/images/P/0399135782.0...   \n",
       "32       http://images.amazon.com/images/P/0399135782.0...   \n",
       "34       http://images.amazon.com/images/P/0399135782.0...   \n",
       "54       http://images.amazon.com/images/P/0399135782.0...   \n",
       "58       http://images.amazon.com/images/P/0399135782.0...   \n",
       "...                                                    ...   \n",
       "1029037  http://images.amazon.com/images/P/0380974509.0...   \n",
       "1029724  http://images.amazon.com/images/P/0394429869.0...   \n",
       "1029726  http://images.amazon.com/images/P/0449001164.0...   \n",
       "1031638  http://images.amazon.com/images/P/0553290703.0...   \n",
       "1032150  http://images.amazon.com/images/P/0395647398.0...   \n",
       "\n",
       "                                               Image-URL-L   User-ID  \\\n",
       "31       http://images.amazon.com/images/P/0399135782.0...   11676.0   \n",
       "32       http://images.amazon.com/images/P/0399135782.0...   29526.0   \n",
       "34       http://images.amazon.com/images/P/0399135782.0...   46398.0   \n",
       "54       http://images.amazon.com/images/P/0399135782.0...  230522.0   \n",
       "58       http://images.amazon.com/images/P/0399135782.0...  245827.0   \n",
       "...                                                    ...       ...   \n",
       "1029037  http://images.amazon.com/images/P/0380974509.0...  243360.0   \n",
       "1029724  http://images.amazon.com/images/P/0394429869.0...  239594.0   \n",
       "1029726  http://images.amazon.com/images/P/0449001164.0...  239594.0   \n",
       "1031638  http://images.amazon.com/images/P/0553290703.0...  244685.0   \n",
       "1032150  http://images.amazon.com/images/P/0395647398.0...  259901.0   \n",
       "\n",
       "         Book-Rating  \n",
       "31               9.0  \n",
       "32               9.0  \n",
       "34               9.0  \n",
       "54               7.0  \n",
       "58               9.0  \n",
       "...              ...  \n",
       "1029037          6.0  \n",
       "1029724          8.0  \n",
       "1029726          7.0  \n",
       "1031638          9.0  \n",
       "1032150         10.0  \n",
       "\n",
       "[32276 rows x 10 columns]"
      ]
     },
     "execution_count": 35,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "book_counts = rating_df_books[\"Book-Title\"].value_counts()\n",
    "rating_df_books = rating_df_books[rating_df_books['Book-Title'].isin(book_counts[book_counts >= 10].index)]\n",
    "rating_df_books"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "a0c7c4bc",
   "metadata": {
    "papermill": {
     "duration": 0.031405,
     "end_time": "2023-05-31T08:53:42.367451",
     "exception": false,
     "start_time": "2023-05-31T08:53:42.336046",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "* We have now removed all the inactive users and the unpopular books from the dataset. But wait, there might be a problem which needs to be highlighted.\n",
    "\n",
    "* Imagine a scenario: User - \"123\", an inactive user, suddenly feels the urge to discover new books. He visits our recommendation engine, expecting personalized recommendations based on his tastes. But wait! Since he is an inactive user, his information is not present in the dataset used to build the engine. This could potentially lead to errors or an incomplete experience for him.\n",
    "\n",
    "* To prevent this, we shall come up with a proactive approach. When that user enters our recommendation engine, we automatically add his information to the dataset. By doing so, we ensure that his preferences and interests are taken into account when generating recommendations.\n",
    "\n",
    "* With his information included, our engine springs into action. It identifies other users who share similar tastes, interests, and behaviors with the User - \"123\".\n",
    "\n",
    "* By dynamically incorporating user information as needed, our recommendation engine becomes more inclusive and reliable. It empowers both active and previously inactive users to embark on exciting literary journeys, discovering new books tailored to their preferences."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 36,
   "id": "96fffc43",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2023-05-31T08:53:42.432940Z",
     "iopub.status.busy": "2023-05-31T08:53:42.432241Z",
     "iopub.status.idle": "2023-05-31T08:53:42.436913Z",
     "shell.execute_reply": "2023-05-31T08:53:42.436155Z"
    },
    "papermill": {
     "duration": 0.039871,
     "end_time": "2023-05-31T08:53:42.439083",
     "exception": false,
     "start_time": "2023-05-31T08:53:42.399212",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "user_id = 123"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 37,
   "id": "048fadd1",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2023-05-31T08:53:42.504047Z",
     "iopub.status.busy": "2023-05-31T08:53:42.503688Z",
     "iopub.status.idle": "2023-05-31T08:53:43.089227Z",
     "shell.execute_reply": "2023-05-31T08:53:43.088206Z"
    },
    "papermill": {
     "duration": 0.621127,
     "end_time": "2023-05-31T08:53:43.091892",
     "exception": false,
     "start_time": "2023-05-31T08:53:42.470765",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "if user_id not in rating_df_books['User-ID']:\n",
    "    new = users_rating[(users_rating['User-ID'] == user_id)]\n",
    "    new[\"Book-Rating\"].fillna(0, inplace=True)\n",
    "    new[\"Book-Title\"].fillna(\"Unknown\", inplace=True)\n",
    "    # Replace zeros with NA\n",
    "    df1 = pd.concat([rating_df_books, new], ignore_index=True)\n",
    "else:\n",
    "    df1 = rating_df_books.copy()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 38,
   "id": "f62caeb2",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2023-05-31T08:53:43.157151Z",
     "iopub.status.busy": "2023-05-31T08:53:43.156765Z",
     "iopub.status.idle": "2023-05-31T08:53:43.182995Z",
     "shell.execute_reply": "2023-05-31T08:53:43.181967Z"
    },
    "papermill": {
     "duration": 0.061991,
     "end_time": "2023-05-31T08:53:43.185484",
     "exception": false,
     "start_time": "2023-05-31T08:53:43.123493",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>ISBN</th>\n",
       "      <th>Book-Title</th>\n",
       "      <th>Book-Author</th>\n",
       "      <th>Year-Of-Publication</th>\n",
       "      <th>Publisher</th>\n",
       "      <th>Image-URL-S</th>\n",
       "      <th>Image-URL-M</th>\n",
       "      <th>Image-URL-L</th>\n",
       "      <th>User-ID</th>\n",
       "      <th>Book-Rating</th>\n",
       "      <th>Location</th>\n",
       "      <th>Age</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>0399135782</td>\n",
       "      <td>The Kitchen God's Wife</td>\n",
       "      <td>Amy Tan</td>\n",
       "      <td>1991.0</td>\n",
       "      <td>Putnam Pub Group</td>\n",
       "      <td>http://images.amazon.com/images/P/0399135782.0...</td>\n",
       "      <td>http://images.amazon.com/images/P/0399135782.0...</td>\n",
       "      <td>http://images.amazon.com/images/P/0399135782.0...</td>\n",
       "      <td>11676.0</td>\n",
       "      <td>9.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>0399135782</td>\n",
       "      <td>The Kitchen God's Wife</td>\n",
       "      <td>Amy Tan</td>\n",
       "      <td>1991.0</td>\n",
       "      <td>Putnam Pub Group</td>\n",
       "      <td>http://images.amazon.com/images/P/0399135782.0...</td>\n",
       "      <td>http://images.amazon.com/images/P/0399135782.0...</td>\n",
       "      <td>http://images.amazon.com/images/P/0399135782.0...</td>\n",
       "      <td>29526.0</td>\n",
       "      <td>9.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>0399135782</td>\n",
       "      <td>The Kitchen God's Wife</td>\n",
       "      <td>Amy Tan</td>\n",
       "      <td>1991.0</td>\n",
       "      <td>Putnam Pub Group</td>\n",
       "      <td>http://images.amazon.com/images/P/0399135782.0...</td>\n",
       "      <td>http://images.amazon.com/images/P/0399135782.0...</td>\n",
       "      <td>http://images.amazon.com/images/P/0399135782.0...</td>\n",
       "      <td>46398.0</td>\n",
       "      <td>9.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>0399135782</td>\n",
       "      <td>The Kitchen God's Wife</td>\n",
       "      <td>Amy Tan</td>\n",
       "      <td>1991.0</td>\n",
       "      <td>Putnam Pub Group</td>\n",
       "      <td>http://images.amazon.com/images/P/0399135782.0...</td>\n",
       "      <td>http://images.amazon.com/images/P/0399135782.0...</td>\n",
       "      <td>http://images.amazon.com/images/P/0399135782.0...</td>\n",
       "      <td>230522.0</td>\n",
       "      <td>7.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>0399135782</td>\n",
       "      <td>The Kitchen God's Wife</td>\n",
       "      <td>Amy Tan</td>\n",
       "      <td>1991.0</td>\n",
       "      <td>Putnam Pub Group</td>\n",
       "      <td>http://images.amazon.com/images/P/0399135782.0...</td>\n",
       "      <td>http://images.amazon.com/images/P/0399135782.0...</td>\n",
       "      <td>http://images.amazon.com/images/P/0399135782.0...</td>\n",
       "      <td>245827.0</td>\n",
       "      <td>9.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>32272</th>\n",
       "      <td>0394429869</td>\n",
       "      <td>I Know Why the Caged Bird Sings</td>\n",
       "      <td>Maya Angelou</td>\n",
       "      <td>1996.0</td>\n",
       "      <td>Random House</td>\n",
       "      <td>http://images.amazon.com/images/P/0394429869.0...</td>\n",
       "      <td>http://images.amazon.com/images/P/0394429869.0...</td>\n",
       "      <td>http://images.amazon.com/images/P/0394429869.0...</td>\n",
       "      <td>239594.0</td>\n",
       "      <td>8.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>32273</th>\n",
       "      <td>0449001164</td>\n",
       "      <td>The Promise</td>\n",
       "      <td>CHAIM POTOK</td>\n",
       "      <td>1997.0</td>\n",
       "      <td>Ballantine Books</td>\n",
       "      <td>http://images.amazon.com/images/P/0449001164.0...</td>\n",
       "      <td>http://images.amazon.com/images/P/0449001164.0...</td>\n",
       "      <td>http://images.amazon.com/images/P/0449001164.0...</td>\n",
       "      <td>239594.0</td>\n",
       "      <td>7.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>32274</th>\n",
       "      <td>0553290703</td>\n",
       "      <td>Lightning</td>\n",
       "      <td>Patricia Potter</td>\n",
       "      <td>1992.0</td>\n",
       "      <td>Bantam Books</td>\n",
       "      <td>http://images.amazon.com/images/P/0553290703.0...</td>\n",
       "      <td>http://images.amazon.com/images/P/0553290703.0...</td>\n",
       "      <td>http://images.amazon.com/images/P/0553290703.0...</td>\n",
       "      <td>244685.0</td>\n",
       "      <td>9.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>32275</th>\n",
       "      <td>0395647398</td>\n",
       "      <td>The Two Towers (The Lord of the Rings, Part 2)</td>\n",
       "      <td>J. R. R. Tolkien</td>\n",
       "      <td>1992.0</td>\n",
       "      <td>Houghton Mifflin</td>\n",
       "      <td>http://images.amazon.com/images/P/0395647398.0...</td>\n",
       "      <td>http://images.amazon.com/images/P/0395647398.0...</td>\n",
       "      <td>http://images.amazon.com/images/P/0395647398.0...</td>\n",
       "      <td>259901.0</td>\n",
       "      <td>10.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>32276</th>\n",
       "      <td>NaN</td>\n",
       "      <td>Unknown</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>123.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>ann arbor, michigan, usa</td>\n",
       "      <td>24.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>32277 rows × 12 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "             ISBN                                      Book-Title  \\\n",
       "0      0399135782                          The Kitchen God's Wife   \n",
       "1      0399135782                          The Kitchen God's Wife   \n",
       "2      0399135782                          The Kitchen God's Wife   \n",
       "3      0399135782                          The Kitchen God's Wife   \n",
       "4      0399135782                          The Kitchen God's Wife   \n",
       "...           ...                                             ...   \n",
       "32272  0394429869                 I Know Why the Caged Bird Sings   \n",
       "32273  0449001164                                     The Promise   \n",
       "32274  0553290703                                       Lightning   \n",
       "32275  0395647398  The Two Towers (The Lord of the Rings, Part 2)   \n",
       "32276         NaN                                         Unknown   \n",
       "\n",
       "            Book-Author  Year-Of-Publication         Publisher  \\\n",
       "0               Amy Tan               1991.0  Putnam Pub Group   \n",
       "1               Amy Tan               1991.0  Putnam Pub Group   \n",
       "2               Amy Tan               1991.0  Putnam Pub Group   \n",
       "3               Amy Tan               1991.0  Putnam Pub Group   \n",
       "4               Amy Tan               1991.0  Putnam Pub Group   \n",
       "...                 ...                  ...               ...   \n",
       "32272      Maya Angelou               1996.0      Random House   \n",
       "32273       CHAIM POTOK               1997.0  Ballantine Books   \n",
       "32274   Patricia Potter               1992.0      Bantam Books   \n",
       "32275  J. R. R. Tolkien               1992.0  Houghton Mifflin   \n",
       "32276               NaN                  NaN               NaN   \n",
       "\n",
       "                                             Image-URL-S  \\\n",
       "0      http://images.amazon.com/images/P/0399135782.0...   \n",
       "1      http://images.amazon.com/images/P/0399135782.0...   \n",
       "2      http://images.amazon.com/images/P/0399135782.0...   \n",
       "3      http://images.amazon.com/images/P/0399135782.0...   \n",
       "4      http://images.amazon.com/images/P/0399135782.0...   \n",
       "...                                                  ...   \n",
       "32272  http://images.amazon.com/images/P/0394429869.0...   \n",
       "32273  http://images.amazon.com/images/P/0449001164.0...   \n",
       "32274  http://images.amazon.com/images/P/0553290703.0...   \n",
       "32275  http://images.amazon.com/images/P/0395647398.0...   \n",
       "32276                                                NaN   \n",
       "\n",
       "                                             Image-URL-M  \\\n",
       "0      http://images.amazon.com/images/P/0399135782.0...   \n",
       "1      http://images.amazon.com/images/P/0399135782.0...   \n",
       "2      http://images.amazon.com/images/P/0399135782.0...   \n",
       "3      http://images.amazon.com/images/P/0399135782.0...   \n",
       "4      http://images.amazon.com/images/P/0399135782.0...   \n",
       "...                                                  ...   \n",
       "32272  http://images.amazon.com/images/P/0394429869.0...   \n",
       "32273  http://images.amazon.com/images/P/0449001164.0...   \n",
       "32274  http://images.amazon.com/images/P/0553290703.0...   \n",
       "32275  http://images.amazon.com/images/P/0395647398.0...   \n",
       "32276                                                NaN   \n",
       "\n",
       "                                             Image-URL-L   User-ID  \\\n",
       "0      http://images.amazon.com/images/P/0399135782.0...   11676.0   \n",
       "1      http://images.amazon.com/images/P/0399135782.0...   29526.0   \n",
       "2      http://images.amazon.com/images/P/0399135782.0...   46398.0   \n",
       "3      http://images.amazon.com/images/P/0399135782.0...  230522.0   \n",
       "4      http://images.amazon.com/images/P/0399135782.0...  245827.0   \n",
       "...                                                  ...       ...   \n",
       "32272  http://images.amazon.com/images/P/0394429869.0...  239594.0   \n",
       "32273  http://images.amazon.com/images/P/0449001164.0...  239594.0   \n",
       "32274  http://images.amazon.com/images/P/0553290703.0...  244685.0   \n",
       "32275  http://images.amazon.com/images/P/0395647398.0...  259901.0   \n",
       "32276                                                NaN     123.0   \n",
       "\n",
       "       Book-Rating                  Location   Age  \n",
       "0              9.0                       NaN   NaN  \n",
       "1              9.0                       NaN   NaN  \n",
       "2              9.0                       NaN   NaN  \n",
       "3              7.0                       NaN   NaN  \n",
       "4              9.0                       NaN   NaN  \n",
       "...            ...                       ...   ...  \n",
       "32272          8.0                       NaN   NaN  \n",
       "32273          7.0                       NaN   NaN  \n",
       "32274          9.0                       NaN   NaN  \n",
       "32275         10.0                       NaN   NaN  \n",
       "32276          0.0  ann arbor, michigan, usa  24.0  \n",
       "\n",
       "[32277 rows x 12 columns]"
      ]
     },
     "execution_count": 38,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df1"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "e1ebc950",
   "metadata": {
    "papermill": {
     "duration": 0.031576,
     "end_time": "2023-05-31T08:53:43.248782",
     "exception": false,
     "start_time": "2023-05-31T08:53:43.217206",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "The dataset is now ready for fuether processes. Now we can convert this dataset into user-item matrix."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 39,
   "id": "7146f74d",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2023-05-31T08:53:43.314316Z",
     "iopub.status.busy": "2023-05-31T08:53:43.313906Z",
     "iopub.status.idle": "2023-05-31T08:53:43.417294Z",
     "shell.execute_reply": "2023-05-31T08:53:43.416174Z"
    },
    "papermill": {
     "duration": 0.139133,
     "end_time": "2023-05-31T08:53:43.419675",
     "exception": false,
     "start_time": "2023-05-31T08:53:43.280542",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th>Book-Title</th>\n",
       "      <th>1984</th>\n",
       "      <th>1st to Die: A Novel</th>\n",
       "      <th>2010: Odyssey Two</th>\n",
       "      <th>2061: Odyssey Three</th>\n",
       "      <th>2nd Chance</th>\n",
       "      <th>311 Pelican Court</th>\n",
       "      <th>3rd Degree</th>\n",
       "      <th>4 Blondes</th>\n",
       "      <th>84 Charing Cross Road</th>\n",
       "      <th>A 2nd Helping of Chicken Soup for the Soul (Chicken Soup for the Soul Series (Paper))</th>\n",
       "      <th>...</th>\n",
       "      <th>Wuthering Heights (Penguin Classics)</th>\n",
       "      <th>Xanth 14: Question Quest</th>\n",
       "      <th>Xanth 15: The Color of Her Panties</th>\n",
       "      <th>YOU BELONG TO ME</th>\n",
       "      <th>Year of Wonders</th>\n",
       "      <th>You Belong To Me</th>\n",
       "      <th>You Belong to Me</th>\n",
       "      <th>Yukon Ho!</th>\n",
       "      <th>Zen and the Art of Motorcycle Maintenance: An Inquiry into Values</th>\n",
       "      <th>\\O\\\" Is for Outlaw\"</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>User-ID</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>123.0</th>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>254.0</th>\n",
       "      <td>9.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>638.0</th>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>9.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1424.0</th>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>7.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1733.0</th>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>276680.0</th>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>277427.0</th>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>278137.0</th>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>278188.0</th>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>278418.0</th>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>1129 rows × 1698 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "Book-Title  1984  1st to Die: A Novel  2010: Odyssey Two  2061: Odyssey Three  \\\n",
       "User-ID                                                                         \n",
       "123.0        NaN                  NaN                NaN                  NaN   \n",
       "254.0        9.0                  NaN                NaN                  NaN   \n",
       "638.0        NaN                  NaN                NaN                  NaN   \n",
       "1424.0       NaN                  NaN                NaN                  NaN   \n",
       "1733.0       NaN                  NaN                NaN                  NaN   \n",
       "...          ...                  ...                ...                  ...   \n",
       "276680.0     NaN                  NaN                NaN                  NaN   \n",
       "277427.0     NaN                  NaN                NaN                  NaN   \n",
       "278137.0     NaN                  NaN                NaN                  NaN   \n",
       "278188.0     NaN                  NaN                NaN                  NaN   \n",
       "278418.0     NaN                  NaN                NaN                  NaN   \n",
       "\n",
       "Book-Title  2nd Chance  311 Pelican Court  3rd Degree  4 Blondes  \\\n",
       "User-ID                                                            \n",
       "123.0              NaN                NaN         NaN        NaN   \n",
       "254.0              NaN                NaN         NaN        NaN   \n",
       "638.0              9.0                NaN         NaN        NaN   \n",
       "1424.0             NaN                NaN         NaN        NaN   \n",
       "1733.0             NaN                NaN         NaN        NaN   \n",
       "...                ...                ...         ...        ...   \n",
       "276680.0           NaN                NaN         NaN        NaN   \n",
       "277427.0           NaN                NaN         NaN        NaN   \n",
       "278137.0           NaN                NaN         NaN        NaN   \n",
       "278188.0           NaN                NaN         NaN        NaN   \n",
       "278418.0           NaN                NaN         NaN        NaN   \n",
       "\n",
       "Book-Title  84 Charing Cross Road  \\\n",
       "User-ID                             \n",
       "123.0                         NaN   \n",
       "254.0                         NaN   \n",
       "638.0                         NaN   \n",
       "1424.0                        NaN   \n",
       "1733.0                        NaN   \n",
       "...                           ...   \n",
       "276680.0                      NaN   \n",
       "277427.0                      NaN   \n",
       "278137.0                      NaN   \n",
       "278188.0                      NaN   \n",
       "278418.0                      NaN   \n",
       "\n",
       "Book-Title  A 2nd Helping of Chicken Soup for the Soul (Chicken Soup for the Soul Series (Paper))  \\\n",
       "User-ID                                                                                             \n",
       "123.0                                                     NaN                                       \n",
       "254.0                                                     NaN                                       \n",
       "638.0                                                     NaN                                       \n",
       "1424.0                                                    NaN                                       \n",
       "1733.0                                                    NaN                                       \n",
       "...                                                       ...                                       \n",
       "276680.0                                                  NaN                                       \n",
       "277427.0                                                  NaN                                       \n",
       "278137.0                                                  NaN                                       \n",
       "278188.0                                                  NaN                                       \n",
       "278418.0                                                  NaN                                       \n",
       "\n",
       "Book-Title  ...  Wuthering Heights (Penguin Classics)  \\\n",
       "User-ID     ...                                         \n",
       "123.0       ...                                   NaN   \n",
       "254.0       ...                                   NaN   \n",
       "638.0       ...                                   NaN   \n",
       "1424.0      ...                                   NaN   \n",
       "1733.0      ...                                   NaN   \n",
       "...         ...                                   ...   \n",
       "276680.0    ...                                   NaN   \n",
       "277427.0    ...                                   NaN   \n",
       "278137.0    ...                                   NaN   \n",
       "278188.0    ...                                   NaN   \n",
       "278418.0    ...                                   NaN   \n",
       "\n",
       "Book-Title  Xanth 14: Question Quest  Xanth 15: The Color of Her Panties  \\\n",
       "User-ID                                                                    \n",
       "123.0                            NaN                                 NaN   \n",
       "254.0                            NaN                                 NaN   \n",
       "638.0                            NaN                                 NaN   \n",
       "1424.0                           NaN                                 NaN   \n",
       "1733.0                           NaN                                 NaN   \n",
       "...                              ...                                 ...   \n",
       "276680.0                         NaN                                 NaN   \n",
       "277427.0                         NaN                                 NaN   \n",
       "278137.0                         NaN                                 NaN   \n",
       "278188.0                         NaN                                 NaN   \n",
       "278418.0                         NaN                                 NaN   \n",
       "\n",
       "Book-Title  YOU BELONG TO ME  Year of Wonders  You Belong To Me  \\\n",
       "User-ID                                                           \n",
       "123.0                    NaN              NaN               NaN   \n",
       "254.0                    NaN              NaN               NaN   \n",
       "638.0                    NaN              NaN               NaN   \n",
       "1424.0                   NaN              7.0               NaN   \n",
       "1733.0                   NaN              NaN               NaN   \n",
       "...                      ...              ...               ...   \n",
       "276680.0                 NaN              NaN               NaN   \n",
       "277427.0                 NaN              NaN               NaN   \n",
       "278137.0                 NaN              NaN               NaN   \n",
       "278188.0                 NaN              NaN               NaN   \n",
       "278418.0                 NaN              NaN               NaN   \n",
       "\n",
       "Book-Title  You Belong to Me  Yukon Ho!  \\\n",
       "User-ID                                   \n",
       "123.0                    NaN        NaN   \n",
       "254.0                    NaN        NaN   \n",
       "638.0                    NaN        NaN   \n",
       "1424.0                   NaN        NaN   \n",
       "1733.0                   NaN        NaN   \n",
       "...                      ...        ...   \n",
       "276680.0                 NaN        NaN   \n",
       "277427.0                 NaN        NaN   \n",
       "278137.0                 NaN        NaN   \n",
       "278188.0                 NaN        NaN   \n",
       "278418.0                 NaN        NaN   \n",
       "\n",
       "Book-Title  Zen and the Art of Motorcycle Maintenance: An Inquiry into Values  \\\n",
       "User-ID                                                                         \n",
       "123.0                                                     NaN                   \n",
       "254.0                                                     NaN                   \n",
       "638.0                                                     NaN                   \n",
       "1424.0                                                    NaN                   \n",
       "1733.0                                                    NaN                   \n",
       "...                                                       ...                   \n",
       "276680.0                                                  NaN                   \n",
       "277427.0                                                  NaN                   \n",
       "278137.0                                                  NaN                   \n",
       "278188.0                                                  NaN                   \n",
       "278418.0                                                  NaN                   \n",
       "\n",
       "Book-Title  \\O\\\" Is for Outlaw\"  \n",
       "User-ID                          \n",
       "123.0                       NaN  \n",
       "254.0                       NaN  \n",
       "638.0                       NaN  \n",
       "1424.0                      NaN  \n",
       "1733.0                      NaN  \n",
       "...                         ...  \n",
       "276680.0                    NaN  \n",
       "277427.0                    NaN  \n",
       "278137.0                    NaN  \n",
       "278188.0                    NaN  \n",
       "278418.0                    NaN  \n",
       "\n",
       "[1129 rows x 1698 columns]"
      ]
     },
     "execution_count": 39,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "users_matrix = pd.pivot_table(data=df1, index=[\"User-ID\"], columns=[\"Book-Title\"], values=\"Book-Rating\", dropna=False)\n",
    "users_matrix"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 40,
   "id": "46de0348",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2023-05-31T08:53:43.486901Z",
     "iopub.status.busy": "2023-05-31T08:53:43.486520Z",
     "iopub.status.idle": "2023-05-31T08:53:43.519213Z",
     "shell.execute_reply": "2023-05-31T08:53:43.518173Z"
    },
    "papermill": {
     "duration": 0.069412,
     "end_time": "2023-05-31T08:53:43.521780",
     "exception": false,
     "start_time": "2023-05-31T08:53:43.452368",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "# imputing the null values with 0\n",
    "users_matrix.fillna(0, inplace=True)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 41,
   "id": "eaae26e2",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2023-05-31T08:53:43.590245Z",
     "iopub.status.busy": "2023-05-31T08:53:43.588970Z",
     "iopub.status.idle": "2023-05-31T08:53:45.329767Z",
     "shell.execute_reply": "2023-05-31T08:53:45.328289Z"
    },
    "papermill": {
     "duration": 1.777978,
     "end_time": "2023-05-31T08:53:45.332610",
     "exception": false,
     "start_time": "2023-05-31T08:53:43.554632",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "# cosin matrix\n",
    "user_sim = 1 - pairwise_distances(users_matrix.values, metric=\"cosine\")\n",
    "np.fill_diagonal(user_sim, 0)\n",
    "\n",
    "# converting the matrix into dataframe\n",
    "user_sim_df = pd.DataFrame(user_sim)\n",
    "\n",
    "# set the index and column names to user ids\n",
    "user_sim_df.index = df1[\"User-ID\"].unique()\n",
    "user_sim_df.columns = df1[\"User-ID\"].unique()\n",
    "\n",
    "# finding 2 most similar users \n",
    "similar = user_sim_df.nlargest(2, user_id).index.values\n",
    "\n",
    "# extracting the books which is already read and rated by the specified user\n",
    "book_read = users_rating.loc[(users_rating == user_id).any(axis=1), 'Book-Title'].values"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 42,
   "id": "9b756696",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2023-05-31T08:53:45.402014Z",
     "iopub.status.busy": "2023-05-31T08:53:45.401265Z",
     "iopub.status.idle": "2023-05-31T08:53:45.406978Z",
     "shell.execute_reply": "2023-05-31T08:53:45.406203Z"
    },
    "papermill": {
     "duration": 0.042941,
     "end_time": "2023-05-31T08:53:45.409196",
     "exception": false,
     "start_time": "2023-05-31T08:53:45.366255",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array([nan, nan,\n",
       "       'Economic development, social structure, and population growth',\n",
       "       nan, nan, nan, nan, nan, nan], dtype=object)"
      ]
     },
     "execution_count": 42,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "book_read"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 43,
   "id": "64039d65",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2023-05-31T08:53:45.477387Z",
     "iopub.status.busy": "2023-05-31T08:53:45.476649Z",
     "iopub.status.idle": "2023-05-31T08:53:47.091051Z",
     "shell.execute_reply": "2023-05-31T08:53:47.089785Z"
    },
    "papermill": {
     "duration": 1.651848,
     "end_time": "2023-05-31T08:53:47.093888",
     "exception": false,
     "start_time": "2023-05-31T08:53:45.442040",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "# extracting the books which are rated by the similar users\n",
    "book_sugg = []\n",
    "for x in np.nditer(similar):\n",
    "    book = df1.loc[(df1 == x).any(axis=1), 'Book-Title'].values\n",
    "    if len(book) > 25:\n",
    "        book1 = book[:25]\n",
    "    else:\n",
    "        book1 = book\n",
    "\n",
    "    book_sugg.append(book1)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 44,
   "id": "1af22122",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2023-05-31T08:53:47.163430Z",
     "iopub.status.busy": "2023-05-31T08:53:47.162990Z",
     "iopub.status.idle": "2023-05-31T08:53:47.170456Z",
     "shell.execute_reply": "2023-05-31T08:53:47.169331Z"
    },
    "papermill": {
     "duration": 0.045595,
     "end_time": "2023-05-31T08:53:47.172681",
     "exception": false,
     "start_time": "2023-05-31T08:53:47.127086",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "[array(['Wild Animus', 'To Kill a Mockingbird', 'Seabiscuit',\n",
       "        'The Martian Chronicles',\n",
       "        'The Curious Incident of the Dog in the Night-Time : A Novel',\n",
       "        'Lies and the Lying Liars Who Tell Them: A Fair and Balanced Look at the Right',\n",
       "        'The Firm', 'The Diary of Ellen Rimbauer: My Life at Rose Red',\n",
       "        \"Angela's Ashes: A Memoir\",\n",
       "        \"The Pilot's Wife : A Novel Tag: Author of the Weight of Water (Oprah's Book Club (Hardcover))\",\n",
       "        'Snow Falling on Cedars', 'Breath, Eyes, Memory',\n",
       "        \"The Dress Lodger (Ballantine Reader's Circle)\", 'The Reader',\n",
       "        'Lord of the Flies', 'Fahrenheit 451', \"ANGELA'S ASHES\",\n",
       "        'The Dogs of Babel (Today Show Book Club #12)',\n",
       "        'Midwives: A Novel', 'Girl, Interrupted',\n",
       "        'In the Heart of the Sea: The Tragedy of the Whaleship Essex',\n",
       "        'STONES FROM THE RIVER', 'Primary Colors: A Novel of Politics',\n",
       "        'Silence of the Lambs', 'A Monstrous Regiment of Women'],\n",
       "       dtype=object),\n",
       " array([\"Corelli's Mandolin : A Novel\",\n",
       "        'Little Altars Everywhere: A Novel', 'The God of Small Things',\n",
       "        'Wicked: The Life and Times of the Wicked Witch of the West',\n",
       "        'The Perfect Storm : A True Story of Men Against the Sea',\n",
       "        'Life of Pi', 'Along Came a Spider (Alex Cross Novels)',\n",
       "        'The Poisonwood Bible: A Novel',\n",
       "        'A Lesson Before Dying (Vintage Contemporaries (Paperback))',\n",
       "        'Breath, Eyes, Memory', 'Ellen Foster', 'Cold Mountain : A Novel',\n",
       "        'The Reader', 'Hearts In Atlantis',\n",
       "        \"Ender's Game (Ender Wiggins Saga (Paperback))\",\n",
       "        \"Tuesdays with Morrie: An Old Man, a Young Man, and Life's Greatest Lesson\",\n",
       "        'Waiting (Vintage International)', 'Bee Season: A Novel',\n",
       "        'The Nanny Diaries: A Novel', 'Girl, Interrupted',\n",
       "        'A Child Called \\\\It\\\\\": One Child\\'s Courage to Survive\"',\n",
       "        'Falling Angels', 'Prodigal Summer', 'House of Sand and Fog',\n",
       "        'Four Blind Mice'], dtype=object)]"
      ]
     },
     "execution_count": 44,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "book_sugg"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 45,
   "id": "0dc94b3e",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2023-05-31T08:53:47.243491Z",
     "iopub.status.busy": "2023-05-31T08:53:47.243022Z",
     "iopub.status.idle": "2023-05-31T08:53:47.248933Z",
     "shell.execute_reply": "2023-05-31T08:53:47.247782Z"
    },
    "papermill": {
     "duration": 0.043543,
     "end_time": "2023-05-31T08:53:47.251038",
     "exception": false,
     "start_time": "2023-05-31T08:53:47.207495",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "# we will only recommend the books which are not read by the specified user yet\n",
    "this = []\n",
    "for bi in flatten(book_sugg):\n",
    "    if bi not in book_read:\n",
    "        read = bi\n",
    "        this.append(read)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 46,
   "id": "46c2bff3",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2023-05-31T08:53:47.320094Z",
     "iopub.status.busy": "2023-05-31T08:53:47.319341Z",
     "iopub.status.idle": "2023-05-31T08:53:47.326066Z",
     "shell.execute_reply": "2023-05-31T08:53:47.325323Z"
    },
    "papermill": {
     "duration": 0.043268,
     "end_time": "2023-05-31T08:53:47.328017",
     "exception": false,
     "start_time": "2023-05-31T08:53:47.284749",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "[array(['Wild Animus', 'To Kill a Mockingbird', 'Seabiscuit',\n",
       "        'The Martian Chronicles',\n",
       "        'The Curious Incident of the Dog in the Night-Time : A Novel',\n",
       "        'Lies and the Lying Liars Who Tell Them: A Fair and Balanced Look at the Right',\n",
       "        'The Firm', 'The Diary of Ellen Rimbauer: My Life at Rose Red',\n",
       "        \"Angela's Ashes: A Memoir\",\n",
       "        \"The Pilot's Wife : A Novel Tag: Author of the Weight of Water (Oprah's Book Club (Hardcover))\",\n",
       "        'Snow Falling on Cedars', 'Breath, Eyes, Memory',\n",
       "        \"The Dress Lodger (Ballantine Reader's Circle)\", 'The Reader',\n",
       "        'Lord of the Flies', 'Fahrenheit 451', \"ANGELA'S ASHES\",\n",
       "        'The Dogs of Babel (Today Show Book Club #12)',\n",
       "        'Midwives: A Novel', 'Girl, Interrupted',\n",
       "        'In the Heart of the Sea: The Tragedy of the Whaleship Essex',\n",
       "        'STONES FROM THE RIVER', 'Primary Colors: A Novel of Politics',\n",
       "        'Silence of the Lambs', 'A Monstrous Regiment of Women'],\n",
       "       dtype=object),\n",
       " array([\"Corelli's Mandolin : A Novel\",\n",
       "        'Little Altars Everywhere: A Novel', 'The God of Small Things',\n",
       "        'Wicked: The Life and Times of the Wicked Witch of the West',\n",
       "        'The Perfect Storm : A True Story of Men Against the Sea',\n",
       "        'Life of Pi', 'Along Came a Spider (Alex Cross Novels)',\n",
       "        'The Poisonwood Bible: A Novel',\n",
       "        'A Lesson Before Dying (Vintage Contemporaries (Paperback))',\n",
       "        'Breath, Eyes, Memory', 'Ellen Foster', 'Cold Mountain : A Novel',\n",
       "        'The Reader', 'Hearts In Atlantis',\n",
       "        \"Ender's Game (Ender Wiggins Saga (Paperback))\",\n",
       "        \"Tuesdays with Morrie: An Old Man, a Young Man, and Life's Greatest Lesson\",\n",
       "        'Waiting (Vintage International)', 'Bee Season: A Novel',\n",
       "        'The Nanny Diaries: A Novel', 'Girl, Interrupted',\n",
       "        'A Child Called \\\\It\\\\\": One Child\\'s Courage to Survive\"',\n",
       "        'Falling Angels', 'Prodigal Summer', 'House of Sand and Fog',\n",
       "        'Four Blind Mice'], dtype=object)]"
      ]
     },
     "execution_count": 46,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "this"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 47,
   "id": "da0b3353",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2023-05-31T08:53:47.397857Z",
     "iopub.status.busy": "2023-05-31T08:53:47.397100Z",
     "iopub.status.idle": "2023-05-31T08:53:47.410648Z",
     "shell.execute_reply": "2023-05-31T08:53:47.409528Z"
    },
    "papermill": {
     "duration": 0.050787,
     "end_time": "2023-05-31T08:53:47.412879",
     "exception": false,
     "start_time": "2023-05-31T08:53:47.362092",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Book-Title</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>Wild Animus</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>To Kill a Mockingbird</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>Seabiscuit</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>The Martian Chronicles</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>The Curious Incident of the Dog in the Night-T...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>Lies and the Lying Liars Who Tell Them: A Fair...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>The Firm</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>The Diary of Ellen Rimbauer: My Life at Rose Red</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>Angela's Ashes: A Memoir</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>The Pilot's Wife : A Novel Tag: Author of the ...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10</th>\n",
       "      <td>Snow Falling on Cedars</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11</th>\n",
       "      <td>Breath, Eyes, Memory</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>The Dress Lodger (Ballantine Reader's Circle)</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13</th>\n",
       "      <td>The Reader</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14</th>\n",
       "      <td>Lord of the Flies</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15</th>\n",
       "      <td>Fahrenheit 451</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>ANGELA'S ASHES</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17</th>\n",
       "      <td>The Dogs of Babel (Today Show Book Club #12)</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>18</th>\n",
       "      <td>Midwives: A Novel</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19</th>\n",
       "      <td>Girl, Interrupted</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>20</th>\n",
       "      <td>In the Heart of the Sea: The Tragedy of the Wh...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>21</th>\n",
       "      <td>STONES FROM THE RIVER</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>22</th>\n",
       "      <td>Primary Colors: A Novel of Politics</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>23</th>\n",
       "      <td>Silence of the Lambs</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>24</th>\n",
       "      <td>A Monstrous Regiment of Women</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>25</th>\n",
       "      <td>Corelli's Mandolin : A Novel</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>26</th>\n",
       "      <td>Little Altars Everywhere: A Novel</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>27</th>\n",
       "      <td>The God of Small Things</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>28</th>\n",
       "      <td>Wicked: The Life and Times of the Wicked Witch...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>29</th>\n",
       "      <td>The Perfect Storm : A True Story of Men Agains...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>30</th>\n",
       "      <td>Life of Pi</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>31</th>\n",
       "      <td>Along Came a Spider (Alex Cross Novels)</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>32</th>\n",
       "      <td>The Poisonwood Bible: A Novel</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>33</th>\n",
       "      <td>A Lesson Before Dying (Vintage Contemporaries ...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>34</th>\n",
       "      <td>Breath, Eyes, Memory</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>35</th>\n",
       "      <td>Ellen Foster</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>36</th>\n",
       "      <td>Cold Mountain : A Novel</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>37</th>\n",
       "      <td>The Reader</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>38</th>\n",
       "      <td>Hearts In Atlantis</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>39</th>\n",
       "      <td>Ender's Game (Ender Wiggins Saga (Paperback))</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>40</th>\n",
       "      <td>Tuesdays with Morrie: An Old Man, a Young Man,...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>41</th>\n",
       "      <td>Waiting (Vintage International)</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>42</th>\n",
       "      <td>Bee Season: A Novel</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>43</th>\n",
       "      <td>The Nanny Diaries: A Novel</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>44</th>\n",
       "      <td>Girl, Interrupted</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>45</th>\n",
       "      <td>A Child Called \\It\\\": One Child's Courage to S...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>46</th>\n",
       "      <td>Falling Angels</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>47</th>\n",
       "      <td>Prodigal Summer</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>48</th>\n",
       "      <td>House of Sand and Fog</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>49</th>\n",
       "      <td>Four Blind Mice</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                                           Book-Title\n",
       "0                                         Wild Animus\n",
       "1                               To Kill a Mockingbird\n",
       "2                                          Seabiscuit\n",
       "3                              The Martian Chronicles\n",
       "4   The Curious Incident of the Dog in the Night-T...\n",
       "5   Lies and the Lying Liars Who Tell Them: A Fair...\n",
       "6                                            The Firm\n",
       "7    The Diary of Ellen Rimbauer: My Life at Rose Red\n",
       "8                            Angela's Ashes: A Memoir\n",
       "9   The Pilot's Wife : A Novel Tag: Author of the ...\n",
       "10                             Snow Falling on Cedars\n",
       "11                               Breath, Eyes, Memory\n",
       "12      The Dress Lodger (Ballantine Reader's Circle)\n",
       "13                                         The Reader\n",
       "14                                  Lord of the Flies\n",
       "15                                     Fahrenheit 451\n",
       "16                                     ANGELA'S ASHES\n",
       "17       The Dogs of Babel (Today Show Book Club #12)\n",
       "18                                  Midwives: A Novel\n",
       "19                                  Girl, Interrupted\n",
       "20  In the Heart of the Sea: The Tragedy of the Wh...\n",
       "21                              STONES FROM THE RIVER\n",
       "22                Primary Colors: A Novel of Politics\n",
       "23                               Silence of the Lambs\n",
       "24                      A Monstrous Regiment of Women\n",
       "25                       Corelli's Mandolin : A Novel\n",
       "26                  Little Altars Everywhere: A Novel\n",
       "27                            The God of Small Things\n",
       "28  Wicked: The Life and Times of the Wicked Witch...\n",
       "29  The Perfect Storm : A True Story of Men Agains...\n",
       "30                                         Life of Pi\n",
       "31            Along Came a Spider (Alex Cross Novels)\n",
       "32                      The Poisonwood Bible: A Novel\n",
       "33  A Lesson Before Dying (Vintage Contemporaries ...\n",
       "34                               Breath, Eyes, Memory\n",
       "35                                       Ellen Foster\n",
       "36                            Cold Mountain : A Novel\n",
       "37                                         The Reader\n",
       "38                                 Hearts In Atlantis\n",
       "39      Ender's Game (Ender Wiggins Saga (Paperback))\n",
       "40  Tuesdays with Morrie: An Old Man, a Young Man,...\n",
       "41                    Waiting (Vintage International)\n",
       "42                                Bee Season: A Novel\n",
       "43                         The Nanny Diaries: A Novel\n",
       "44                                  Girl, Interrupted\n",
       "45  A Child Called \\It\\\": One Child's Courage to S...\n",
       "46                                     Falling Angels\n",
       "47                                    Prodigal Summer\n",
       "48                              House of Sand and Fog\n",
       "49                                    Four Blind Mice"
      ]
     },
     "execution_count": 47,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "Suggested = pd.DataFrame(np.concatenate(this, axis=0), columns=[\"Book-Title\"])        \n",
    "Suggested"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 48,
   "id": "5ef4c6bf",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2023-05-31T08:53:47.484092Z",
     "iopub.status.busy": "2023-05-31T08:53:47.483397Z",
     "iopub.status.idle": "2023-05-31T08:53:47.533553Z",
     "shell.execute_reply": "2023-05-31T08:53:47.532721Z"
    },
    "papermill": {
     "duration": 0.088593,
     "end_time": "2023-05-31T08:53:47.536148",
     "exception": false,
     "start_time": "2023-05-31T08:53:47.447555",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Book-Title</th>\n",
       "      <th>num_ratings</th>\n",
       "      <th>avg_rating</th>\n",
       "      <th>Book-Author</th>\n",
       "      <th>Publisher</th>\n",
       "      <th>link</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>Wild Animus</td>\n",
       "      <td>581</td>\n",
       "      <td>4.390706</td>\n",
       "      <td>Rich Shapero</td>\n",
       "      <td>Too Far</td>\n",
       "      <td>http://images.amazon.com/images/P/0971880107.0...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>The Nanny Diaries: A Novel</td>\n",
       "      <td>393</td>\n",
       "      <td>7.437659</td>\n",
       "      <td>Emma McLaughlin</td>\n",
       "      <td>St. Martin's Press</td>\n",
       "      <td>http://images.amazon.com/images/P/0312278586.0...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>Life of Pi</td>\n",
       "      <td>336</td>\n",
       "      <td>8.080357</td>\n",
       "      <td>Yann Martel</td>\n",
       "      <td>Harcourt</td>\n",
       "      <td>http://images.amazon.com/images/P/0151008116.0...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>18</th>\n",
       "      <td>Snow Falling on Cedars</td>\n",
       "      <td>275</td>\n",
       "      <td>7.829091</td>\n",
       "      <td>David Guterson</td>\n",
       "      <td>Harcourt</td>\n",
       "      <td>http://images.amazon.com/images/P/0151001006.0...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>20</th>\n",
       "      <td>To Kill a Mockingbird</td>\n",
       "      <td>267</td>\n",
       "      <td>8.977528</td>\n",
       "      <td>Harper Lee</td>\n",
       "      <td>Little Brown &amp;amp; Company</td>\n",
       "      <td>http://images.amazon.com/images/P/0446310786.0...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>26</th>\n",
       "      <td>Tuesdays with Morrie: An Old Man, a Young Man,...</td>\n",
       "      <td>250</td>\n",
       "      <td>8.588000</td>\n",
       "      <td>MITCH ALBOM</td>\n",
       "      <td>Doubleday</td>\n",
       "      <td>http://images.amazon.com/images/P/0385484518.0...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>30</th>\n",
       "      <td>House of Sand and Fog</td>\n",
       "      <td>242</td>\n",
       "      <td>7.363636</td>\n",
       "      <td>Andre Dubus III</td>\n",
       "      <td>Vintage Books</td>\n",
       "      <td>http://images.amazon.com/images/P/0375727345.0...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>34</th>\n",
       "      <td>The Firm</td>\n",
       "      <td>224</td>\n",
       "      <td>7.825893</td>\n",
       "      <td>John Grisham</td>\n",
       "      <td>Doubleday Books</td>\n",
       "      <td>http://images.amazon.com/images/P/0385416342.0...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>35</th>\n",
       "      <td>The Poisonwood Bible: A Novel</td>\n",
       "      <td>218</td>\n",
       "      <td>8.178899</td>\n",
       "      <td>Barbara Kingsolver</td>\n",
       "      <td>Perennial</td>\n",
       "      <td>http://images.amazon.com/images/P/0060930535.0...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>49</th>\n",
       "      <td>Fahrenheit 451</td>\n",
       "      <td>204</td>\n",
       "      <td>8.549020</td>\n",
       "      <td>Ray Bradbury</td>\n",
       "      <td>Distribooks Inc</td>\n",
       "      <td>http://images.amazon.com/images/P/3257208626.0...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>52</th>\n",
       "      <td>The Reader</td>\n",
       "      <td>195</td>\n",
       "      <td>7.200000</td>\n",
       "      <td>Bernhard Schlink</td>\n",
       "      <td>Random House</td>\n",
       "      <td>http://images.amazon.com/images/P/0679442790.0...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>58</th>\n",
       "      <td>Little Altars Everywhere: A Novel</td>\n",
       "      <td>186</td>\n",
       "      <td>7.596774</td>\n",
       "      <td>Rebecca Wells</td>\n",
       "      <td>Perennial</td>\n",
       "      <td>http://images.amazon.com/images/P/0060976845.0...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>83</th>\n",
       "      <td>Wicked: The Life and Times of the Wicked Witch...</td>\n",
       "      <td>156</td>\n",
       "      <td>7.871795</td>\n",
       "      <td>Gregory Maguire</td>\n",
       "      <td>Regan Books</td>\n",
       "      <td>http://images.amazon.com/images/P/0060987103.0...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>86</th>\n",
       "      <td>Midwives: A Novel</td>\n",
       "      <td>153</td>\n",
       "      <td>7.732026</td>\n",
       "      <td>Chris Bohjalian</td>\n",
       "      <td>Vintage</td>\n",
       "      <td>http://images.amazon.com/images/P/0375706771.0...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>87</th>\n",
       "      <td>Ender's Game (Ender Wiggins Saga (Paperback))</td>\n",
       "      <td>151</td>\n",
       "      <td>8.920530</td>\n",
       "      <td>Orson Scott Card</td>\n",
       "      <td>Tor Books</td>\n",
       "      <td>http://images.amazon.com/images/P/0312853238.0...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>108</th>\n",
       "      <td>The Perfect Storm : A True Story of Men Agains...</td>\n",
       "      <td>137</td>\n",
       "      <td>7.489051</td>\n",
       "      <td>Sebastian Junger</td>\n",
       "      <td>Perennial</td>\n",
       "      <td>http://images.amazon.com/images/P/0060977477.0...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>111</th>\n",
       "      <td>ANGELA'S ASHES</td>\n",
       "      <td>136</td>\n",
       "      <td>8.360294</td>\n",
       "      <td>Frank McCourt</td>\n",
       "      <td>Scribner</td>\n",
       "      <td>http://images.amazon.com/images/P/0684874350.0...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>112</th>\n",
       "      <td>STONES FROM THE RIVER</td>\n",
       "      <td>136</td>\n",
       "      <td>8.036765</td>\n",
       "      <td>Ursula Hegi</td>\n",
       "      <td>Simon &amp;amp; Schuster</td>\n",
       "      <td>http://images.amazon.com/images/P/0684844729.0...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>114</th>\n",
       "      <td>A Child Called \\It\\\": One Child's Courage to S...</td>\n",
       "      <td>136</td>\n",
       "      <td>7.963235</td>\n",
       "      <td>Dave Pelzer</td>\n",
       "      <td>Health Communications</td>\n",
       "      <td>http://images.amazon.com/images/P/1558743669.0...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>120</th>\n",
       "      <td>Cold Mountain : A Novel</td>\n",
       "      <td>134</td>\n",
       "      <td>7.776119</td>\n",
       "      <td>CHARLES FRAZIER</td>\n",
       "      <td>Vintage</td>\n",
       "      <td>http://images.amazon.com/images/P/0375700757.0...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>139</th>\n",
       "      <td>The God of Small Things</td>\n",
       "      <td>124</td>\n",
       "      <td>7.661290</td>\n",
       "      <td>Arundhati Roy</td>\n",
       "      <td>Perennial</td>\n",
       "      <td>http://images.amazon.com/images/P/0060977493.0...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>140</th>\n",
       "      <td>Lord of the Flies</td>\n",
       "      <td>123</td>\n",
       "      <td>8.040650</td>\n",
       "      <td>William Gerald Golding</td>\n",
       "      <td>Perigee Trade</td>\n",
       "      <td>http://images.amazon.com/images/P/0399501487.0...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>141</th>\n",
       "      <td>Girl, Interrupted</td>\n",
       "      <td>122</td>\n",
       "      <td>7.344262</td>\n",
       "      <td>SUSANNA KAYSEN</td>\n",
       "      <td>Vintage</td>\n",
       "      <td>http://images.amazon.com/images/P/0679746048.0...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>142</th>\n",
       "      <td>Silence of the Lambs</td>\n",
       "      <td>121</td>\n",
       "      <td>8.380165</td>\n",
       "      <td>Thomas Harris</td>\n",
       "      <td>St. Martin's Press</td>\n",
       "      <td>http://images.amazon.com/images/P/0312924585.0...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>148</th>\n",
       "      <td>Along Came a Spider (Alex Cross Novels)</td>\n",
       "      <td>118</td>\n",
       "      <td>8.042373</td>\n",
       "      <td>James Patterson</td>\n",
       "      <td>Warner Books</td>\n",
       "      <td>http://images.amazon.com/images/P/0446364193.0...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>177</th>\n",
       "      <td>Four Blind Mice</td>\n",
       "      <td>104</td>\n",
       "      <td>8.182692</td>\n",
       "      <td>James Patterson</td>\n",
       "      <td>Little, Brown</td>\n",
       "      <td>http://images.amazon.com/images/P/0316693006.0...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>208</th>\n",
       "      <td>Angela's Ashes: A Memoir</td>\n",
       "      <td>98</td>\n",
       "      <td>8.265306</td>\n",
       "      <td>Frank McCourt</td>\n",
       "      <td>Scribner</td>\n",
       "      <td>http://images.amazon.com/images/P/068484267X.0...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>251</th>\n",
       "      <td>Bee Season: A Novel</td>\n",
       "      <td>90</td>\n",
       "      <td>7.500000</td>\n",
       "      <td>Myla Goldberg</td>\n",
       "      <td>Anchor Books/Doubleday</td>\n",
       "      <td>http://images.amazon.com/images/P/0385498802.0...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>267</th>\n",
       "      <td>Falling Angels</td>\n",
       "      <td>88</td>\n",
       "      <td>7.465909</td>\n",
       "      <td>Tracy Chevalier</td>\n",
       "      <td>Plume Books</td>\n",
       "      <td>http://images.amazon.com/images/P/0452283205.0...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>285</th>\n",
       "      <td>A Lesson Before Dying (Vintage Contemporaries ...</td>\n",
       "      <td>83</td>\n",
       "      <td>7.722892</td>\n",
       "      <td>Ernest J. Gaines</td>\n",
       "      <td>Vintage Books USA</td>\n",
       "      <td>http://images.amazon.com/images/P/0375702709.0...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>310</th>\n",
       "      <td>Ellen Foster</td>\n",
       "      <td>80</td>\n",
       "      <td>7.387500</td>\n",
       "      <td>Kaye Gibbons</td>\n",
       "      <td>Vintage Books</td>\n",
       "      <td>http://images.amazon.com/images/P/0375703055.0...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>323</th>\n",
       "      <td>Prodigal Summer</td>\n",
       "      <td>78</td>\n",
       "      <td>8.256410</td>\n",
       "      <td>Barbara Kingsolver</td>\n",
       "      <td>HarperCollins</td>\n",
       "      <td>http://images.amazon.com/images/P/0060199652.0...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>344</th>\n",
       "      <td>Hearts In Atlantis</td>\n",
       "      <td>75</td>\n",
       "      <td>7.600000</td>\n",
       "      <td>Stephen King</td>\n",
       "      <td>Pocket</td>\n",
       "      <td>http://images.amazon.com/images/P/0671024248.0...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>358</th>\n",
       "      <td>The Diary of Ellen Rimbauer: My Life at Rose Red</td>\n",
       "      <td>74</td>\n",
       "      <td>7.175676</td>\n",
       "      <td>Joyce Reardon</td>\n",
       "      <td>Hyperion</td>\n",
       "      <td>http://images.amazon.com/images/P/0786868015.0...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>414</th>\n",
       "      <td>Lies and the Lying Liars Who Tell Them: A Fair...</td>\n",
       "      <td>67</td>\n",
       "      <td>8.641791</td>\n",
       "      <td>Al Franken</td>\n",
       "      <td>Dutton Books</td>\n",
       "      <td>http://images.amazon.com/images/P/0525947647.0...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>438</th>\n",
       "      <td>The Pilot's Wife : A Novel Tag: Author of the ...</td>\n",
       "      <td>65</td>\n",
       "      <td>7.753846</td>\n",
       "      <td>Anita Shreve</td>\n",
       "      <td>Little, Brown</td>\n",
       "      <td>http://images.amazon.com/images/P/0316789089.0...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>459</th>\n",
       "      <td>Seabiscuit</td>\n",
       "      <td>62</td>\n",
       "      <td>8.241935</td>\n",
       "      <td>LAURA HILLENBRAND</td>\n",
       "      <td>Ballantine Books</td>\n",
       "      <td>http://images.amazon.com/images/P/0345465083.0...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>559</th>\n",
       "      <td>The Dress Lodger (Ballantine Reader's Circle)</td>\n",
       "      <td>55</td>\n",
       "      <td>7.472727</td>\n",
       "      <td>Sheri Holman</td>\n",
       "      <td>Ballantine Books</td>\n",
       "      <td>http://images.amazon.com/images/P/0345436911.0...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>623</th>\n",
       "      <td>Breath, Eyes, Memory</td>\n",
       "      <td>51</td>\n",
       "      <td>7.137255</td>\n",
       "      <td>Edwidge Danticat</td>\n",
       "      <td>Vintage Books USA</td>\n",
       "      <td>http://images.amazon.com/images/P/037570504X.0...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>693</th>\n",
       "      <td>The Dogs of Babel (Today Show Book Club #12)</td>\n",
       "      <td>47</td>\n",
       "      <td>8.148936</td>\n",
       "      <td>Carolyn Parkhurst</td>\n",
       "      <td>Little, Brown</td>\n",
       "      <td>http://images.amazon.com/images/P/0316168688.0...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>783</th>\n",
       "      <td>Primary Colors: A Novel of Politics</td>\n",
       "      <td>43</td>\n",
       "      <td>6.674419</td>\n",
       "      <td>Anonymous</td>\n",
       "      <td>Random House Inc</td>\n",
       "      <td>http://images.amazon.com/images/P/0679448594.0...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>817</th>\n",
       "      <td>In the Heart of the Sea: The Tragedy of the Wh...</td>\n",
       "      <td>41</td>\n",
       "      <td>8.073171</td>\n",
       "      <td>Nathaniel Philbrick</td>\n",
       "      <td>Penguin Putnam</td>\n",
       "      <td>http://images.amazon.com/images/P/0670891576.0...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>887</th>\n",
       "      <td>The Curious Incident of the Dog in the Night-T...</td>\n",
       "      <td>39</td>\n",
       "      <td>7.897436</td>\n",
       "      <td>MARK HADDON</td>\n",
       "      <td>Doubleday</td>\n",
       "      <td>http://images.amazon.com/images/P/0385509456.0...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>904</th>\n",
       "      <td>Waiting (Vintage International)</td>\n",
       "      <td>39</td>\n",
       "      <td>7.538462</td>\n",
       "      <td>Ha Jin</td>\n",
       "      <td>Vintage Books USA</td>\n",
       "      <td>http://images.amazon.com/images/P/0375706410.0...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1079</th>\n",
       "      <td>Corelli's Mandolin : A Novel</td>\n",
       "      <td>34</td>\n",
       "      <td>8.029412</td>\n",
       "      <td>LOUIS DE BERNIERES</td>\n",
       "      <td>Vintage</td>\n",
       "      <td>http://images.amazon.com/images/P/067976397X.0...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1263</th>\n",
       "      <td>The Martian Chronicles</td>\n",
       "      <td>30</td>\n",
       "      <td>8.600000</td>\n",
       "      <td>RAY BRADBURY</td>\n",
       "      <td>Spectra</td>\n",
       "      <td>http://images.amazon.com/images/P/0553278223.0...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2259</th>\n",
       "      <td>A Monstrous Regiment of Women</td>\n",
       "      <td>20</td>\n",
       "      <td>7.800000</td>\n",
       "      <td>Laurie R. King</td>\n",
       "      <td>St Martins Pr</td>\n",
       "      <td>http://images.amazon.com/images/P/0312135653.0...</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                                             Book-Title  num_ratings  \\\n",
       "1                                           Wild Animus          581   \n",
       "4                            The Nanny Diaries: A Novel          393   \n",
       "8                                            Life of Pi          336   \n",
       "18                               Snow Falling on Cedars          275   \n",
       "20                                To Kill a Mockingbird          267   \n",
       "26    Tuesdays with Morrie: An Old Man, a Young Man,...          250   \n",
       "30                                House of Sand and Fog          242   \n",
       "34                                             The Firm          224   \n",
       "35                        The Poisonwood Bible: A Novel          218   \n",
       "49                                       Fahrenheit 451          204   \n",
       "52                                           The Reader          195   \n",
       "58                    Little Altars Everywhere: A Novel          186   \n",
       "83    Wicked: The Life and Times of the Wicked Witch...          156   \n",
       "86                                    Midwives: A Novel          153   \n",
       "87        Ender's Game (Ender Wiggins Saga (Paperback))          151   \n",
       "108   The Perfect Storm : A True Story of Men Agains...          137   \n",
       "111                                      ANGELA'S ASHES          136   \n",
       "112                               STONES FROM THE RIVER          136   \n",
       "114   A Child Called \\It\\\": One Child's Courage to S...          136   \n",
       "120                             Cold Mountain : A Novel          134   \n",
       "139                             The God of Small Things          124   \n",
       "140                                   Lord of the Flies          123   \n",
       "141                                   Girl, Interrupted          122   \n",
       "142                                Silence of the Lambs          121   \n",
       "148             Along Came a Spider (Alex Cross Novels)          118   \n",
       "177                                     Four Blind Mice          104   \n",
       "208                            Angela's Ashes: A Memoir           98   \n",
       "251                                 Bee Season: A Novel           90   \n",
       "267                                      Falling Angels           88   \n",
       "285   A Lesson Before Dying (Vintage Contemporaries ...           83   \n",
       "310                                        Ellen Foster           80   \n",
       "323                                     Prodigal Summer           78   \n",
       "344                                  Hearts In Atlantis           75   \n",
       "358    The Diary of Ellen Rimbauer: My Life at Rose Red           74   \n",
       "414   Lies and the Lying Liars Who Tell Them: A Fair...           67   \n",
       "438   The Pilot's Wife : A Novel Tag: Author of the ...           65   \n",
       "459                                          Seabiscuit           62   \n",
       "559       The Dress Lodger (Ballantine Reader's Circle)           55   \n",
       "623                                Breath, Eyes, Memory           51   \n",
       "693        The Dogs of Babel (Today Show Book Club #12)           47   \n",
       "783                 Primary Colors: A Novel of Politics           43   \n",
       "817   In the Heart of the Sea: The Tragedy of the Wh...           41   \n",
       "887   The Curious Incident of the Dog in the Night-T...           39   \n",
       "904                     Waiting (Vintage International)           39   \n",
       "1079                       Corelli's Mandolin : A Novel           34   \n",
       "1263                             The Martian Chronicles           30   \n",
       "2259                      A Monstrous Regiment of Women           20   \n",
       "\n",
       "      avg_rating             Book-Author                   Publisher  \\\n",
       "1       4.390706            Rich Shapero                     Too Far   \n",
       "4       7.437659         Emma McLaughlin          St. Martin's Press   \n",
       "8       8.080357             Yann Martel                    Harcourt   \n",
       "18      7.829091          David Guterson                    Harcourt   \n",
       "20      8.977528              Harper Lee  Little Brown &amp; Company   \n",
       "26      8.588000             MITCH ALBOM                   Doubleday   \n",
       "30      7.363636         Andre Dubus III               Vintage Books   \n",
       "34      7.825893            John Grisham             Doubleday Books   \n",
       "35      8.178899      Barbara Kingsolver                   Perennial   \n",
       "49      8.549020            Ray Bradbury             Distribooks Inc   \n",
       "52      7.200000        Bernhard Schlink                Random House   \n",
       "58      7.596774           Rebecca Wells                   Perennial   \n",
       "83      7.871795         Gregory Maguire                 Regan Books   \n",
       "86      7.732026         Chris Bohjalian                     Vintage   \n",
       "87      8.920530        Orson Scott Card                   Tor Books   \n",
       "108     7.489051        Sebastian Junger                   Perennial   \n",
       "111     8.360294           Frank McCourt                    Scribner   \n",
       "112     8.036765             Ursula Hegi        Simon &amp; Schuster   \n",
       "114     7.963235             Dave Pelzer       Health Communications   \n",
       "120     7.776119         CHARLES FRAZIER                     Vintage   \n",
       "139     7.661290           Arundhati Roy                   Perennial   \n",
       "140     8.040650  William Gerald Golding               Perigee Trade   \n",
       "141     7.344262          SUSANNA KAYSEN                     Vintage   \n",
       "142     8.380165           Thomas Harris          St. Martin's Press   \n",
       "148     8.042373         James Patterson                Warner Books   \n",
       "177     8.182692         James Patterson               Little, Brown   \n",
       "208     8.265306           Frank McCourt                    Scribner   \n",
       "251     7.500000           Myla Goldberg      Anchor Books/Doubleday   \n",
       "267     7.465909         Tracy Chevalier                 Plume Books   \n",
       "285     7.722892        Ernest J. Gaines           Vintage Books USA   \n",
       "310     7.387500            Kaye Gibbons               Vintage Books   \n",
       "323     8.256410      Barbara Kingsolver               HarperCollins   \n",
       "344     7.600000            Stephen King                      Pocket   \n",
       "358     7.175676           Joyce Reardon                    Hyperion   \n",
       "414     8.641791              Al Franken                Dutton Books   \n",
       "438     7.753846            Anita Shreve               Little, Brown   \n",
       "459     8.241935       LAURA HILLENBRAND            Ballantine Books   \n",
       "559     7.472727            Sheri Holman            Ballantine Books   \n",
       "623     7.137255        Edwidge Danticat           Vintage Books USA   \n",
       "693     8.148936       Carolyn Parkhurst               Little, Brown   \n",
       "783     6.674419               Anonymous            Random House Inc   \n",
       "817     8.073171     Nathaniel Philbrick              Penguin Putnam   \n",
       "887     7.897436             MARK HADDON                   Doubleday   \n",
       "904     7.538462                  Ha Jin           Vintage Books USA   \n",
       "1079    8.029412      LOUIS DE BERNIERES                     Vintage   \n",
       "1263    8.600000            RAY BRADBURY                     Spectra   \n",
       "2259    7.800000          Laurie R. King               St Martins Pr   \n",
       "\n",
       "                                                   link  \n",
       "1     http://images.amazon.com/images/P/0971880107.0...  \n",
       "4     http://images.amazon.com/images/P/0312278586.0...  \n",
       "8     http://images.amazon.com/images/P/0151008116.0...  \n",
       "18    http://images.amazon.com/images/P/0151001006.0...  \n",
       "20    http://images.amazon.com/images/P/0446310786.0...  \n",
       "26    http://images.amazon.com/images/P/0385484518.0...  \n",
       "30    http://images.amazon.com/images/P/0375727345.0...  \n",
       "34    http://images.amazon.com/images/P/0385416342.0...  \n",
       "35    http://images.amazon.com/images/P/0060930535.0...  \n",
       "49    http://images.amazon.com/images/P/3257208626.0...  \n",
       "52    http://images.amazon.com/images/P/0679442790.0...  \n",
       "58    http://images.amazon.com/images/P/0060976845.0...  \n",
       "83    http://images.amazon.com/images/P/0060987103.0...  \n",
       "86    http://images.amazon.com/images/P/0375706771.0...  \n",
       "87    http://images.amazon.com/images/P/0312853238.0...  \n",
       "108   http://images.amazon.com/images/P/0060977477.0...  \n",
       "111   http://images.amazon.com/images/P/0684874350.0...  \n",
       "112   http://images.amazon.com/images/P/0684844729.0...  \n",
       "114   http://images.amazon.com/images/P/1558743669.0...  \n",
       "120   http://images.amazon.com/images/P/0375700757.0...  \n",
       "139   http://images.amazon.com/images/P/0060977493.0...  \n",
       "140   http://images.amazon.com/images/P/0399501487.0...  \n",
       "141   http://images.amazon.com/images/P/0679746048.0...  \n",
       "142   http://images.amazon.com/images/P/0312924585.0...  \n",
       "148   http://images.amazon.com/images/P/0446364193.0...  \n",
       "177   http://images.amazon.com/images/P/0316693006.0...  \n",
       "208   http://images.amazon.com/images/P/068484267X.0...  \n",
       "251   http://images.amazon.com/images/P/0385498802.0...  \n",
       "267   http://images.amazon.com/images/P/0452283205.0...  \n",
       "285   http://images.amazon.com/images/P/0375702709.0...  \n",
       "310   http://images.amazon.com/images/P/0375703055.0...  \n",
       "323   http://images.amazon.com/images/P/0060199652.0...  \n",
       "344   http://images.amazon.com/images/P/0671024248.0...  \n",
       "358   http://images.amazon.com/images/P/0786868015.0...  \n",
       "414   http://images.amazon.com/images/P/0525947647.0...  \n",
       "438   http://images.amazon.com/images/P/0316789089.0...  \n",
       "459   http://images.amazon.com/images/P/0345465083.0...  \n",
       "559   http://images.amazon.com/images/P/0345436911.0...  \n",
       "623   http://images.amazon.com/images/P/037570504X.0...  \n",
       "693   http://images.amazon.com/images/P/0316168688.0...  \n",
       "783   http://images.amazon.com/images/P/0679448594.0...  \n",
       "817   http://images.amazon.com/images/P/0670891576.0...  \n",
       "887   http://images.amazon.com/images/P/0385509456.0...  \n",
       "904   http://images.amazon.com/images/P/0375706410.0...  \n",
       "1079  http://images.amazon.com/images/P/067976397X.0...  \n",
       "1263  http://images.amazon.com/images/P/0553278223.0...  \n",
       "2259  http://images.amazon.com/images/P/0312135653.0...  "
      ]
     },
     "execution_count": 48,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# recommended books along with its details\n",
    "recommend_books = get_book_data(Suggested)\n",
    "recommend_books"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "136236f1",
   "metadata": {
    "papermill": {
     "duration": 0.035717,
     "end_time": "2023-05-31T08:53:47.607928",
     "exception": false,
     "start_time": "2023-05-31T08:53:47.572211",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "<h2><div style=\"color:white;\n",
    "           display:fill;\n",
    "           border-radius:5px;\n",
    "           background-color:#FF5733  ;\n",
    "           font-size:300%;\n",
    "           font-family:Sans-serif;\n",
    "           letter-spacing:0.5px\">\n",
    "\n",
    "<p style=\"padding: 15px;\n",
    "              color:white;\n",
    "               text-align:center\">\n",
    "    <b>\n",
    "        Content-based filtering(simialr books based on book-title)<a class=\"anchor\" id=\"8\"></a>\n",
    "        </b>\n",
    "</p>\n",
    "</div></h2>"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "0ca9bcb6",
   "metadata": {
    "papermill": {
     "duration": 0.035236,
     "end_time": "2023-05-31T08:53:47.677653",
     "exception": false,
     "start_time": "2023-05-31T08:53:47.642417",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "* In this section of our recommendation engine, we will focus on recommending books that are similar based on their titles. \n",
    "\n",
    "* To begin the process, we will invite the user to provide input by entering a book title or a keyword related to the book they are interested in. \n",
    "\n",
    "* Our engine will then utilize this input to find books that share similarities based on the provided information."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 49,
   "id": "5d57656b",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2023-05-31T08:53:47.749398Z",
     "iopub.status.busy": "2023-05-31T08:53:47.748682Z",
     "iopub.status.idle": "2023-05-31T08:53:47.752751Z",
     "shell.execute_reply": "2023-05-31T08:53:47.751968Z"
    },
    "papermill": {
     "duration": 0.042779,
     "end_time": "2023-05-31T08:53:47.754867",
     "exception": false,
     "start_time": "2023-05-31T08:53:47.712088",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "# example usage\n",
    "input_book = \"harrry potter\""
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 50,
   "id": "c05e57cd",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2023-05-31T08:53:47.826778Z",
     "iopub.status.busy": "2023-05-31T08:53:47.826134Z",
     "iopub.status.idle": "2023-05-31T08:53:48.000730Z",
     "shell.execute_reply": "2023-05-31T08:53:47.999590Z"
    },
    "papermill": {
     "duration": 0.213445,
     "end_time": "2023-05-31T08:53:48.003149",
     "exception": false,
     "start_time": "2023-05-31T08:53:47.789704",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "242135"
      ]
     },
     "execution_count": 50,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "book_unique = books_rating[\"Book-Title\"].unique().tolist()\n",
    "len(book_unique)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 51,
   "id": "2cb6492f",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2023-05-31T08:53:48.077216Z",
     "iopub.status.busy": "2023-05-31T08:53:48.076768Z",
     "iopub.status.idle": "2023-05-31T08:53:48.081631Z",
     "shell.execute_reply": "2023-05-31T08:53:48.080547Z"
    },
    "papermill": {
     "duration": 0.044197,
     "end_time": "2023-05-31T08:53:48.083861",
     "exception": false,
     "start_time": "2023-05-31T08:53:48.039664",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "vectorizer = TfidfVectorizer()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "1bb9ea35",
   "metadata": {
    "papermill": {
     "duration": 0.034878,
     "end_time": "2023-05-31T08:53:48.153724",
     "exception": false,
     "start_time": "2023-05-31T08:53:48.118846",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "Since, the dataset is huge, while computing the cosine similarities we might face memory issues. Hence instead of fetching all the data at once, we will provide data to the engine in parts."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 52,
   "id": "58a361b1",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2023-05-31T08:53:48.225315Z",
     "iopub.status.busy": "2023-05-31T08:53:48.224652Z",
     "iopub.status.idle": "2023-05-31T08:53:48.229774Z",
     "shell.execute_reply": "2023-05-31T08:53:48.228986Z"
    },
    "papermill": {
     "duration": 0.043329,
     "end_time": "2023-05-31T08:53:48.231892",
     "exception": false,
     "start_time": "2023-05-31T08:53:48.188563",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "# Define the number of parts to divide the dataset into\n",
    "num_parts = 30\n",
    "\n",
    "# Calculate the number of books per part\n",
    "books_per_part = len(book_unique) // num_parts"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 53,
   "id": "32fd8c9b",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2023-05-31T08:53:48.303070Z",
     "iopub.status.busy": "2023-05-31T08:53:48.302466Z",
     "iopub.status.idle": "2023-05-31T08:54:20.638985Z",
     "shell.execute_reply": "2023-05-31T08:54:20.637885Z"
    },
    "papermill": {
     "duration": 32.375245,
     "end_time": "2023-05-31T08:54:20.641708",
     "exception": false,
     "start_time": "2023-05-31T08:53:48.266463",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "recommendations = []\n",
    "scores = []\n",
    "for i in range(num_parts):\n",
    "    start_index = i * books_per_part\n",
    "    end_index = start_index + books_per_part\n",
    "\n",
    "    if i == num_parts - 1:\n",
    "        dataset = book_unique[start_index:]\n",
    "\n",
    "    else:\n",
    "        dataset = book_unique[start_index:end_index]\n",
    "\n",
    "\n",
    "    dataset.append(input_book)\n",
    "    book_vectors = vectorizer.fit_transform(dataset)\n",
    "\n",
    "    # Compute the cosine similarity\n",
    "    similarity_scores = cosine_similarity(book_vectors)\n",
    "\n",
    "    # Get the index\n",
    "    book_index = dataset.index(input_book)\n",
    "\n",
    "    # Get the cosine similarity scores for the book\n",
    "    similar_books = list(enumerate(similarity_scores[book_index]))\n",
    "\n",
    "    # Sort the similar books by similarity score\n",
    "    similar_books = sorted(similar_books, key=lambda x: x[1], reverse=True)\n",
    "    top_books = similar_books[1:100]\n",
    "\n",
    "    top_books_index = [t[0] for t in top_books]\n",
    "    top_books_scores = [t[1] for t in top_books]\n",
    "\n",
    "    # Get the top N similar books\n",
    "    top_books_name = [dataset[i] for i in top_books_index]\n",
    "\n",
    "    recommendations.append(top_books_name)\n",
    "    scores.append(top_books_scores)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 54,
   "id": "0f2aa196",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2023-05-31T08:54:20.713648Z",
     "iopub.status.busy": "2023-05-31T08:54:20.713264Z",
     "iopub.status.idle": "2023-05-31T08:54:20.718950Z",
     "shell.execute_reply": "2023-05-31T08:54:20.717841Z"
    },
    "papermill": {
     "duration": 0.04463,
     "end_time": "2023-05-31T08:54:20.721344",
     "exception": false,
     "start_time": "2023-05-31T08:54:20.676714",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "flat_list1 = [item for sublist in recommendations for item in sublist]\n",
    "flat_list2 = [item for sublist in scores for item in sublist]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 55,
   "id": "a734b53f",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2023-05-31T08:54:20.792584Z",
     "iopub.status.busy": "2023-05-31T08:54:20.792211Z",
     "iopub.status.idle": "2023-05-31T08:54:20.802836Z",
     "shell.execute_reply": "2023-05-31T08:54:20.802016Z"
    },
    "papermill": {
     "duration": 0.048695,
     "end_time": "2023-05-31T08:54:20.804880",
     "exception": false,
     "start_time": "2023-05-31T08:54:20.756185",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "book_output = pd.DataFrame({'Column1': flat_list1, 'Column2': flat_list2})\n",
    "book_output.columns = [\"Book-Title\", \"Scores\"]\n",
    "book_output.drop_duplicates(inplace=True)\n",
    "book_output = book_output.sort_values(by=\"Scores\", ascending=False).head(100)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 56,
   "id": "0ca65c1d",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2023-05-31T08:54:20.876884Z",
     "iopub.status.busy": "2023-05-31T08:54:20.876305Z",
     "iopub.status.idle": "2023-05-31T08:54:20.900442Z",
     "shell.execute_reply": "2023-05-31T08:54:20.899397Z"
    },
    "papermill": {
     "duration": 0.063035,
     "end_time": "2023-05-31T08:54:20.902901",
     "exception": false,
     "start_time": "2023-05-31T08:54:20.839866",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "# if user has enterd a book title\n",
    "if input_book in book_unique:\n",
    "    book_results = get_book_data(book_output)\n",
    "    book_results = pd.merge(book_output, book_results, on=\"Book-Title\", how=\"inner\").sort_values(\n",
    "        by=[\"Scores\", \"num_ratings\", \"avg_rating\"], ascending=False)\n",
    "\n",
    "# if user has entered a keyword of a book-title\n",
    "else:\n",
    "    book_output = book_output.drop(book_output[book_output['Book-Title'] == input_book].index)\n",
    "    book_results = get_book_data(book_output)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 57,
   "id": "e4f8fef0",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2023-05-31T08:54:20.974941Z",
     "iopub.status.busy": "2023-05-31T08:54:20.974315Z",
     "iopub.status.idle": "2023-05-31T08:54:20.991539Z",
     "shell.execute_reply": "2023-05-31T08:54:20.990469Z"
    },
    "papermill": {
     "duration": 0.055749,
     "end_time": "2023-05-31T08:54:20.993716",
     "exception": false,
     "start_time": "2023-05-31T08:54:20.937967",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Recommendations for :  harrry potter \n",
      "\n",
      "\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Book-Title</th>\n",
       "      <th>num_ratings</th>\n",
       "      <th>avg_rating</th>\n",
       "      <th>Book-Author</th>\n",
       "      <th>Publisher</th>\n",
       "      <th>link</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>Harry Potter and the Chamber of Secrets (Book 2)</td>\n",
       "      <td>326</td>\n",
       "      <td>8.840491</td>\n",
       "      <td>J. K. Rowling</td>\n",
       "      <td>Scholastic</td>\n",
       "      <td>http://images.amazon.com/images/P/0439064872.0...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11</th>\n",
       "      <td>Harry Potter and the Sorcerer's Stone (Harry P...</td>\n",
       "      <td>315</td>\n",
       "      <td>8.936508</td>\n",
       "      <td>J. K. Rowling</td>\n",
       "      <td>Arthur A. Levine Books</td>\n",
       "      <td>http://images.amazon.com/images/P/059035342X.0...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17</th>\n",
       "      <td>Harry Potter and the Prisoner of Azkaban (Book 3)</td>\n",
       "      <td>277</td>\n",
       "      <td>9.043321</td>\n",
       "      <td>J. K. Rowling</td>\n",
       "      <td>Scholastic</td>\n",
       "      <td>http://images.amazon.com/images/P/0439136350.0...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>27</th>\n",
       "      <td>Harry Potter and the Goblet of Fire (Book 4)</td>\n",
       "      <td>247</td>\n",
       "      <td>9.125506</td>\n",
       "      <td>J. K. Rowling</td>\n",
       "      <td>Scholastic</td>\n",
       "      <td>http://images.amazon.com/images/P/0439139597.0...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>42</th>\n",
       "      <td>Harry Potter and the Order of the Phoenix (Boo...</td>\n",
       "      <td>211</td>\n",
       "      <td>9.047393</td>\n",
       "      <td>J. K. Rowling</td>\n",
       "      <td>Scholastic</td>\n",
       "      <td>http://images.amazon.com/images/P/043935806X.0...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>227467</th>\n",
       "      <td>Harry Potter Fun Book</td>\n",
       "      <td>0</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>Warner Bros.</td>\n",
       "      <td>Scholastic, Inc</td>\n",
       "      <td>http://images.amazon.com/images/P/0439282799.0...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>228204</th>\n",
       "      <td>Dennis Potter a Biography</td>\n",
       "      <td>0</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>Humphrey Carpenter</td>\n",
       "      <td>Faber Faber Inc</td>\n",
       "      <td>http://images.amazon.com/images/P/0571197213.0...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>229698</th>\n",
       "      <td>Harry Potter y El Caliz de Fuego</td>\n",
       "      <td>0</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>J. K. Rowling</td>\n",
       "      <td>Lidiun</td>\n",
       "      <td>http://images.amazon.com/images/P/847888663X.0...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>235604</th>\n",
       "      <td>Potter's Fields</td>\n",
       "      <td>0</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>Frank Roderus</td>\n",
       "      <td>Bantam Books</td>\n",
       "      <td>http://images.amazon.com/images/P/055329265X.0...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>239659</th>\n",
       "      <td>Incident at Potter's Bridge</td>\n",
       "      <td>0</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>Joe Monninger</td>\n",
       "      <td>Penguin USA</td>\n",
       "      <td>http://images.amazon.com/images/P/1556113072.0...</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>100 rows × 6 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "                                               Book-Title  num_ratings  \\\n",
       "9        Harry Potter and the Chamber of Secrets (Book 2)          326   \n",
       "11      Harry Potter and the Sorcerer's Stone (Harry P...          315   \n",
       "17      Harry Potter and the Prisoner of Azkaban (Book 3)          277   \n",
       "27           Harry Potter and the Goblet of Fire (Book 4)          247   \n",
       "42      Harry Potter and the Order of the Phoenix (Boo...          211   \n",
       "...                                                   ...          ...   \n",
       "227467                              Harry Potter Fun Book            0   \n",
       "228204                          Dennis Potter a Biography            0   \n",
       "229698                   Harry Potter y El Caliz de Fuego            0   \n",
       "235604                                    Potter's Fields            0   \n",
       "239659                        Incident at Potter's Bridge            0   \n",
       "\n",
       "        avg_rating         Book-Author               Publisher  \\\n",
       "9         8.840491       J. K. Rowling              Scholastic   \n",
       "11        8.936508       J. K. Rowling  Arthur A. Levine Books   \n",
       "17        9.043321       J. K. Rowling              Scholastic   \n",
       "27        9.125506       J. K. Rowling              Scholastic   \n",
       "42        9.047393       J. K. Rowling              Scholastic   \n",
       "...            ...                 ...                     ...   \n",
       "227467    0.000000        Warner Bros.         Scholastic, Inc   \n",
       "228204    0.000000  Humphrey Carpenter         Faber Faber Inc   \n",
       "229698    0.000000       J. K. Rowling                  Lidiun   \n",
       "235604    0.000000       Frank Roderus            Bantam Books   \n",
       "239659    0.000000       Joe Monninger             Penguin USA   \n",
       "\n",
       "                                                     link  \n",
       "9       http://images.amazon.com/images/P/0439064872.0...  \n",
       "11      http://images.amazon.com/images/P/059035342X.0...  \n",
       "17      http://images.amazon.com/images/P/0439136350.0...  \n",
       "27      http://images.amazon.com/images/P/0439139597.0...  \n",
       "42      http://images.amazon.com/images/P/043935806X.0...  \n",
       "...                                                   ...  \n",
       "227467  http://images.amazon.com/images/P/0439282799.0...  \n",
       "228204  http://images.amazon.com/images/P/0571197213.0...  \n",
       "229698  http://images.amazon.com/images/P/847888663X.0...  \n",
       "235604  http://images.amazon.com/images/P/055329265X.0...  \n",
       "239659  http://images.amazon.com/images/P/1556113072.0...  \n",
       "\n",
       "[100 rows x 6 columns]"
      ]
     },
     "execution_count": 57,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# printing the results for input book\n",
    "print(\"Recommendations for : \", input_book,\"\\n\\n\")\n",
    "book_results"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "9409582d",
   "metadata": {
    "papermill": {
     "duration": 0.036062,
     "end_time": "2023-05-31T08:54:21.065077",
     "exception": false,
     "start_time": "2023-05-31T08:54:21.029015",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "Link to the app : [https://zarna-99-recommendation-system-recommendation-engine-xizrkh.streamlit.app/]"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.10.10"
  },
  "papermill": {
   "default_parameters": {},
   "duration": 71.03048,
   "end_time": "2023-05-31T08:54:22.323553",
   "environment_variables": {},
   "exception": null,
   "input_path": "__notebook__.ipynb",
   "output_path": "__notebook__.ipynb",
   "parameters": {},
   "start_time": "2023-05-31T08:53:11.293073",
   "version": "2.4.0"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
